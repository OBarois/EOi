(this.webpackJsonpeoi=this.webpackJsonpeoi||[]).push([[0],{51:function(e,t,n){},55:function(e,t,n){},68:function(e,t,n){},83:function(e,t,n){},86:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(33),o=n.n(i),s=(n(68),n(4)),c=n(6),l=(n(83),n(5)),u=(n(51),n(14)),d=n.n(u),h=n(18),f=n(3),m=n.n(f),g=n(7),p=n(10),b=n(11),v=n(12),O=m.a.Angle,_=m.a.ArgumentError,j=m.a.Logger,y={getAsGeographicLocation:function(e){if(e instanceof Date===!1)throw new _(j.logMessage(j.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var t=this.getAsCelestialLocation(e);return this.celestialToGeographic(t,e)},getAsCelestialLocation:function(e){if(e instanceof Date===!1)throw new _(j.logMessage(j.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var t=this.computeJulianDate(e)-2451545,n=this.normalizeAngle360(280.46+.9856474*t),a=this.normalizeAngle360(357.528+.9856003*t)*O.DEGREES_TO_RADIANS,r=n+1.915*Math.sin(a)+.02*Math.sin(2*a),i=r*O.DEGREES_TO_RADIANS,o=(23.439-4e-7*t)*O.DEGREES_TO_RADIANS,s=Math.asin(Math.sin(o)*Math.sin(i))*O.RADIANS_TO_DEGREES,c=Math.atan(Math.cos(o)*Math.tan(i))*O.RADIANS_TO_DEGREES;return r>=90&&r<270&&(c+=180),{declination:s,rightAscension:c=this.normalizeAngle360(c)}},celestialToGeographic:function(e,t){if(!e)throw new _(j.logMessage(j.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(t instanceof Date===!1)throw new _(j.logMessage(j.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var n=this.computeJulianDate(t)-2451545,a=this.normalizeAngle360(280.46061837+360.98564736629*n),r=this.normalizeAngle360(a-e.rightAscension),i=O.normalizedDegreesLongitude(-r);return{latitude:e.declination,longitude:i}},computeJulianDate:function(e){if(e instanceof Date===!1)throw new _(j.logMessage(j.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var t=e.getUTCFullYear(),n=e.getUTCMonth()+1,a=e.getUTCDate(),r=(e.getUTCHours()+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24;n<=2&&(t-=1,n+=12);var i=Math.trunc(t/100),o=2-i+Math.trunc(i/4);return Math.trunc(365.25*(t+4716))+Math.trunc(30.6001*(n+1))+a+o-1524.5+r},normalizeAngle360:function(e){var t=e%360;return t>=0?t:t<0?360+t:360-t}},S=m.a.Angle,x={SUN:0,MERCURY:1,VENUS:2,MARS:4,JUPITER:5,SATURN:6,URANUS:7,NEPTUNE:8,getCelestialLocation:function(e,t){var n,a=y.computeJulianDate(t)-2451543.5;switch(e){case this.SUN:n=this.computeSun(a);break;case this.MERCURY:n=this.computeMercury(a);break;case this.VENUS:n=this.computeVenus(a);break;case this.MARS:n=this.computeMars(a);break;case this.JUPITER:n=this.computeJupiter(a);break;case this.SATURN:n=this.computeSaturn(a);break;case this.URANUS:n=this.computeUranus(a);break;case this.NEPTUNE:n=this.computeNeptune(a)}return this.computePosition(a,n)},computeMercury:function(e){return{N:48.3313+324587e-10*e,i:7.0047+5e-8*e,w:29.1241+101444e-10*e,a:.387098,e:.205635+5.59e-10*e,M:168.6562+4.0923344368*e}},computeVenus:function(e){return{N:76.6799+24659e-9*e,i:3.3946+2.75e-8*e,w:54.891+138374e-10*e,a:.72333,e:.006773-1.302e-9*e,M:48.0052+1.6021302244*e}},computeMars:function(e){return{N:49.5574+211081e-10*e,i:1.8497-1.78e-8*e,w:286.5016+292961e-10*e,a:1.523688,e:.093405+2.516e-9*e,M:18.6021+.5240207766*e}},computeJupiter:function(e){return{N:100.4542+276854e-10*e,i:1.303-1.557e-7*e,w:273.8777+164505e-10*e,a:5.20256,e:.048498+4.469e-9*e,M:19.895+.0830853001*e}},computeSaturn:function(e){return{N:113.6634+23898e-9*e,i:2.4886-1.081e-7*e,w:339.3939+297661e-10*e,a:9.55475,e:.055546-9.499e-9*e,M:316.967+.0334442282*e}},computeUranus:function(e){return{N:74.0005+13978e-9*e,i:.7733+19e-9*e,w:96.6612+30565e-9*e,a:19.18171-1.55e-8*e,e:.047318+7.45e-9*e,M:142.5905+.011725806*e}},computeNeptune:function(e){return{N:131.7806+30173e-9*e,i:1.77-255e-9*e,w:272.8461-6027e-9*e,a:30.05826+3.313e-8*e,e:.008606+2.15e-9*e,M:260.2471+.005995147*e}},computeSun:function(e){return{N:0,i:0,w:282.9404+470935e-10*e,a:1,e:.016709-1.151e-9*e,M:356.047+.9856002585*e}},computePosition:function(e,t){var n=t.N,a=t.i,r=t.w,i=t.a,o=t.e,s=t.M;n=y.normalizeAngle360(n)*S.DEGREES_TO_RADIANS,a=y.normalizeAngle360(a)*S.DEGREES_TO_RADIANS,r=y.normalizeAngle360(r)*S.DEGREES_TO_RADIANS;var c=(s=y.normalizeAngle360(s)*S.DEGREES_TO_RADIANS)+o*Math.sin(s)*(1+o*Math.cos(s));if(o>=.06)for(var l=0;l<10;l++){var u=c-(c-o*Math.sin(c)-s)/(1-o*Math.cos(c));if(Math.abs(u-c)<.001){c=u;break}c=u}var d=i*(Math.cos(c)-o),h=i*(Math.sqrt(1-o*o)*Math.sin(c)),f=Math.atan2(h,d),m=Math.sqrt(d*d+h*h),g=m*(Math.cos(n)*Math.cos(f+r)-Math.sin(n)*Math.sin(f+r)*Math.cos(a)),p=m*(Math.sin(n)*Math.cos(f+r)+Math.cos(n)*Math.sin(f+r)*Math.cos(a)),b=m*(Math.sin(f+r)*Math.sin(a)),v=382394e-10*(0-e)*S.DEGREES_TO_RADIANS,O=Math.atan2(p,g)+v,_=Math.atan2(b,Math.sqrt(g*g+p*p));g=m*Math.cos(O)*Math.cos(_),p=m*Math.sin(O)*Math.cos(_),b=m*Math.sin(_);var j=this.getLonSun(e,this.computeSun(e)),x=j.lonsun,E=j.rsun;x*=S.RADIANS_TO_DEGREES,x=y.normalizeAngle360(x)*S.DEGREES_TO_RADIANS;var M=g+E*Math.cos(x),T=p+E*Math.sin(x),A=b,w=y.normalizeAngle360(23.4393-3.563e-7*e)*S.DEGREES_TO_RADIANS,R=M,D=T*Math.cos(w)-A*Math.sin(w),N=T*Math.sin(w)+A*Math.cos(w);return{ra:y.normalizeAngle360(Math.atan2(D,R)*S.RADIANS_TO_DEGREES),dec:Math.atan2(N,Math.sqrt(R*R+D*D))*S.RADIANS_TO_DEGREES}},getLonSun:function(e,t){var n=t.w,a=t.e,r=t.M;n=y.normalizeAngle360(n)*S.DEGREES_TO_RADIANS;var i=(r=y.normalizeAngle360(r)*S.DEGREES_TO_RADIANS)+a*Math.sin(r)*(1+a*Math.cos(r)),o=Math.cos(i)-a,s=Math.sqrt(1-a*a)*Math.sin(i);return{lonsun:Math.atan2(s,o)+n,rsun:Math.sqrt(o*o+s*s)}}},E=m.a.ArgumentError,M=m.a.GpuProgram,T=m.a.Logger,A=m.a.Matrix,w=m.a.Color,R=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e,"attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}","precision mediump float;\nuniform sampler2D textureSampler;\nuniform int fragMode;\nuniform vec4 color;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (fragMode == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else if (fragMode == 0) {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n   else if (fragMode == 2) {\n       gl_FragColor = color;\n   }\n}",["vertexPoint"])).FRAG_MODE_MIX_COLOR=0,a.FRAG_MODE_TEXTURE=1,a.FRAG_MODE_COLOR=2,a.vertexPointLocation=a.attributeLocation(e,"vertexPoint"),a.mvpMatrixLocation=a.uniformLocation(e,"mvpMatrix"),a.numDaysLocation=a.uniformLocation(e,"numDays"),a.magnitudeRangeLocation=a.uniformLocation(e,"magnitudeRange"),a.textureUnitLocation=a.uniformLocation(e,"textureSampler"),a.fragModeLocation=a.uniformLocation(e,"fragMode"),a.colorLocation=a.uniformLocation(e,"color"),a.localState={mvpMatrix:null,numDays:null,magnitudeRange:null,textureUnit:null,fragMode:null,color:null},a}return Object(p.a)(n,[{key:"loadModelviewProjection",value:function(e,t){if(!t)throw new E(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));var n=!1;null===this.localState.mvpMatrix&&(n=!0,this.localState.mvpMatrix=A.fromIdentity()),!n&&this.localState.mvpMatrix.equals(t)||(this.loadUniformMatrix(e,t,this.mvpMatrixLocation),this.localState.mvpMatrix.copy(t))}},{key:"loadNumDays",value:function(e,t){if(null==t)throw new E(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));this.localState.numDays!==t&&(e.uniform1f(this.numDaysLocation,t),this.localState.numDays=t)}},{key:"loadMagnitudeRange",value:function(e,t,n){if(null==t)throw new E(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==n)throw new E(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));var a=!1;null===this.localState.magnitudeRange&&(a=!0,this.localState.magnitudeRange=[t,n]),(a||this.localState.magnitudeRange[0]!==t||this.localState.magnitudeRange[1]!==n)&&(e.uniform2f(this.magnitudeRangeLocation,t,n),this.localState.magnitudeRange[0]=t,this.localState.magnitudeRange[1]=n)}},{key:"loadTextureUnit",value:function(e,t){this.localState.textureUnit!==t&&(e.uniform1i(this.textureUnitLocation,t-e.TEXTURE0),this.localState.textureUnit=t)}},{key:"loadFragMode",value:function(e,t){this.localState.fragMode!==t&&(e.uniform1i(this.fragModeLocation,t),this.localState.fragMode=t)}},{key:"loadColor",value:function(e,t){var n=!1;null===this.localState.color&&(n=!0,this.localState.color=new w(0,0,0,0)),!n&&this.localState.color.equals(t)||(this.loadUniformColor(e,t,this.colorLocation),this.localState.color.copy(t))}}]),n}(M);R.key="WorldWindGpuStarFieldFullProgram";var D=R,N=(m.a.Color,m.a.Layer),C=m.a.Logger,L=m.a.Matrix,P=m.a.REDRAW_EVENT_TYPE,I=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(e){var a;Object(g.a)(this,n),(a=t.call(this,"StarField")).pickEnabled=!1,a.sunSize=128,a.showSun=!0,a._starDataSource=e||m.a.configuration.baseUrl+"data/stars.json",a._sunImageSource=m.a.configuration.baseUrl+"images/sunTexture.png",a._matrix=L.fromIdentity(),a._starsPositionsVboCacheKey=null,a._numStars=0,a._starData=null,a._minMagnitude=Number.MAX_VALUE,a._maxMagnitude=Number.MIN_VALUE,a._loadStarted=!1,a._minScale=3e7,a._scale=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,a._sunPositionsCacheKey="",a._sunBufferView=new Float32Array(4),a._MAX_GL_POINT_SIZE=0,a.showPlanets=!0;var r=32;return a.planets=[{id:x.MERCURY,url:"images/Mercury64.png",size:8,ra:null,dec:null},{id:x.VENUS,url:"images/Venus64.png",size:8,ra:null,dec:null},{id:x.MARS,url:"images/Mars64.png",size:8,ra:null,dec:null},{id:x.JUPITER,url:"images/Jupiter64.png",size:r,ra:null,dec:null},{id:x.SATURN,url:"images/Saturn64.png",size:r,ra:null,dec:null},{id:x.URANUS,url:"images/Uranus64.png",size:16,ra:null,dec:null},{id:x.NEPTUNE,url:"images/Neptune64.png",size:16,ra:null,dec:null}],a._planetsBufferView=null,a._cacheKeys={sunPosition:"",planetPositions:"",starPositions:""},a}return Object(p.a)(n,[{key:"starDataSource",get:function(){return this._starDataSource},set:function(e){this._starDataSource=e,this.invalidateStarData()}},{key:"sunImageSource",get:function(){return this._sunImageSource},set:function(e){this._sunImageSource=e}},{key:"doRender",value:function(e){if(!e.globe.is2D())if(this.haveResources(e)){this.beginRendering(e);try{this.doDraw(e)}finally{this.endRendering(e)}}else this.loadResources(e)}},{key:"haveResources",value:function(e){var t=e.gpuResourceCache.resourceForKey(this._sunImageSource),n=this.planets.every((function(t){return!!e.gpuResourceCache.resourceForKey(t.url)}));return null!=this._starData&&null!=t&&n}},{key:"loadResources",value:function(e){var t=e.currentGlContext,n=e.gpuResourceCache;this._starData||this.fetchStarData(),n.resourceForKey(this._sunImageSource)||n.retrieveTexture(t,this._sunImageSource),this.planets.forEach((function(e){n.resourceForKey(e.url)||n.retrieveTexture(t,e.url)}))}},{key:"beginRendering",value:function(e){var t=e.currentGlContext;e.findAndBindProgram(D),t.enableVertexAttribArray(0),t.depthMask(!1)}},{key:"doDraw",value:function(e){this.loadCommonUniforms(e),this.renderStars(e),this.showSun&&this.renderSun(e),this.showPlanets&&this.renderPlanets(e)}},{key:"loadCommonUniforms",value:function(e){var t=e.currentGlContext,n=e.currentProgram,a=e.modelviewProjection||e.navigatorState.modelviewProjection;this._matrix.copy(a),this._matrix.multiplyByScale(this._scale,this._scale,this._scale),n.loadModelviewProjection(t,this._matrix);var r=y.computeJulianDate(this.time||new Date);n.loadNumDays(t,r-2451545)}},{key:"renderStars",value:function(e){var t=e.currentGlContext,n=e.gpuResourceCache,a=e.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=n.generateCacheKey());var r=n.resourceForKey(this._starsPositionsVboCacheKey);if(r)t.bindBuffer(t.ARRAY_BUFFER,r);else{r=t.createBuffer();var i=this.createStarsGeometry();n.putResource(this._starsPositionsVboCacheKey,r,4*i.length),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW)}e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),a.loadMagnitudeRange(t,this._minMagnitude,this._maxMagnitude),a.loadFragMode(t,a.FRAG_MODE_MIX_COLOR),t.drawArrays(t.POINTS,0,this._numStars)}},{key:"renderPlanets",value:function(e){var t=this,n=e.currentGlContext,a=e.currentProgram,r=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&C.log(C.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE),this.planets.forEach((function(e){var n=x.getCelestialLocation(e.id,t.time||new Date),a=n.ra,r=n.dec;e.ra=a,e.dec=r}),this),this._planetsBufferView||(this._planetsBufferView=new Float32Array(4*this.planets.length));for(var i=0;i<this.planets.length;i++){var o=this.planets[i];this._planetsBufferView[4*i+0]=o.dec,this._planetsBufferView[4*i+1]=o.ra,this._planetsBufferView[4*i+2]=Math.min(o.size,this._MAX_GL_POINT_SIZE),this._planetsBufferView[4*i+3]=1}this._planetsPositionsVboCacheKey||(this._planetsPositionsVboCacheKey=r.generateCacheKey());var s=r.resourceForKey(this._planetsPositionsVboCacheKey);s?(n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferSubData(n.ARRAY_BUFFER,0,this._planetsBufferView)):(s=n.createBuffer(),r.putResource(this._planetsPositionsVboCacheKey,s,4*this._planetsBufferView.length),n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferData(n.ARRAY_BUFFER,this._planetsBufferView,n.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),n.vertexAttribPointer(0,4,n.FLOAT,!1,0,0),a.loadFragMode(n,a.FRAG_MODE_TEXTURE);for(var c=0;c<this.planets.length;c++){var l=this.planets[c].url;e.gpuResourceCache.resourceForKey(l).bind(e),n.drawArrays(n.POINTS,c,1)}}},{key:"renderSun",value:function(e){var t=e.currentGlContext,n=e.currentProgram,a=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&C.log(C.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var r=y.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=r.declination,this._sunBufferView[1]=r.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=a.generateCacheKey());var i=a.resourceForKey(this._sunPositionsCacheKey);i?(t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferSubData(t.ARRAY_BUFFER,0,this._sunBufferView)):(i=t.createBuffer(),a.putResource(this._sunPositionsCacheKey,i,4*this._sunBufferView.length),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,this._sunBufferView,t.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),n.loadFragMode(t,n.FRAG_MODE_TEXTURE),e.gpuResourceCache.resourceForKey(this._sunImageSource).bind(e),t.drawArrays(t.POINTS,0,1)}},{key:"endRendering",value:function(e){var t=e.currentGlContext;t.depthMask(!0),t.disableVertexAttribArray(0)}},{key:"fetchStarData",value:function(){if(!this._loadStarted){this._loadStarted=!0;var e=this,t=new XMLHttpRequest;t.onload=function(){if(this.status>=200&&this.status<300)try{e._starData=JSON.parse(this.response),e.sendRedrawRequest()}catch(t){C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+t.toString())}else C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);e._loadStarted=!1},t.onerror=function(){C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),e._loadStarted=!1},t.ontimeout=function(){C.log(C.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),e._loadStarted=!1},t.open("GET",this._starDataSource,!0),t.send()}}},{key:"createStarsGeometry",value:function(){var e=this.parseStarsMetadata(this._starData.metadata);if(-1===e.raIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(-1===e.decIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(-1===e.magIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var t=this._starData.data,n=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var a=0,r=t.length;a<r;a++){var i=t[a],o=i[e.decIndex],s=i[e.raIndex],c=i[e.magIndex],l=c<2?2:1;n.push(o,s,l,c),this._minMagnitude=Math.min(this._minMagnitude,c),this._maxMagnitude=Math.max(this._maxMagnitude,c)}return this._numStars=Math.floor(n.length/4),n}},{key:"parseStarsMetadata",value:function(e){for(var t=-1,n=-1,a=-1,r=0,i=e.length;r<i;r++){var o=e[r];"ra"===o.name&&(t=r),"dec"===o.name&&(n=r),"vmag"===o.name&&(a=r)}return{raIndex:t,decIndex:n,magIndex:a}}},{key:"invalidateStarData",value:function(){this._starData=null,this._starsPositionsVboCacheKey=null}},{key:"sendRedrawRequest",value:function(){var e=document.createEvent("Event");e.initEvent(P,!0,!0),window.dispatchEvent(e)}}]),n}(N),k=n(25),F=n.n(k),U=m.a.Color,B=[{key:"s1a",name:"SENTINEL-1A",shortName:"S-1A",satIndex:0,swathTypes:["black","red","green","white"],swathColors:[U.colorFromKmlHex("ff000000"),U.colorFromKmlHex("ff0000ff"),U.colorFromKmlHex("ff00ff00"),U.colorFromKmlHex("ffffffff")],swatModes:["IW","EW","SM"],tleLineOne:"1 39634U 14016A   18124.03591006  .00000001  00000-0  10014-4 0  9998",tleLineTwo:"2 39634  98.1819 132.0838 0001369  78.7198 281.4156 14.59198520217480",hasModel:!0,filePath:"./satellites/sentinel1/s1.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0,launchDate:new Date("2014-04-03T21:02:00.000Z")},{key:"s2a",name:"SENTINEL-2A",shortName:"S-2A",satIndex:1,swathTypes:["red","purple","white","darkGrey","green","greener"],swathColors:[U.colorFromKmlHex("ff0000ff"),U.colorFromKmlHex("ffff00ff"),U.colorFromKmlHex("ffffffff"),U.colorFromKmlHex("ff7f7f7f"),U.colorFromKmlHex("ff00ff00"),U.colorFromKmlHex("ff00fff7")],swatModes:["NOBS"],tleLineOne:"1 40697U 15028A   18124.08865983  .00000004  00000-0  17994-4 0  9993",tleLineTwo:"2 40697  98.5686 199.4434 0001286  92.5669 267.5666 14.30817033149583",hasModel:!0,filePath:"./satellites/senti2version6/s2.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:1e6,translations:{x:.1,y:.385,z:.02},ignoreLocalTransforms:!0,launchDate:new Date("2015-06-23T01:52:00.000Z")},{key:"s3a",name:"SENTINEL-3A",shortName:"S-3A",satIndex:2,tleLineOne:"1 41335U 16011A   18124.14356592 -.00000000  00000-0  18017-4 0  9998",tleLineTwo:"2 41335  98.6266 192.0005 0001035 100.1921 259.9376 14.26736754115121",hasModel:!0,filePath:"./satellites/Sentinel3/s3.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:180,headingMultiply:1},preRotations:{x:0,y:180,z:0},scale:1e6,translations:{x:.01,y:1.98,z:.07},ignoreLocalTransforms:!0,launchDate:new Date("2016-02-16T17:57:00.000Z")},{key:"s1b",name:"SENTINEL-1B",shortName:"S-1B",satIndex:3,swathTypes:["black","red","green","white"],swathColors:[U.colorFromKmlHex("ff000000"),U.colorFromKmlHex("ff0000ff"),U.colorFromKmlHex("ff00ff00"),U.colorFromKmlHex("ffffffff")],swatModes:["IW","EW","SM"],tleLineOne:"1 41456U 16025A   18124.13828432 -.00000022  00000-0  49756-5 0  9992",tleLineTwo:"2 41456  98.1817 132.0102 0001487  82.9964 277.1419 14.59197806107664",hasModel:!0,filePath:"./satellites/sentinel1/s1.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0,launchDate:new Date("2016-04-25T21:02:00.000Z")},{key:"s2b",name:"SENTINEL-2B",shortName:"S-2B",satIndex:4,swathTypes:["blue"],swathColors:[U.colorFromKmlHex("ffffff00")],swatModes:["NOBS"],tleLineOne:"1 42063U 17013A   18124.12358125  .00000002  00000-0  17497-4 0  9994",tleLineTwo:"2 42063  98.5687 199.4702 0001382  97.5073 262.6270 14.30817718 60503",groundPosition:{latitude:5.2079,longitude:-52.7724,altitude:0},hasModel:!0,filePath:"./satellites/senti2version6/s2.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:1e6,translations:{x:.1,y:.385,z:.02},ignoreLocalTransforms:!0,launchDate:new Date("2017-03-07T01:49:00.000Z")},{key:"s5p",name:"SENTINEL-5P",shortName:"S-5P",satIndex:5,swathTypes:[],swathColors:[],tleLineOne:"1 42969U 17064A   18123.85141871 -.00000009  00000-0  16636-4 0  9994",tleLineTwo:"2 42969  98.7352  64.1585 0001101  78.1817 281.9482 14.19565315 28712",groundPosition:{latitude:62.92786,longitude:40.57483,altitude:0},hasModel:!0,filePath:"./satellites/sentinel5p/s5p.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:210,y:0,z:0},scale:7e4,translations:{x:.5,y:.4,z:-1.2},ignoreLocalTransforms:!0,launchDate:new Date("2017-10-13T09:27:00.000Z")},{key:"s3b",name:"SENTINEL-3B",shortName:"S-3B",satIndex:6,tleLineOne:"1 43437U 18039A   18122.61596633  .00002473  00000-0  10753-2 0  9999",tleLineTwo:"2 43437  98.6226 190.4610 0008811 292.4467  67.5830 14.24954518   977",groundPosition:{latitude:62.925556,longitude:40.577778,altitude:0},hasModel:!0,filePath:"satellites/Sentinel3/s3.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:180,headingMultiply:1},preRotations:{x:0,y:180,z:0},scale:1e6,translations:{x:.01,y:1.98,z:.07},ignoreLocalTransforms:!0,launchDate:new Date("2018-04-25T17:57:00.000Z")}],z=B,G=n(16),V=m.a.ArgumentError,K=m.a.BasicTextureProgram,H=m.a.Color,q=m.a.Logger,Y=m.a.Matrix,W=(m.a.Position,m.a.PickedObject),Z=m.a.Renderable,X=m.a.Vec3,J=function(e,t){if(!e)throw new V(q.logMessage(q.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));Z.call(this),this._position=e,this._nodes=[],this._meshes={},this._materials={},this._images={},this._upAxis="",this._dirPath="",this._xRotation=0,this._yRotation=0,this._zRotation=0,this.preX=0,this.preY=0,this.preZ=0,this._xTranslation=0,this._yTranslation=0,this._zTranslation=0,this._scale=1,this._altitudeMode=m.a.ABSOLUTE,this._localTransforms=!0,this._useTexturePaths=!0,this._nodesToHide=[],this._hideNodes=!1,this._placePoint=new X(0,0,0),this._transformationMatrix=Y.fromIdentity(),this._mvpMatrix=Y.fromIdentity(),this._normalTransformMatrix=Y.fromIdentity(),this._normalMatrix=Y.fromIdentity(),this._texCoordMatrix=Y.fromIdentity().setToUnitYFlip(),this._entities=[],this._activeTexture=null,this._tmpVector=new X(0,0,0),this._tmpColor=new H(1,1,1,1),this._vboCacheKey="",this._iboCacheKey="",this.setSceneData(t)};(J.prototype=Object.create(Z.prototype)).constructor=J,Object.defineProperties(J.prototype,{position:{get:function(){return this._position},set:function(e){this._position=e}},nodes:{get:function(){return this._nodes},set:function(e){this._nodes=e}},meshes:{get:function(){return this._meshes},set:function(e){this._meshes=e}},materials:{get:function(){return this._materials},set:function(e){this._materials=e}},images:{get:function(){return this._images},set:function(e){this._images=e}},upAxis:{get:function(){return this._upAxis},set:function(e){this._upAxis=e}},dirPath:{get:function(){return this._dirPath},set:function(e){this._dirPath=e}},xRotation:{get:function(){return this._xRotation},set:function(e){this._xRotation=e}},yRotation:{get:function(){return this._yRotation},set:function(e){this._yRotation=e}},zRotation:{get:function(){return this._zRotation},set:function(e){this._zRotation=e}},xTranslation:{get:function(){return this._xTranslation},set:function(e){this._xTranslation=e}},yTranslation:{get:function(){return this._yTranslation},set:function(e){this._yTranslation=e}},zTranslation:{get:function(){return this._zTranslation},set:function(e){this._zTranslation=e}},scale:{get:function(){return this._scale},set:function(e){this._scale=e}},placePoint:{get:function(){return this._placePoint},set:function(e){this._placePoint=e}},altitudeMode:{get:function(){return this._altitudeMode},set:function(e){this._altitudeMode=e}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(e){this._transformationMatrix=e}},normalMatrix:{get:function(){return this._normalMatrix},set:function(e){this._normalMatrix=e}},localTransforms:{get:function(){return this._localTransforms},set:function(e){this._localTransforms=e}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(e){this._useTexturePaths=e}},nodesToHide:{get:function(){return this._nodesToHide},set:function(e){this._nodesToHide=e}},hideNodes:{get:function(){return this._hideNodes},set:function(e){this._hideNodes=e}}}),J.prototype.setSceneData=function(e){e&&(this._nodes=e.root.children,this._meshes=e.meshes,this._materials=e.materials,this._images=e.images,this._upAxis=e.metadata.up_axis,this._dirPath=e.dirPath,this.flattenModel())},J.prototype.flattenModel=function(){for(var e=0,t=this._nodes.length;e<t;e++)this.flattenNode(this._nodes[e]);this._entities.sort((function(e,t){var n=null===e.imageKey?"":""+e,a=null===t.imageKey?"":""+t;return n>a?1:n===a?0:-1}))},J.prototype.flattenNode=function(e){if(e.mesh)for(var t=e.mesh,n=this._meshes[t].buffers,a=0,r=n.length;a<r;a++){for(var i=n[a].material,o=0;o<e.materials.length;o++)if(i===e.materials[o].symbol){var s=e.materials[o].id;break}var c=this._materials[s],l=null;c&&c.textures&&n[a].uvs&&n[a].uvs.length>0&&(c.textures.diffuse?l=c.textures.diffuse.mapId:c.textures.reflective&&(l=c.textures.reflective.mapId)),this._entities.push({mesh:n[a],material:c,node:e,imageKey:l})}for(var u=0;u<e.children.length;u++)this.flattenNode(e.children[u])},J.prototype.render=function(e){var t,n=e.frustumInModelCoordinates;this.enabled&&(this.lastFrameTime!==e.timestamp&&(t=this.makeOrderedRenderable(e)),t&&n.containsPoint(this._placePoint)&&(t.layer=e.currentLayer,this.lastFrameTime=e.timestamp,e.addOrderedRenderable(t)))},J.prototype.makeOrderedRenderable=function(e){return e.surfacePointForMode(this._position.latitude,this._position.longitude,this._position.altitude,this._altitudeMode,this._placePoint),this.eyeDistance=e.eyePoint.distanceTo(this._placePoint),this},J.prototype.renderOrdered=function(e){if(this.drawOrderedScene(e),e.pickingMode){var t=new W(this.pickColor.clone(),this,this._position,this.layer,!1);e.resolvePick(t)}},J.prototype.drawOrderedScene=function(e){try{this.beginDrawing(e)}finally{this.endDrawing(e)}},J.prototype.beginDrawing=function(e){var t=e.currentGlContext,n=e.gpuResourceCache,a=n.resourceForKey(this._vboCacheKey),r=n.resourceForKey(this._iboCacheKey);a||(this.setupBuffers(e),a=n.resourceForKey(this._vboCacheKey),r=n.resourceForKey(this._iboCacheKey)),t.bindBuffer(t.ARRAY_BUFFER,a),r&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),e.findAndBindProgram(K),t.enableVertexAttribArray(0),e.pickingMode&&(this.pickColor=e.uniquePickColor()),this.computeTransformationMatrix(e.globe);for(var i=0,o=this._entities.length;i<o;i++){this.mustRenderNode(this._entities[i].node.id)&&this.draw(e,this._entities[i])}},J.prototype.setupBuffers=function(e){for(var t=e.currentGlContext,n=Float32Array.BYTES_PER_ELEMENT||4,a=Uint16Array.BYTES_PER_ELEMENT||2,r=Uint32Array.BYTES_PER_ELEMENT||4,i=!1,o=0,s=0,c=0,l=this._entities.length;c<l;c++){var u=this._entities[c].mesh;u.indexedRendering&&(o+=u.indices.length,u.indices instanceof Uint32Array&&(i=!0)),s+=u.vertices.length,this._entities[c].imageKey&&(s+=u.uvs.length),u.normals&&u.normals.length&&(s+=u.normals.length)}var d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,s*n,t.STATIC_DRAW);var h=0;for(c=0,l=this._entities.length;c<l;c++){var f=this._entities[c].mesh.vertices;this._entities[c].vertexOffset=h,t.bufferSubData(t.ARRAY_BUFFER,h*n,f),h+=f.length}for(c=0,l=this._entities.length;c<l;c++)this._entities[c].imageKey&&(f=this._entities[c].mesh.uvs,this._entities[c].uvOffset=h,t.bufferSubData(t.ARRAY_BUFFER,h*n,f),h+=f.length);for(c=0,l=this._entities.length;c<l;c++)(f=f=this._entities[c].mesh.normals)&&f.length&&(this._entities[c].normalOffset=h,t.bufferSubData(t.ARRAY_BUFFER,h*n,f),h+=f.length);var m,g=a,p=o*g;if(i&&((m=e.getExtension("OES_element_index_uint"))?p=o*(g=r):q.log(q.LEVEL_SEVERE,'The 3D model is too big and might not render properly. \nYour browser does not support the "OES_element_index_uint" extension, required to render large models.')),o){var b=t.createBuffer();for(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,b),t.bufferData(t.ELEMENT_ARRAY_BUFFER,p,t.STATIC_DRAW),h=0,c=0,l=this._entities.length;c<l;c++)(u=this._entities[c].mesh).indexedRendering&&((f=u.indices)instanceof Uint32Array&&!m&&(f=new Uint16Array(f)),this._entities[c].indexOffset=h,this._entities[c].indexSize=g,t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,h*g,f),h+=f.length)}this._vboCacheKey=e.gpuResourceCache.generateCacheKey(),e.gpuResourceCache.putResource(this._vboCacheKey,d,s*n),o&&(this._iboCacheKey=e.gpuResourceCache.generateCacheKey(),e.gpuResourceCache.putResource(this._iboCacheKey,b,p))},J.prototype.draw=function(e,t){var n=e.currentGlContext,a=e.currentProgram,r=e.gpuResourceCache,i=t.mesh,o=t.material,s=t.node.worldMatrix,c=t.node.normalMatrix,l=i.normals&&i.normals.length,u=t.imageKey;if(this.applyColor(e,o),u){var d=this._useTexturePaths?this._images[u].path:this._images[u].filename,h=this._dirPath+d;if(this._activeTexture=r.resourceForKey(h),!this._activeTexture){var f=i.isClamp?n.CLAMP_TO_EDGE:n.REPEAT;this._activeTexture=r.retrieveTexture(n,h,f)}this._activeTexture&&this._activeTexture.bind(e)?(a.loadTextureEnabled(n,!0),n.vertexAttribPointer(2,2,n.FLOAT,!1,8,4*t.uvOffset),n.enableVertexAttribArray(2),a.loadModulateColor(n,e.pickingMode)):(a.loadTextureEnabled(n,!1),n.disableVertexAttribArray(2))}else a.loadTextureEnabled(n,!1),n.disableVertexAttribArray(2);if(l&&!e.pickingMode?(a.loadApplyLighting(n,1),n.vertexAttribPointer(1,3,n.FLOAT,!1,12,4*t.normalOffset),n.enableVertexAttribArray(1)):(a.loadApplyLighting(n,0),n.disableVertexAttribArray(1)),this.applyMatrix(e,l,h,s,c),n.vertexAttribPointer(0,3,n.FLOAT,!1,12,4*t.vertexOffset),i.indexedRendering){var m=t.indexOffset*t.indexSize;i.indices instanceof Uint32Array&&e.getExtension("OES_element_index_uint")?n.drawElements(n.TRIANGLES,i.indices.length,n.UNSIGNED_INT,m):n.drawElements(n.TRIANGLES,i.indices.length,n.UNSIGNED_SHORT,m)}else n.drawArrays(n.TRIANGLES,0,Math.floor(i.vertices.length/3))},J.prototype.applyColor=function(e,t){var n,a=e.currentGlContext,r=e.currentProgram;if(t)if("constant"===t.techniqueType)var i=t.reflective;else i=t.diffuse;var o=1,s=1,c=1,l=1;i&&(o=i[0],s=i[1],c=i[2],l=null!=i[3]?i[3]:1),this._tmpColor.set(o,s,c,l),n=l*this.layer.opacity,a.depthMask(n>=1||e.pickingMode),r.loadColor(a,e.pickingMode?this.pickColor:this._tmpColor),r.loadOpacity(a,e.pickingMode?n>0?1:0:n)},J.prototype.applyMatrix=function(e,t,n,a,r){this._mvpMatrix.copy(e.modelviewProjection),this._mvpMatrix.multiplyMatrix(this._transformationMatrix),a&&this._localTransforms&&this._mvpMatrix.multiplyMatrix(a),t&&!e.pickingMode&&(this._normalMatrix.copy(e.modelviewNormalTransform),this._normalMatrix.multiplyMatrix(this._normalTransformMatrix),r&&this._localTransforms&&this._normalMatrix.multiplyMatrix(r),e.currentProgram.loadModelviewInverse(e.currentGlContext,this._normalMatrix)),n&&this._activeTexture&&(e.currentProgram.loadTextureMatrix(e.currentGlContext,this._texCoordMatrix),this._activeTexture=null),e.currentProgram.loadModelviewProjection(e.currentGlContext,this._mvpMatrix)},J.prototype.endDrawing=function(e){var t=e.currentGlContext,n=e.currentProgram;t.disableVertexAttribArray(1),t.disableVertexAttribArray(2),n.loadApplyLighting(t,0),n.loadTextureEnabled(t,!1)},J.prototype.computeTransformationMatrix=function(e){this._transformationMatrix.setToIdentity(),this._transformationMatrix.multiplyByLocalCoordinateTransform(this._placePoint,e),this._transformationMatrix.multiplyByRotation(1,0,0,this._xRotation),this._transformationMatrix.multiplyByRotation(0,1,0,this._yRotation),this._transformationMatrix.multiplyByRotation(0,0,1,this._zRotation),this._transformationMatrix.multiplyByScale(this._scale,this._scale,this._scale),this._transformationMatrix.multiplyByTranslation(this._xTranslation,this._yTranslation,this._zTranslation),this._transformationMatrix.multiplyByRotation(1,0,0,this.preX),this._transformationMatrix.multiplyByRotation(0,1,0,this.preY),this._transformationMatrix.multiplyByRotation(0,0,1,this.preZ),this.computeNormalMatrix()},J.prototype.computeNormalMatrix=function(){this._transformationMatrix.extractRotationAngles(this._tmpVector),this._normalTransformMatrix.setToIdentity(),this._normalTransformMatrix.multiplyByRotation(-1,0,0,this._tmpVector[0]),this._normalTransformMatrix.multiplyByRotation(0,-1,0,this._tmpVector[1]),this._normalTransformMatrix.multiplyByRotation(0,0,-1,this._tmpVector[2])},J.prototype.mustRenderNode=function(e){var t=!0;this._hideNodes&&(t=-1===this._nodesToHide.indexOf(e));return t};for(var Q=J,$=m.a.Matrix,ee=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(e,a,r){var i;Object(g.a)(this,n),(i=t.call(this))._satellite=a;var o=i.parse(e);return i.draw(r,o),i}return Object(p.a)(n,[{key:"position",value:function(e){this._model.position=e}},{key:"draw",value:function(e,t){var n=this._satellite,a=n.rotations,r=n.translations,i=n.preRotations,o=n.scale,s=n.shortName,c=n.ignoreLocalTransforms,l=new Q(e,t);l.type=this.type,l.satShortName=s,l.nodesToHide=["PlatformCircleAndName","SolarWingsCircleAndName","C-SarCircleAndName","PlatformTextsAndArrows","SolarWingsTextsAndArrows","C-SarTextsAndArrows","SolarArrayGroup","WingsDetailsGroup","Group004","MsiGroup","SatelliteGroup","SatelliteDimensionsGroup","MWRGroup","SRALGroup","OLCIGroup","SLSTRGroup"],l.hideNodes=!0,l.useTexturePaths=!1,l.localTransforms=c,l.scale=o,l.xRotation=a.x,l.yRotation=a.y,l.zRotation=a.z,l.xTranslation=r.x,l.yTranslation=r.y,l.zTranslation=r.z,l.preX=i.x,l.preY=i.y,l.preZ=i.z,this._model=l,t=null}},{key:"parse",value:function(e){var t=e.meshes,n=e.root.children,a=e.materials;for(var r in t)if(t.hasOwnProperty(r))for(var i=t[r].buffers,o=0;o<i.length;o++){var s=i[o].vertices||[],c=i[o].normals||[],l=i[o].uvs||[],u=i[o].indices||[],d=new Float32Array(s),h=new Float32Array(c),f=new Float32Array(l),m=new Uint16Array(u);i[o].vertices=d,i[o].normals=h,i[o].uvs=f,i[o].indices=m}for(var g=0;g<n.length;g++){var p=n[g];if(p.mesh){var b=p.worldMatrix.slice(0);p.worldMatrix=$.fromIdentity(),p.worldMatrix.copy(b),p.children.length&&console.info("node has children",p)}}for(var v in a)if(a.hasOwnProperty(v)){var O=a[v];"_3_-_Default-material"===O.id?O.reflective&&(O.reflective[0]=.289219,O.reflective[1]=.713497,O.reflective[2]=.870753,O.reflective[3]=1):"_1_-_Default_004-material"===O.id||"_1_-_Default-material"===O.id?O.diffuse[3]=0:"Chrome-material"===O.id?(O.textures=null,O.diffuse[0]=.3137,O.diffuse[1]=.3137,O.diffuse[2]=.3137):"Satellite_panel-material"===O.id?O.textures.reflective.mapId="image9":"_3_-_Default"===O.id?O.textures.reflective.mapId="image4":"_4_-_Default-material"===O.id?O.textures.reflective.mapId="image5":"_5_-_Default_002-material"===O.id?O.textures.reflective.mapId="image6":"_5_-_Default-material"===O.id&&(O.textures.reflective.mapId="image5")}return e}},{key:"render",value:function(e){this._model&&this.enabled&&this._model.render(e)}}]),n}(m.a.Renderable),te=m.a.RenderableLayer,ne=m.a.Position,ae=F.a.EoUtils,re={rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0},ie=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(e,a){var r;return Object(g.a)(this,n),(r=t.call(this,e)).type="SatelliteModelLayer",r._satelliteOptions=a,r._rerenderMap=null,r.key=e.key,r.model=null,r.time=e.time,r.Tle=null,r.heading=null,r.onLayerChanged=e.onLayerChanged||null,r}return Object(p.a)(n,[{key:"setModel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=arguments.length>2?arguments[2]:void 0;e&&(this.model=new ee(e,t,n),this.removeAllRenderables(),this.addRenderable(this.model),this.doRerender())}},{key:"setPosition",value:function(e){e&&this.model&&this.model.position(e)}},{key:"setTle",value:function(e){e&&(this.Tle=e,this.update())}},{key:"update",value:function(){if(this.Tle&&this.time){var e=ae.computeSatrec.apply(ae,Object(G.a)(this.Tle)),t=ae.getOrbitPosition(e,new Date(this.time));this.setPosition(new ne(t.latitude,t.longitude,t.altitude)),this.model&&this.alignWithOrbit(this.time,t,ae.computeSatrec.apply(ae,Object(G.a)(this.Tle)),this._satelliteOptions.rotations,this.model._model),this.doRerender()}}},{key:"alignWithOrbit",value:function(e,t,n,a,r){var i=e.getTime(),o=ae.getOrbitPosition(n,new Date(i+1e4)),s=ae.headingAngleRadians(t.latitude,t.longitude,o.latitude,o.longitude),c=ae.rad2deg(s);this.heading=c,"function"===typeof this.onLayerChanged&&this.onLayerChanged({satKey:this.satName,layerKey:this.key,type:this.type},{update:{heading:this.heading}});var l=(c+a.headingAdd)*a.headingMultiply;0!==c&&(1===a.headingAxis[0]?r.xRotation=l:1===a.headingAxis[1]?r.yRotation=l:1===a.headingAxis[2]&&(r.zRotation=l))}},{key:"setTime",value:function(e){e&&(this.time=e,this.update())}},{key:"setRerender",value:function(e){"function"===typeof e&&(this._rerenderMap=e)}},{key:"doRerender",value:function(){"function"===typeof this._rerenderMap&&this._rerenderMap()}}]),n}(te),oe=F.a.EoUtils,se=[],ce=function(e){console.log(z[e].name);var t={rotations:z[e].rotations,preRotations:z[e].preRotations,scale:z[e].scale,translations:z[e].translations,ignoreLocalTransforms:z[e].ignoreLocalTransforms},n=new ie({key:z[e].key,time:new Date},t),a=oe.computeSatrec(z[e].tleLineOne,z[e].tleLineTwo),r=oe.getOrbitPosition(a,new Date);fetch(z[e].filePath).then((function(e){return e.json()})).then((function(t){n.setModel(t,{rotations:z[e].rotations,preRotations:z[e].preRotations,scale:z[e].scale,translations:z[e].translations,ignoreLocalTransforms:z[e].ignoreLocalTransforms},r)})),n.setTle([z[e].tleLineOne,z[e].tleLineTwo]),se.push(n)},le=0;le<z.length;le++)ce(le);var ue=se,de=[{service:"https://tiles.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018 esa",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"osm",title:"osm",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"terrain-light",title:"terrain-light",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)},{service:"https://tiles.maps.eox.at/wms",layerNames:"terrain",title:"terrain",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)}],he=[{service:"https://tiles.maps.eox.at/wms",layerNames:"hydrography",title:"hydrography",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)},{service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",title:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:m.a.Sector.FULL_SPHERE,levelZeroDelta:new m.a.Location(90,90)}];function fe(e){var t=e.id,n=e.clon,r=e.clat,i=e.alt,o=e.starfield,c=e.atmosphere,u=e.background,f=e.overlay,g=e.names,p=e.satellites,b=e.dem,v=Object(a.useRef)(null),O=Object(a.useState)("3D"),_=Object(s.a)(O,2),j=(_[0],_[1]),y=Object(a.useState)(""),S=Object(s.a)(y,2),x=(S[0],S[1],Object(a.useState)([])),E=Object(s.a)(x,2),M=(E[0],E[1],Object(a.useState)({latitude:r,longitude:n,altitude:i,aoi:"",pickedItems:[]})),T=Object(s.a)(M,2),A=T[0],w=T[1],R=Object(a.useRef)(b),D=Object(a.useRef)(0),N=Object(a.useRef)(0);Object(a.useRef)(0),Object(a.useRef)(0);function C(){var e=v.current,t=e.navigator.heading/-20;setTimeout((function n(){Math.abs(e.navigator.heading)>Math.abs(t)?(e.navigator.heading+=t,setTimeout(n,10)):e.navigator.heading=0,e.redraw()}),10)}function L(e){console.log("toggleAtmosphere: "+e),G("Atmosphere").enabled=null!=e?e:!G("Atmosphere").enabled,v.current.redraw()}function P(e){console.log("toggleModel: "+e);for(var t=0;t<ue.length;t++)ue[t].enabled=null!=e?e:!ue[t].enabled;v.current.redraw()}function k(e){console.log("toggleStarfield: "+e),G("StarField").enabled=null!==e?e:!G("StarField").enabled,v.current.redraw()}function F(e){console.log("toggleNames: "+e),G("overlay_bright").enabled=null!==e?e:!G("overlay_bright").enabled,v.current.redraw()}function U(e){v.current.layers[D.current].enabled=!1,D.current=null===e?D.current+1:(e-1)%de.length,console.log("Background Layer ["+(D.current+1)+"/"+de.length+"]: "+v.current.layers[D.current].displayName),v.current.layers[D.current].enabled=!0,v.current.redraw()}function B(e){v.current.layers[N.current+de.length].enabled=!1,N.current=null===e?N.current+1:(e-1)%he.length,v.current.layers[N.current+de.length].enabled=!0,v.current.redraw()}function z(e){var t;R.current=null!==e?e:!R.current,R.current?(console.log("Switching to Copernicus Dem"),(t=new m.a.ElevationModel).addCoverage(new m.a.TiledElevationCoverage({coverageSector:m.a.Sector.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"image/tiff",minElevation:-11e3,maxElevation:8850,urlBuilder:new m.a.WcsTileUrlBuilder("https://dem.esa.maps.eox.at/elevation","copdem","2.0.1")}))):(console.log("Switching to NASA Dem"),t=new m.a.EarthElevationModel),v.current.globe.elevationModel=t,v.current.redraw()}function G(e){for(var t=0;t<v.current.layers.length;t++)if(v.current.layers[t].displayName===e)return v.current.layers[t];return null}function V(e){return K.apply(this,arguments)}function K(){return(K=Object(h.a)(d.a.mark((function e(t){var n,a,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=G("Products"),864e5,a=0;a<n.renderables.length;a++)r=n.renderables[a],0!=t?(i=new Date(r.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime).getTime(),r.enabled=i>t-864e5&&i<=t):r.enabled=!1;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=function(){var e=v.current.navigator.lookAtLocation.longitude,t=v.current.navigator.lookAtLocation.latitude,n=v.current.navigator.range,a=n<2e6?function(){var e,t,n=v.current.viewport,a="";try{(e=v.current.pickTerrain(v.current.canvasCoordinates(n.x,n.y+n.height)).terrainObject().position).latitude=Math.round(1e4*e.latitude)/1e4,e.longitude=Math.round(1e4*e.longitude)/1e4}catch(r){e=null}try{(t=v.current.pickTerrain(v.current.canvasCoordinates(n.x+n.width,n.y)).terrainObject().position).latitude=Math.round(1e4*t.latitude)/1e4,t.longitude=Math.round(1e4*t.longitude)/1e4}catch(r){t=null}return null==e||null==t?a="":(e.longitude,e.latitude,t.longitude,t.latitude,a="POLYGON(("+e.longitude+" "+e.latitude+","+t.longitude+" "+e.latitude+","+t.longitude+" "+t.latitude+","+e.longitude+" "+t.latitude+","+e.longitude+" "+e.latitude+"))"),a}():"",r="POINT("+e.toFixed(4)+" "+t.toFixed(4)+")";w((function(i){return Object(l.a)(Object(l.a)({},i),{},{longitude:e,latitude:t,altitude:n,viewpolygon:a,viewpoint:r})}))};return Object(a.useEffect)((function(){console.log("Creating the world...");var e=new m.a.ElevationModel;e.removeAllCoverages(),e.addCoverage(new m.a.TiledElevationCoverage({coverageSector:m.a.Sector.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"image/tiff",minElevation:-11e3,maxElevation:8850,urlBuilder:new m.a.WcsTileUrlBuilder("https://dem.esa.maps.eox.at/elevation","copdem","2.0.1")})),v.current=new m.a.WorldWindow(t),v.current.redrawCallbacks.push(H),v.current.navigator.range=i,m.a.BasicWorldWindowController.prototype.applyLimits=function(){v.current.navigator.range=m.a.WWMath.clamp(v.current.navigator.range,1,3e8),console.log("limit")},m.a.configuration.baseUrl=window.location.href;for(var n=new I,a=new m.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg"),r=new m.a.RenderableLayer("Quicklooks"),s=new m.a.RenderableLayer("Products"),l=[{layer:n,enabled:o},{layer:a,enabled:c},{layer:r,enabled:!0},{layer:s,enabled:!0}],u=0;u<de.length;u++){var d=new m.a.WmsLayer(de[u],"");d.enabled=!1,v.current.addLayer(d,"")}for(var h=0;h<he.length;h++){var f=new m.a.WmsLayer(he[h],"");f.enabled=!1,v.current.addLayer(f,"")}for(var g=0;g<l.length;g++)l[g].layer.enabled=l[g].enabled,v.current.addLayer(l[g].layer);for(var b=0;b<ue.length;b++)ue.enabled=p,v.current.addLayer(ue[b]);console.log(v.current.layers),n.time=new Date,a.time=new Date,v.current.redraw(),v.current.deepPicking=!0}),[]),Object(a.useEffect)((function(){U(u)}),[u]),Object(a.useEffect)((function(){B(f)}),[f]),Object(a.useEffect)((function(){F(g)}),[g]),Object(a.useEffect)((function(){L(c)}),[c]),Object(a.useEffect)((function(){k(o)}),[o]),Object(a.useEffect)((function(){P(p)}),[p]),Object(a.useEffect)((function(){z(b)}),[b]),{eww:v,ewwstate:A,moveTo:function(e,t,n){v.current.goToAnimator.travelTime=1e3,v.current.goTo(new m.a.Position(e,t)),v.current.navigator.range=n,v.current.navigator.camera.applyLimits(),v.current.redraw()},removeGeojson:function(){G("Products").removeAllRenderables(),v.current.redraw()},addGeojson:function(e,t){var n=G("Products");new m.a.GeoJSONParser(e).load((function(){V(t),v.current.redraw()}),(function(e,t){var n={};n.userProperties=t;var a=new m.a.PlacemarkAttributes(null);return a.imageScale=10,a.imageColor=new m.a.Color(0,1,1,.2),a.labelAttributes.offset=new m.a.Offset(m.a.OFFSET_FRACTION,5,m.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?n.attributes=new m.a.PlacemarkAttributes(a):e.isLineStringType()||e.isMultiLineStringType()?(n.attributes.drawOutline=!0,n.attributes.outlineColor=new m.a.Color(.1*n.attributes.interiorColor.red,.3*n.attributes.interiorColor.green,.7*n.attributes.interiorColor.blue,1),n.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(n.attributes=new m.a.ShapeAttributes(null),n.attributes.interiorColor=new m.a.Color(1,0,0,.2),n.attributes.outlineColor=new m.a.Color(1,0,0,.3),n.highlightAttributes=new m.a.ShapeAttributes(n.attributes),n.highlightAttributes.outlineColor=new m.a.Color(1,0,0,.4),n.highlightAttributes.interiorColor=new m.a.Color(1,0,0,0)),n}),n)},addWMS:function(){},toggleStarfield:k,toggleAtmosphere:L,setTime:function(e){G("StarField").time=G("Atmosphere").time=new Date(e),V(e);for(var t=0;t<ue.length;t++)ue[t].setTime(new Date(e));v.current.redraw()},toggleProjection:function(){j((function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator","North Polar","South Polar"],n=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[n]),t[n]){case"3D":v.current.globe.projection=new m.a.ProjectionWgs84;break;case"Equirectangular":v.current.globe.projection=new m.a.ProjectionEquirectangular;break;case"Mercator":v.current.globe.projection=new m.a.ProjectionMercator;break;case"North Polar":v.current.globe.projection=new m.a.ProjectionPolarEquidistant("North");break;case"South Polar":v.current.globe.projection=new m.a.ProjectionPolarEquidistant("South");break;default:v.current.globe.projection=new m.a.ProjectionWgs84}return v.current.redraw(),t[n]}))},toggleNames:F,toggleModel:P,toggleBg:U,toggleOv:B,toggleDem:z,northUp:C}}var me=n(8),ge=n(17),pe=n(13),be=n(27),ve=(n(86),n(2));var Oe=Object(a.memo)((function(e){var t=e.world,n=Object(a.useRef)(),r=Object(a.useRef)(),i=Object(a.useRef)(),o=Object(a.useRef)(),c=Object(a.useRef)(),u=(Object(a.useRef)(),Object(a.useRef)()),d=Object(a.useRef)(),h=Object(a.useRef)(!0),f=Object(a.useRef)(!1),g=Object(a.useRef)("undefined"),p=Object(a.useState)({}),b=Object(s.a)(p,2),v=(b[0],b[1],Object(a.useRef)(),Object(a.useState)([])),O=Object(s.a)(v,2),_=O[0],j=(O[1],Object(pe.useSpring)((function(){return{x:0,y:0}}))),y=Object(s.a)(j,2),S=y[0],x=S.x,E=S.y,M=y[1],T=Object(ge.a)((function(e){var t=Object(s.a)(e.offset,2),n=t[0],a=t[1];return M.start({x:n,y:a})})),A=Object(ve.jsx)(pe.animated.div,Object(l.a)(Object(l.a)({},T()),{},{style:{x:x,y:E},className:"Debug",children:_}));Object(ge.b)({onDrag:function(e){var n,a=e.event,s=e.xy,l=e.vxvy,u=e.previous,m=e.first,g=e.down,p=e.initial,b=e.delta,v=e.movement,O=e.offset,_=e.velocity,j=e.direction,y=e.tap,S=e.scrolling,x=e.touches,E=e.pinching;e.origin;switch(m&&(d.current=de(s[0],s[1]),d.current||(d.current=de(t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2)),n=a,o.current=n.button,r.current&&n.timeStamp-r.current<300?i.current=!0:(r.current=n.timeStamp,i.current=!1),i.current&&clearTimeout(c.current)),!0){case!i.current&&y:c.current=setTimeout((function(){console.log("simple click")}),300);break;case i.current&&y:clearTimeout(c.current),console.log("double click"),function(){var e=t.current.navigator.heading/-20,n=function n(){Math.abs(t.current.navigator.heading)>Math.abs(e)?(t.current.navigator.heading+=e,setTimeout(n,10)):(t.current.navigator.heading=0,f.current=!1),t.current.redraw()};setTimeout(n,10)}();break;case!i.current&&!y&&2!=o.current&&2!=x:if(!h.current)return;se.stop(),B.stop(),H.stop(),C.stop(),t.current.globe.is2D()?ne(a,p,g,b,O,v,_,j,s,u,m,S):ae(a,p,g,b,O,l,_,j,s,u,m,S,x,E);break;case i.current&&!y:se.stop(),ce(a,p,g,b,O,v,_,j,s,u,m,S);break;case!i.current&&!y&&2==o.current:J(g,b,!0)}},onDragend:function(){console.log("drag end")},onWheel:function(e){var t=e.event,n=e.xy,a=e.previous,r=e.first,i=e.down,o=e.initial,s=e.delta,c=e.movement,l=e.offset,u=e.velocity,h=e.direction,f=(e.tap,e.scrolling);r&&(d.current=de(t.clientX,t.clientY)),ce(t,o,i,s,l,c,u,h,n,a,r,f)},onPinchStart:function(e){h.current=!1,te.stop(),se.stop(),B.stop(),H.stop(),C.stop(),g.current="undefined"},onPinch:function(e){var t=e.event,n=e.da,a=e.vdva,r=e.origin,i=e.pinching,o=e.delta,s=e.first,c=e.initial,l=e.direction,u=e.previous,d=e.elapsedTime,h=e.memo,f=void 0===h?{lastY:0}:h;return w(t,n,a,r,i,o,s,c,l,u,f,d),f.lastY=r[1],f},onPinchEnd:function(){clearTimeout(u.current),u.current=setTimeout((function(){h.current=!0}),300),g.current="undefined"}},{domTarget:n,drag:{useTouch:!0},pinch:{useTouch:!0},eventOptions:{passive:!1}});var w=function(e,t,n,a,r,i,o,s,c,l,u,d){switch("undefined"===g.current&&d>=100&&(g.current=Math.abs(c[0])>Math.abs(1.2*c[1])?"zoom":"rotation",Math.abs(a[1]-u.lastY)>4&&(g.current="tilt")),g.current){case"tilt":L(r,i,a,s,u);break;case"zoom":z(r,i,n);break;case"rotation":q(r,i,n)}},R=Object(pe.useSpring)((function(){return{pinchtiltvalue:[0,0]}})),D=Object(s.a)(R,2),N=D[0].pinchtiltvalue,C=D[1],L=function(e,n,a,r,i){C.start({pinchtiltvalue:Object(be.sub)(a,[0,i.lastY]),immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){e||(g.current="undefined");var n=e?.5:.2;t.current.navigator.tilt-=N.get()[1]*n*1,me(),t.current.redraw()}})},P=Object(pe.useSpring)((function(){return{pinchzoomrotatevalue:[0,0]}})),I=Object(s.a)(P,2),k=(I[0].pinchzoomrotatevalue,I[1],Object(pe.useSpring)((function(){return{pinchzoomvalue:0}}))),F=Object(s.a)(k,2),U=F[0].pinchzoomvalue,B=F[1],z=function(e,n,a){var r=1;e||(r=Math.abs(a[0])<.2?0:1),B.start({pinchzoomvalue:n[0],immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){e||(g.current="undefined");var n=1-U.get()/300*r;le(d.current,n),t.current.navigator.range*=n,me(),t.current.redraw()}})},G=Object(pe.useSpring)((function(){return{pinchrotatevalue:0}})),V=Object(s.a)(G,2),K=V[0].pinchrotatevalue,H=V[1],q=function(e,n,a){var r=1;e||(r=Math.abs(a[1])<.2?0:1),H.start({pinchrotatevalue:n[1],immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){t.current.navigator.heading-=K.get()*r,0!==t.current.navigator.heading&&(f.current=!0),me(),t.current.redraw()}})},Y=Object(pe.useSpring)((function(){return{tiltvalue:[0,0]}})),W=Object(s.a)(Y,2),Z=W[0].tiltvalue,X=W[1],J=function(e,n,a){X.start({to:{tiltvalue:n},immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){var e=-90*Z.get()[1]*2/t.current.canvas.clientHeight,n=-90*Z.get()[0]*2/t.current.canvas.clientWidth;t.current.navigator.tilt-=e,a&&(t.current.navigator.heading-=n,0!==t.current.navigator.heading&&(f.current=!0)),me(),t.current.redraw()}})},Q=Object(pe.useSpring)((function(){return{panvalue:[0,0]}})),$=Object(s.a)(Q,2),ee=$[0].panvalue,te=$[1],ne=function(e,n,a,r,i,o,s,c,l,u,d,h){var f=1;a||(f=s<.2?0:1);var g="touchmove"===e.type?1:2.5;te.start({panvalue:r,immediate:a,config:{mass:1,tension:150,friction:80},onChange:function(){var e=[t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2],n=Object(be.sub)(e,Object(be.scale)(ee.get(),g*f)),a=de(e[0],e[1]);a||console.log("no currentpos !");var r=de(n[0],n[1]);r||console.log("no nextposition !");var i=new m.a.Vec3(0,0,0),o=new m.a.Vec3(0,0,0);if(t.current.globe.computePointFromPosition(a.latitude,a.longitude,a.altitude,i)&&t.current.globe.computePointFromPosition(r.latitude,r.longitude,r.altitude,o)){var s=m.a.Matrix.fromIdentity();t.current.computeViewingTransform(null,s),s.multiplyByTranslation(i[0]-o[0],i[1]-o[1],i[2]-o[2]);var c=t.current.rayThroughScreenPoint(t.current.canvasCoordinates(l[0],l[1]));s.extractEyePoint(c.origin),s.extractForwardVector(c.direction);var u=new m.a.Vec3(0,0,0);if(t.current.globe.intersectsLine(c,u)){var d=s.extractViewingParameters(u,t.current.navigator.roll,t.current.globe,{});t.current.navigator.lookAtLocation.copy(d.origin),t.current.navigator.range=d.range,t.current.navigator.heading=d.heading,t.current.navigator.tilt=d.tilt,t.current.navigator.roll=d.roll,me(),t.current.redraw()}}},onRest:function(){}})},ae=function(e,n,a,r,i,o,s,c,l,u,h,g,p,b){try{h&&(Math.abs(d.current.latitude)>80||t.current.navigator.heading>2)&&(f.current=!0)}catch(_){console.log("Position at start not detected")}var v=1;a||(v=s<.2?0:1);var O="touchmove"===e.type?1:2.5;a||(O*=.5),te.start({panvalue:r,immediate:a,config:{mass:1,tension:100,friction:40},onChange:function(){try{var e=[t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2],n=Object(be.sub)(e,Object(be.scale)(ee.get(),O*v)),a=ue(e[0],e[1]);a||console.log("no currentpos !");var r=ue(n[0],n[1]);r||console.log("no nextposition !");var i=new m.a.Vec3(0,0,0),o=new m.a.Vec3(0,0,0);if(!t.current.globe.computePointFromPosition(a.latitude,a.longitude,a.altitude,i))return;if(!t.current.globe.computePointFromPosition(r.latitude,r.longitude,r.altitude,o))return;var s=new m.a.Vec3(0,0,0),c=he(o,i,s);if(r&&(r.latitude>80||r.latitude<-80)&&!1===f.current)return console.log("out"),void te.stop();fe(s,c,o,r),!1===f.current&&(t.current.navigator.heading=0),t.current.redraw()}catch(l){console.log("probl !")}},onRest:function(){}})},re=Object(pe.useSpring)((function(){return{range:[1,0]}})),ie=Object(s.a)(re,2),oe=ie[0].range,se=ie[1],ce=function(e,n,a,r,i,o,s,c,l,u,h,f){var m=1;a||(m=s<.2?0:.5),se.start({to:{range:[1-r[1]/200,0]},immediate:a||f,config:{mass:1,tension:100,friction:40},onChange:function(){var e=0===m?1:oe.get()[0];le(d.current,e),t.current.navigator.range*=e,me(),t.current.redraw()},onRest:function(){}})},le=function(e,n){if(e&&!(n>=1)){var a,r=t.current.navigator.lookAtLocation,i=t.current.globe.elevationAtLocation(r.latitude,r.longitude),o=new m.a.Position(r.latitude,r.longitude,i);n<1&&(a=m.a.Position.interpolateGreatCircle(n,e,o,new m.a.Position(0,0,0)),r.latitude=a.latitude,r.longitude=a.longitude,r.altitude=a.altitude)}},ue=function(e,n){var a=t.current.rayThroughScreenPoint(t.current.canvasCoordinates(e,n)),r=new m.a.Position(0,0,0),i=[0,0,0];return t.current.globe.intersectsLine(a,i)?(t.current.globe.computePositionFromPoint(i[0],i[1],i[2],r),r):null},de=function(e,n){for(var a=t.current.canvasCoordinates(e,n),r=t.current.pickTerrain(a),i=0;i<r.objects.length;i++){var o=r.objects[i];if(o.isTerrain){var s=o.position;if(s)return new m.a.Position(s.latitude,s.longitude,s.altitude)}}},he=function(e,t,n){var a=m.a.MeasurerUtils.angleBetweenVectors(e,t)*m.a.Angle.RADIANS_TO_DEGREES;return n.copy(e),n.cross(t),n.normalize(),a},fe=function(e,n,a,r){if(!isFinite(n)||!isFinite(e[0])||!isFinite(e[1])||!isFinite(e[2]))return!1;var i=t.current,o=i.navigator,s=m.a.Matrix.fromIdentity(),c=o.lookAtLocation.altitude,l=o.tilt,u=new m.a.Line(new m.a.Vec3(0,0,0),new m.a.Vec3(0,0,0));if(o.tilt=0,i.computeViewingTransform(null,s),s.multiplyByRotation(e[0],e[1],e[2],n),s.extractEyePoint(u.origin),s.extractForwardVector(u.direction),!i.globe.intersectsLine(u,a))return o.tilt=l,!1;var d=s.extractViewingParameters(a,o.roll,i.globe,{});return o.heading=d.heading,o.lookAtLocation.copy(d.origin),o.lookAtLocation.altitude=c,o.tilt=l,!0},me=function(){var e=t.current.navigator;e.camera.applyLimits(),e.range=m.a.WWMath.clamp(e.range,t.current.globe.elevationAtLocation(e.lookAtLocation.latitude,e.lookAtLocation.longitude)+2,1e8),e.tilt=m.a.WWMath.clamp(e.tilt,0,60)};return Object(a.useEffect)((function(){window.addEventListener("contextmenu",(function(e){return e.preventDefault()}))}),[]),Object(ve.jsxs)("div",{children:[Object(ve.jsx)("div",{className:"EarthController",ref:n}),A]})}));var _e=function(e){var t=e.id,n=(e.alt,Object(c.useGlobal)("mapSettings")),a=Object(s.a)(n,2),r=a[0],i=a[1],o=Object(c.useGlobal)("position"),u=Object(s.a)(o,2),d=u[0],h=(u[1],Object(c.useGlobal)("altitude")),f=Object(s.a)(h,2),m=f[0],g=f[1],p=Object(c.useGlobal)("viewDate"),b=Object(s.a)(p,2),v=b[0],O=(b[1],Object(c.useGlobal)("geojson")),_=Object(s.a)(O,2),j=_[0],y=(_[1],Object(c.useGlobal)("searchPoint")),S=Object(s.a)(y,2),x=(S[0],S[1]),E=Object(c.useGlobal)("satellites"),M=Object(s.a)(E,2),T=M[0],A=M[1],w=Object(c.useState)(r),R=Object(s.a)(w,2),D=R[0],N=R[1],C=Object(c.useState)(T),L=Object(s.a)(C,2),P=L[0],I=L[1],k=fe({id:t,clat:d.clat,clon:d.clon,alt:m,starfield:r.starfield,atmosphere:r.atmosphere,background:r.background,overlay:r.overlay,satellites:T,names:r.names,dem:r.dem}),F=k.eww,U=k.ewwstate,B=k.moveTo,z=k.addGeojson,G=k.removeGeojson,V=(k.addWMS,k.toggleProjection),K=(k.toggleOv,k.toggleModel,k.setTime),H=(k.toggleDem,k.northUp);return Object(me.a)("p",V),Object(me.a)("c",G),Object(me.a)("u",H),Object(me.a)("b",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{background:e.background+1})}))})),Object(me.a)("m",(function(){return I((function(e){return!e}))})),Object(me.a)("d",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{dem:!e.dem})}))})),Object(me.a)("o",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{overlay:e.overlay+1})}))})),Object(me.a)("a",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{atmosphere:!e.atmosphere})}))})),Object(me.a)("s",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{starfield:!e.starfield})}))})),Object(me.a)("n",(function(){return N((function(e){return Object(l.a)(Object(l.a)({},e),{},{names:!e.names})}))})),Object(c.useEffect)((function(){g(U.altitude)}),[U.altitude]),Object(c.useEffect)((function(){x(U.viewpoint)}),[U.viewpoint]),Object(c.useEffect)((function(){K(v.getTime())}),[v]),Object(c.useEffect)((function(){j?z(j,v.getTime()):G()}),[j]),Object(c.useEffect)((function(){i(D)}),[D]),Object(c.useEffect)((function(){N(r)}),[r]),Object(c.useEffect)((function(){A(P)}),[P]),Object(c.useEffect)((function(){I(T)}),[T]),Object(c.useEffect)((function(){console.log("world created / "+d.clat+" / "+d.clon+" / "+m),setTimeout((function(){B(d.clat,d.clon,m)}),1e3)}),[]),Object(ve.jsxs)("div",{children:[Object(ve.jsx)("canvas",{className:"Earth",id:t}),Object(ve.jsx)(Oe,{world:F})]})},je=(n(88),n(20)),ye=n(56);var Se=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(s.a)(c,2),u=l[0],d=l[1],h=r.a.useRef(null),f=Object(pe.useSpring)((function(){return{mr:-300}})),m=Object(s.a)(f,2),g=m[0].mr,p=m[1];return Object(ge.b)({onDrag:function(e){var t=e.down,n=(e.delta,e.vxvy),a=e.movement;n[1]>1?(p.start({mr:-300,immediate:!1}),o(!0)):(p.start({mr:t?-a[1]:a[1]>50?-300:0,immediate:!1}),o(!1))},onDragEnd:function(e){e.down||d(!1)}},{domTarget:h}),Object(ve.jsxs)(pe.animated.div,{style:{bottom:g,left:0},className:"ControlPanel",children:[Object(ve.jsx)("div",{ref:h,className:"PanelControl shadow",onClick:function(){return i?p.start({mr:0}):p.start({mr:-300})},children:Object(ve.jsx)(je.Icon,{icon:ye.a,width:"100%"})}),Object(ve.jsx)("div",{className:"ControlPanelMask",style:{display:u?"block":"none"}}),e.children]})};n(89);var xe=function(e){var t=e.initialmission,n=e.onMissionChange,r=Object(a.useState)(t),i=Object(s.a)(r,2),o=i[0],c=i[1],l=Object(a.useState)(t),u=Object(s.a)(l,2);return u[0],u[1],Object(me.a)("1",(function(){c("S1")})),Object(me.a)("2",(function(){c("S2")})),Object(me.a)("3",(function(){c("S3/SLSTR")})),Object(me.a)("5",(function(){c("S5P")})),Object(me.a)("6",(function(){c("ENVISAT")})),Object(a.useEffect)((function(){n(o)}),[o]),Object(ve.jsx)("div",{className:"MissionSelectorContainer",children:Object(ve.jsxs)("div",{className:"MissionSelector",children:[Object(ve.jsx)("div",{className:"S1"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return c("S1")}})}),Object(ve.jsx)("div",{className:"S2"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return c("S2")}})}),Object(ve.jsx)("div",{className:"S3"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return c("S3")}})}),Object(ve.jsx)("div",{className:"S3/SLSTR"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return c("S3/SLSTR")}})}),Object(ve.jsx)("div",{className:"S3/OLCI"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return c("S3/OLCI")}})}),Object(ve.jsx)("div",{className:"S3/SRAL"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return c("S3/SRAL")}})}),Object(ve.jsx)("div",{className:"S5P"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return c("S5P")}})}),Object(ve.jsx)("div",{className:"ENVISAT"==o?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return c("ENVISAT")}})})]})})};var Ee=function(){var e=Object(c.useGlobal)("mission"),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(ve.jsx)(xe,{initialmission:n,onMissionChange:a})};n(90);var Me=function(e){var t=e.mapSettings,n=e.onMapSettingsChange,r=Object(a.useState)(t),i=Object(s.a)(r,2),o=i[0],c=i[1];return Object(a.useEffect)((function(){n(o)}),[o]),Object(a.useEffect)((function(){c(t)}),[t]),Object(ve.jsx)("div",{className:"MapSelectorContainer",children:Object(ve.jsxs)("div",{className:"MapSelector",children:[Object(ve.jsx)("div",{className:t.atmosphere?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/atmosphere.png",alt:"",onClick:function(){return c((function(e){return Object(l.a)(Object(l.a)({},e),{},{atmosphere:!e.atmosphere})}))}})}),Object(ve.jsx)("div",{className:t.starfield?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/starfield.png",alt:"",onClick:function(){return c((function(e){return Object(l.a)(Object(l.a)({},e),{},{starfield:!e.starfield})}))}})}),Object(ve.jsx)("div",{className:t.names?"CircleButtonSelected":"CircleButton",children:Object(ve.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/names.png",alt:"",onClick:function(){return c((function(e){return Object(l.a)(Object(l.a)({},e),{},{names:!e.names})}))}})}),Object(ve.jsx)("div",{className:"CircleButton",children:Object(ve.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/names.png",alt:"",onClick:function(){return c((function(e){return Object(l.a)(Object(l.a)({},e),{},{background:e.background+1})}))}})})]})})};var Te=function(){var e=Object(c.useGlobal)("mapSettings"),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(ve.jsx)(Me,{mapSettings:n,onMapSettingsChange:a})},Ae=(n(91),n(57));var we=function(){var e=Object(c.useGlobal)("appColor"),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){console.log("color: "+n),document.documentElement.style.setProperty("--color",n),document.documentElement.style.setProperty("--colort",n+"66")}),[n]),Object(ve.jsx)("div",{className:"ColorSelector",children:Object(ve.jsx)(Ae.a,{color:n,onChange:function(e){null!==e&&(console.log("set color: "+e),document.documentElement.style.setProperty("--color",e),document.documentElement.style.setProperty("--colort",e+"66"),r(e))}})})},Re=(n(92),n(58)),De=n.n(Re);var Ne=function(){var e=Object(c.useGlobal)("mapSettings"),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(ve.jsxs)("div",{className:"DemSelector horizontalContainer",children:[Object(ve.jsx)(De.a,{onChange:function(e){a(Object(l.a)(Object(l.a)({},n),{},{dem:e}))},checked:n.dem}),Object(ve.jsx)("span",{children:"Copernicus DEM"})]})};n(94);var Ce=function(){var e=Object(c.useGlobal)("altitude"),t=Object(s.a)(e,1)[0];return Object(ve.jsx)("div",{className:"AltitudeLabel",children:t>=1e4?Math.floor(t/1e3)+" Km":Math.floor(t)+" m"})},Le=n(28),Pe=n.n(Le);n(95);var Ie=function(e){var t=e.date,n=e.highlight;return e.animated,Object(ve.jsxs)("div",{className:"LabelContainer",children:[Object(ve.jsx)("span",{className:"year"===n?"Highlighted":"",children:t.getUTCFullYear()}),"-",Object(ve.jsx)("span",{className:"month"===n?"Highlighted":"",children:Pe()(t,"UTC:mmm").toUpperCase()}),"-",Object(ve.jsx)("span",{className:"day"===n?"Highlighted":"",children:Pe()(t,"UTC:dd")}),"\xa0/\xa0",Object(ve.jsx)("span",{className:"hour"===n?"Highlighted":"",children:Pe()(t,"UTC:HH")}),":",Object(ve.jsx)("span",{className:"minute"===n?"Highlighted":"",children:Pe()(t,"UTC:MM")}),":",Object(ve.jsx)("span",{className:"second"===n?"Highlighted":"",children:Pe()(t,"UTC:ss")})]})};function ke(e){var t=e.autoStart,n=e.initdate,r=Object(a.useState)(n),i=Object(s.a)(r,2),o=i[0],c=i[1],l=Object(a.useRef)(),u=Object(a.useRef)(),d=Object(a.useRef)();d.current=200;var h=Object(a.useRef)(),f=Object(a.useRef)(),m=Object(a.useRef)();function g(){console.log("start clock"),u.current||(u.current=d.current),l.current||(f.current=setInterval((function(){h.current+=u.current,c(new Date(h.current))}),d.current)),l.current=!0}return Object(a.useEffect)((function(){h.current=n.getTime(),c(new Date(h.current))}),[n]),Object(a.useEffect)((function(){h.current=(new Date).getTime(),t&&g()}),[t]),{date:o,playing:l,togglePause:function(){l.current?function(){console.log("stop clock"),m.current&&clearTimeout(m.current);f.current&&clearInterval(f.current);l.current=!1}():g()},reset:function(){h.current=(new Date).getTime(),c(new Date(h.current))},increaseSpeed:function(){u.current=u.current>0?u.current*=2:u.current/=2,Math.abs(u.current)<d.current&&(u.current=d.current),console.log("step: "+u.current)},decreaseSpeed:function(){u.current=u.current>0?u.current/=2:u.current*=2,Math.abs(u.current)<d.current&&(u.current=-1*d.current),console.log("step: "+u.current)},forceDate:function(e){h.current=e.getTime(),c(new Date(h.current))}}}var Fe=n(59),Ue=n(60),Be=n(61);n(96);var ze=function(e){var t=e.startdate,n=e.onDateChange,r=ke({autoStart:!1,initdate:t}),i=r.date,o=r.togglePause,c=r.reset,l=r.increaseSpeed,u=r.decreaseSpeed;r.forceDate,Object(me.a)("t",o),Object(me.a)("r",(function(){c()})),Object(me.a)(".",l),Object(me.a)(",",u),Object(a.useEffect)((function(){n(i)}),[i,n]);var d=Object(a.useState)(),h=Object(s.a)(d,2),f=h[0],m=h[1];return Object(ve.jsx)("div",{className:"DateController",children:Object(ve.jsxs)("div",{className:"buttoncontainer",children:[Object(ve.jsx)(je.Icon,{icon:Ue.a,onClick:u,className:"controlbuttons"}),Object(ve.jsx)(je.Icon,{icon:Be.a,onClick:function(){var e=Date.now();f&&e-f<400?c():(m(e),o())},className:"controlbuttons"}),Object(ve.jsx)(je.Icon,{icon:Fe.a,onClick:l,className:"controlbuttons"})]})})};n(55);var Ge=function(e){var t=e.date,n=e.zoomfactor,r=Object(a.useRef)(0),i=Object(a.useState)(""),o=Object(s.a)(i,2),c=o[0],l=o[1],u=Object(a.useRef)(n),d=Object(a.useRef)(t),h=function(e,t){var n=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];function a(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}for(var i,o,s,c,l=0,u=0,d=0,h=0,f=0,m=0,g=[],p=0,b=0,v=(parseInt(r.current.style.fontSize),0);v<r.current.offsetHeight;v+=1){var O=new Date((v-r.current.offsetHeight/2)*t+e.getTime());switch(i=O.getUTCDate(),o=O.getUTCMonth(),s=O.getUTCHours(),c=O.getUTCFullYear(),l=O.getUTCMinutes(),!0){case t<3e3:b=6e4,l!==m&&0!==v&&(0!==l||0!==s?g.push({class:"HourTic",pos:v,label:a(s,2)+":"+a(l,2)}):0===l&&0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})));break;case t<5e3:b=12e4,l!==m&&0!==v&&(0===l&&0===s||l%2!==0?0===l&&0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})):g.push({class:"HourTic",pos:v,label:a(s,2)+":"+a(l,2)}));break;case t<3e4:b=6e5,l!==m&&0!==v&&(0===l&&0===s||l%10!==0?0===l&&0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})):g.push({class:"HourTic",pos:v,label:a(s,2)+":"+a(l,2)}));break;case t<6e4:b=12e5,l!==m&&0!==v&&(0===l&&0===s||l%20!==0?0===l&&0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})):g.push({class:"HourTic",pos:v,label:a(s,2)+":"+a(l,2)}));break;case t<18e4:b=36e5,s!==f&&0!==v&&(0!==s?g.push({class:"HourTic",pos:v,label:a(s,2)+":00"}):(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})));break;case t<42e4:b=108e5,s!==f&&0!==v&&(0!==s&&s%3===0?g.push({class:"HourTic",pos:v,label:a(s,2)+":00"}):0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})));break;case t<12e5:b=216e5,s!==f&&0!==v&&(0!==s&&s%6===0?g.push({class:"HourTic",pos:v,label:a(s,2)+":00"}):0===s&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]})));break;case t<18e5:b=864e5,i!==u&&0!==v&&(g.push({class:"DayTic_h",pos:v,label:a(i,2)}),g.push({class:"MonthTic_h2",pos:v,label:n[o]}));break;case t<42e5:b=864e5,i!==u&&0!==v&&(1!==i?g.push({class:"DayTic",pos:v,label:i}):(g.push({class:"MonthTic_h",pos:v,label:n[o]}),0===o&&g.push({class:"YearTic_h2",pos:v,label:c})));break;case t<288e5:b=432e6,i!==u&&0!==v&&(1!==i&&30!==i&&i%5===0?g.push({class:"DayTic",pos:v,label:i}):1===i&&(g.push({class:"MonthTic_h",pos:v,label:n[o]}),0===o&&g.push({class:"YearTic_h2",pos:v,label:c})));break;case t<1728e5:b=24192e5,o!==d&&0!==v&&(0!==o?g.push({class:"MonthTic",pos:v,label:n[o]}):(g.push({class:"MonthTic_h",pos:v,label:n[o]}),g.push({class:"YearTic_h2",pos:v,label:c})));break;case t<3456e5:b=72576e5,o!==d&&0!==v&&(0!==o&&11!==o&&o%3===0?g.push({class:"MonthTic",pos:v,label:n[o]}):0===o&&(g.push({class:"MonthTic_h",pos:v,label:n[o]}),g.push({class:"YearTic_h2",pos:v,label:c})));break;case t<7776e6:b=31104e6,c!==h&&0!==v&&(0!==o?g.push({class:"MonthTic",pos:v,label:n[o]}):g.push({class:"YearTic",pos:v,label:c}))}u=i,h=c,d=o,f=s,m=l,g.length!=p&&(v+=b/t-4),p=g.length}return g.map((function(e){return Object(ve.jsx)("div",{className:e.class,style:{top:e.pos,opacity:1},children:e.label},e.class+e.pos)}))},f=function(){l(h(d.current,u.current))};return Object(a.useLayoutEffect)((function(){u.current=n,d.current=t,l(h(t,n))}),[n,t]),Object(a.useEffect)((function(){return window.addEventListener("resize",f),function(){window.removeEventListener("resize",f)}}),[]),Object(ve.jsx)("div",{ref:r,className:"DateSelectorScale",id:"DateSelectorScale",style:{fontSize:"14px"},children:c})};var Ve=function(e){var t=e.startdate,n=e.onDateChange,r=e.onFinalDateChange,i=e.onStepChange,o=1296e6,c=1e3,u=36e5,d=Object(a.useRef)(u),h=Object(a.useState)(u),f=Object(s.a)(h,2),m=f[0],g=f[1],p=Object(a.useRef)(),b=Object(a.useState)(t),v=Object(s.a)(b,2),O=v[0],_=v[1],j=Object(a.useState)(!1),y=Object(s.a)(j,2),S=y[0],x=y[1],E=Object(a.useState)([6e4]),M=Object(s.a)(E,2),T=M[0],A=M[1],w=Object(a.useState)("hour"),R=Object(s.a)(w,2),D=R[0],N=R[1],C=Object(a.useRef)(),L=Object(a.useRef)(),P=Object(a.useRef)(),I=Object(a.useRef)(t),k=Object(a.useRef)(t),F=Object(pe.useSpring)((function(){return{posy_wheel:0}})),U=Object(s.a)(F,2),B=U[0].posy_wheel,z=U[1],G=Object(pe.useSpring)((function(){return{zoom:0}})),V=Object(s.a)(G,2),K=V[0].zoom,H=V[1],q=Object(pe.useSpring)((function(){return{test:0}})),Y=Object(s.a)(q,2),W=Y[0].test,Z=Y[1],X=Object(ge.b)({onWheel:function(e){e.active;var t=e.delta,a=e.first,i=(e.down,e.direction,e.velocity,e.xy,e.movement,e.wheeling),s=e.ctrlKey,l=e.shiftKey;a&&(Z.stop(),k.current=O),s||l?H.start({zoom:t[1],immediate:!0,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){var e=d.current+d.current/300*K.get()*-1;e<c&&(e=c),e>o&&(e=o),g(e),d.current=e}}):z.start({posy_wheel:t[1],immediate:!0,config:{mass:1,tension:100,friction:40},onChange:function(){var e;x(!0);var t=(B.get()<0?Math.ceil:Math.floor)(B.get()*m/T[0]);0===t&&z.stop(),"month"===D?(e=new Date(k.current.getTime())).setUTCMonth(e.getUTCMonth()-t):e=new Date(k.current.getTime()-t*T[0]),k.current=e,_(e),n(e)},onRest:function(){i||(r(k.current),x(!1))}})},onDrag:function(e){var t=e.event,a=e.active,i=e.first,s=e.down,l=(e.touches,e.delta),u=(e.initial,e.distance,e.velocity),h=(e.direction,e.shiftKey),f=(e.xy,e.movement);e.vxvy;x(a),i&&(z.stop(),function(e){var t=Date.now();P.current=e.button,C.current&&t-C.current<300?L.current=!0:(C.current=t,L.current=!1)}(t),I.current=k.current),u=u<.2?0:u,L.current||h||2===P.current?H.start({zoom:l[1],immediate:s,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){var e=d.current+d.current/50*K.get()*-1;e<c&&(e=c),e>o&&(e=o),g(e),d.current=e}}):Z.start({test:s?f[1]:f[1]+f[1]*u*5,immediate:s,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){if(x(!0),"month"===D){var e=Math.ceil(W.get()*m/T[0]),t=new Date(I.current.getTime());t.setUTCMonth(t.getUTCMonth()-e),k.current=t}else k.current=new Date(I.current.getTime()-Math.ceil(W.get()*m/T[0])*T[0]);_(k.current),n(k.current)},onRest:function(){s||(r(k.current),x(!1))}})},onDragEnd:function(){r(k.current),x(!1)}},{drag:{useTouch:!0}}),J=Object(pe.useSpring)((function(){return{xy2:[0,0]}})),Q=Object(s.a)(J,2),$=Q[0].xy2,ee=Q[1];return Object(a.useEffect)((function(){S||function(e){var t=k.current.getTime(),a=[0,t-e.getTime()];ee.start({from:{xy2:[0,0]},to:{xy2:a},immediate:!1,config:{reset:!0,duration:300},onChange:function(){var e=new Date(t-$.get()[1]);k.current=e,_(e),n(e)}})}(t)}),[t]),Object(a.useEffect)((function(){i(D)}),[D,i]),Object(a.useEffect)((function(){switch(!0){case m>120426316:A([26784e5,24192e5,26784e5,2592e6,26784e5,2592e6,26784e5,26784e5,2592e6,26784e5,2592e6,26784e5]),N("month");break;case m>94544702:A([10368e5]),N("cycle");break;case m>14544702:A([864e5]),N("day");break;case m>735259:A([36e5]),N("hour");break;case m>32274:A([6e4]),N("minute");break;default:A([1e3]),N("second")}}),[m]),Object(ve.jsx)("div",{children:Object(ve.jsxs)("div",{className:"DateSelector",ref:p,children:[Object(ve.jsx)("div",Object(l.a)(Object(l.a)({},X()),{},{className:"touchMask",children:" "})),Object(ve.jsxs)("div",{className:"Mask",children:[Object(ve.jsx)(Ge,{className:"scale",date:O,zoomfactor:m}),Object(ve.jsx)("div",{className:"TriangleContainer",children:Object(ve.jsx)("svg",{height:"40",width:"20",className:"Triangle",children:Object(ve.jsx)("polygon",{points:"20,5 20,35 12,20"})})})]})]})})};var Ke=function(e){var t=e.onDateChange,n=e.onFinalDateChange,r=e.animated,i=e.startdate,o=Object(a.useState)(i),c=Object(s.a)(o,2),l=c[0],u=c[1],d=Object(a.useState)(i),h=Object(s.a)(d,2),f=h[0],m=h[1],g=Object(a.useState)(i),p=Object(s.a)(g,2),b=p[0],v=p[1],O=Object(a.useState)(1),_=Object(s.a)(O,2),j=_[0],y=_[1],S=Object(a.useCallback)((function(e){v(e),t(e)}),[]),x=Object(a.useCallback)((function(e){u(e)}),[]);return Object(a.useEffect)((function(){m(i)}),[i]),Object(ve.jsxs)("div",{children:[Object(ve.jsx)(ze,{startdate:f,onDateChange:x}),Object(ve.jsx)(Ie,{date:b,animated:r,highlight:j}),Object(ve.jsx)(Ve,{startdate:l,onDateChange:S,onFinalDateChange:function(e){m(e),n(e)},onStepChange:function(e){y(e)}})]})};var He=function(){var e=Object(c.useGlobal)("viewDate"),t=Object(s.a)(e,2)[1],n=Object(c.useGlobal)("searchDate"),a=Object(s.a)(n,2),r=(a[0],a[1]),i=Object(c.useGlobal)("goToDate"),o=Object(s.a)(i,2),l=o[0];return o[1],Object(ve.jsx)(Ke,{onDateChange:t,onFinalDateChange:r,startdate:l})},qe=(n(97),n(42)),Ye=n.n(qe);function We(e){function t(e){function t(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].content;return t}try{var n={};e.date&&Object.assign(n,t(e.date)),e.int&&Object.assign(n,t(e.int)),e.double&&Object.assign(n,t(e.double)),e.str&&Object.assign(n,t(e.str));var a,r=n.size.split(" ");switch(r[1]){case"B":a=Math.round(parseFloat(r[0]));break;case"MB":a=Math.round(1024*parseFloat(r[0]));break;case"GB":a=Math.round(1024*parseFloat(r[0])*1024);break;case"TB":a=Math.round(1024*parseFloat(r[0])*1024*1024);break;default:a=Math.round(parseFloat(r[0]))}return{id:e.title,geometry:Ye()(n.footprint),type:"Feature",properties:{updated:new Date(n.ingestiondate),title:e.title,name:e.title,uuid:e.id,date:n.beginposition+"/"+n.endposition,downloadUrl:e.link[0].href,quicklookUrl:e.link.length>=2?e.link[2].href:null,earthObservation:{parentIdentifier:"",status:"ARCHIVED",acquisitionInformation:[{platform:{platformShortName:n.platformname,platformSerialIdentifier:n.platformserialidentifier},sensor:{instrument:n.instrumentshortname,operationalMode:n.sensoroperationalmode},acquisitionParameter:{acquisitionStartTime:new Date(n.beginposition),acquisitionStopTime:new Date(n.endposition),relativePassNumber:parseInt(n.relativeorbitnumber),orbitNumber:parseInt(n.orbitnumber),startTimeFromAscendingNode:null,stopTimeFromAscendingNode:null,orbitDirection:n.orbitdirection}}],productInformation:{productType:n.producttype,size:a}}}}}catch(i){return console.log("error parsing item from dhus: "+i.message),{}}}var n=[];try{n=e.feed.entry?Array.isArray(e.feed.entry)?e.feed.entry.map((function(e){return t(e)})).filter((function(e){return e!=={}})):[t(e.feed.entry)]:[]}catch(a){console.log(e),console.log("Error: "),console.log(a),n=[]}return{type:"FeatureCollection",id:"search",properties:{totalResults:e.feed["opensearch:totalResults"],startIndex:e.feed["opensearch:startIndex"]?e.feed["opensearch:startIndex"]:1,itemsPerPage:e.feed["opensearch:itemsPerPage"],title:"DHuS search response",updated:new Date},features:n}}function Ze(e){var t=[];try{e.features?Array.isArray(e.features)&&(console.log("features is an  array"),t=e.features.map((function(e){return function(e){try{for(var t=null,n=null,a=0;a<e.properties.link.length;a++)"Download"==e.properties.link[a]["@"].title&&(t=e.properties.link[a]["@"].href),"Quicklook"==e.properties.link[a]["@"].title&&(n=e.properties.link[a]["@"].href);return{id:e.id,geometry:e.geometry,type:"Feature",properties:{updated:e.properties.updated,title:e.properties.title,name:e.title,uuid:e.properties.identifier,date:e.properties.date,downloadUrl:t,quicklookUrl:n,earthObservation:{parentIdentifier:e.properties.EarthObservation.metaDataProperty.EarthObservationMetaData.parentIdentifier,status:"ARCHIVED",acquisitionInformation:[{platform:{platformShortName:e.properties.EarthObservation.procedure.EarthObservationEquipment.platform.Platform.shortName,platformSerialIdentifier:null},sensor:{instrument:e.properties.EarthObservation.procedure.EarthObservationEquipment.instrument.Instrument.shortName,operationalMode:e.properties.EarthObservation.procedure.EarthObservationEquipment.sensor.Sensor.operationalMode},acquisitionParameter:{acquisitionStartTime:new Date(e.properties.EarthObservation.phenomenonTime.TimePeriod.beginPosition),acquisitionStopTime:new Date(e.properties.EarthObservation.phenomenonTime.TimePeriod.endPosition),relativePassNumber:null,orbitNumber:e.properties.EarthObservation.procedure.EarthObservationEquipment.acquisitionParameters.Acquisition.orbitNumber,startTimeFromAscendingNode:null,stopTimeFromAscendingNode:null,orbitDirection:e.properties.EarthObservation.procedure.EarthObservationEquipment.acquisitionParameters.Acquisition.orbitDirection}}],productInformation:{productType:e.properties.EarthObservation.metaDataProperty.EarthObservationMetaData.productType,downloadUrl:t,quicklookUrl:n,size:null}}}}}catch(r){return console.log("error parsing item from dhus: "+r.message),{}}}(e)})).filter((function(e){return e!=={}}))):t=[]}catch(n){console.log(e),console.log("Error: "),console.log(n),t=[]}return{type:"FeatureCollection",id:"search",properties:{totalResults:e.properties.totalResults,startIndex:e.properties.startIndex,itemsPerPage:e.properties.itemsPerPage,title:e.properties.title,updated:e.properties.updated},features:t}}function Xe(){var e=Object(a.useRef)({}),t=Object(a.useRef)(),n=Object(a.useState)(null),r=Object(s.a)(n,2),i=r[0],o=r[1],c=Object(a.useState)(!1),l=Object(s.a)(c,2),u=l[0],f=l[1],m=Object(a.useState)(!1),g=Object(s.a)(m,2),p=g[0],b=g[1],v=Object(a.useState)(null),O=Object(s.a)(v,2),_=O[0],j=O[1],y=Object(a.useRef)([{code:"S1",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-1 AND producttype:GRD)&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-1 A/B GRD",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:648e5},{code:"S2",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-2 AND filename:*MSIL1C*)&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-2 A/B Level 1C",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:108e5},{code:"S2B",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-2 AND filename:S2B_MSIL1C*)&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-2 A/B Level 1C",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:108e5},{code:"S3",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:OL_1_ERR___ OR producttype:SL_1_RBT___ OR producttype:SR_1_SRA___))&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-3 A/B, OLCI/SLSTR/SRAL",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3/OLCI",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:OL_1_ERR___))&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-3 A/B, OLCI",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3/SLSTR",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:SL_1_RBT___))&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-3 A/B, SLSTR",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3/SRAL",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:SR_1_SRA___))&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-3 A/B, SRAL",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S5P",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-5 precursor AND (producttype:L1B_RA_BD1 OR (producttype:L2__NO2___ AND processingmode:Near real time)))&start={startindex}&rows=100&sortedby=beginposition&order=desc&format=json',name:"Sentinel-1 A/B",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"ENVISAT",templateUrl:"https://eocat.esa.int/api/catalogue/EOCAT-ENVISAT.ASA.IMP_1P/search?start={start}&stop={end}&geom={polygon}&format=json&count=50&startIndex={startindex}",startIndexOrigin:1,name:"Envisat",dateOff:"start={start}&stop={end}&",areaOff:"&geom={polygon}",windowSize:2592e5}]),S=function(e){for(var t=0;t<y.current.length;t++)if(y.current[t].code==e)return y.current[t];return null};Object(a.useEffect)((function(){if(null!==_){var n=function(){var a=Object(h.a)(d.a.mark((function a(r,i){var s,c,l,u,h;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return f(!0),t.current=new AbortController,s=(s=r).replace("{startindex}",i),c={totalresults:0,startindex:0,itemsperpage:0},a.prev=5,a.next=8,fetch(s,{mode:"cors",credentials:"include",signal:t.current.signal});case 8:return l=a.sent,a.prev=9,a.next=12,l.json();case 12:u=a.sent,h="ENVISAT"===e.current.mission?Ze(u):We(u),c={totalresults:null==h.properties.totalResults?0:Number(h.properties.totalResults),startindex:Number(h.properties.startIndex),itemsperpage:Number(h.properties.itemsPerPage)},console.log(c),c.totalresults>0&&o(h),c.startindex+c.itemsperpage<Math.min(c.totalresults,1e3)?(b(!1),n(r,c.startindex+c.itemsperpage)):f(!1),a.next=25;break;case 20:a.prev=20,a.t0=a.catch(9),console.log("Didn't receive a json !"),console.log(a.t0),f(!1);case 25:a.next=32;break;case 27:a.prev=27,a.t1=a.catch(5),console.log("Error contacting server..."),console.log(a.t1),f(!1);case 32:case"end":return a.stop()}}),a,null,[[5,27],[9,20]])})));return function(e,t){return a.apply(this,arguments)}}();_&&n(_,S(e.current.mission).startIndexOrigin)}}),[_]);return{geojsonResults:i,loading:u,firstpage:p,search:function(n){var a,r=n.searchdate,i=n.mission,o=n.searchpoint,s="",c=S(i);if(!c)return null;u&&t.current.abort();c.windowSize;if(r){new Date(0);var l=Math.floor(r.getTime()/c.windowSize)*c.windowSize;a=new Date(l).toJSON(),s=new Date(l+c.windowSize-1e3).toJSON()}var d=function(e){var t=e.code,n=e.polygon,a=e.start,r=e.end,i=(e.startindex,S(t));if(!i)return null;var o=i.templateUrl;return o=null!=n?o.replace("{polygon}",n):o.replace(i.areaOff,""),null!=a&&null!=r?(o=o.replace("{start}",a)).replace("{end}",r):o.replace(i.dateOff,"")}({code:i,polygon:o,start:a,end:s});b(!0),e.current.searchdate=r,e.current.mission=i,e.current.searchpoint=o,j(d)}}}var Je=n(62);var Qe=function(e){var t=e.searchdate,n=e.searchpoint,r=e.mission,i=e.altitude,o=e.onPageSearch,c=e.onSearchComplete,u=Object(a.useState)(!1),d=Object(s.a)(u,2),h=d[0],f=d[1],m=Object(a.useState)(0),g=Object(s.a)(m,2),p=g[0],b=g[1],v=(Object(a.useRef)(),Object(a.useRef)(new Date(0))),O=Object(a.useState)({}),_=Object(s.a)(O,2),j=_[0],y=_[1],S=Xe(),x=S.geojsonResults,E=S.loading,M=S.search;return Object(me.a)("x",(function(){return b(Math.random())})),Object(a.useEffect)((function(){if(x){o(x);var e=new Date(x.features[0].properties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime);(v.current.getTime()<e.getTime()||null===v.current)&&(v.current=e)}}),[x]),Object(a.useEffect)((function(){f(E),!1===E&&0!==v.current.getTime()&&c(v.current)}),[E]),Object(a.useEffect)((function(){o(),v.current=new Date(0),M(j)}),[p]),Object(a.useEffect)((function(){var e=t,a=n;i>3e6?a=null:e=null,y((function(t){return Object(l.a)(Object(l.a)({},t),{},{searchdate:e,mission:r,searchpoint:a})}))}),[t,r,n,i]),Object(ve.jsx)("div",{children:Object(ve.jsx)("div",{className:!0===h?"SearchController Active":"SearchController",onClick:function(){b(Math.random())},children:Object(ve.jsx)(je.Icon,{icon:Je.a,width:"50px"})})})},$e=function(){var e=Object(c.useGlobal)("searchDate"),t=Object(s.a)(e,1)[0],n=Object(c.useGlobal)("goToDate"),a=Object(s.a)(n,2),r=(a[0],a[1]),i=Object(c.useGlobal)("searchPoint"),o=Object(s.a)(i,1)[0],l=Object(c.useGlobal)("mission"),u=Object(s.a)(l,1)[0],d=Object(c.useGlobal)("altitude"),h=Object(s.a)(d,1)[0],f=Object(c.useGlobal)("geojson"),m=Object(s.a)(f,2),g=(m[0],m[1]);return Object(ve.jsx)(Qe,{searchdate:t,searchpoint:o,mission:u,altitude:h,onPageSearch:function(e){g(e)},onSearchComplete:function(e){e&&(r(e),console.log("search complete. Last item: "+e))}})},et=n(63);var tt=function(){var e=Object(c.useGlobal)("mission"),t=Object(s.a)(e,1)[0],n=Object(a.useRef)(),r=Object(et.a)().toggle;return Object(me.a)("f",(function(){r(n.current)})),Object(ve.jsxs)("div",{className:"App",ref:n,id:"container",children:[Object(ve.jsx)(_e,{id:"globe"}),Object(ve.jsx)(He,{}),Object(ve.jsx)($e,{}),Object(ve.jsx)(Ce,{}),Object(ve.jsxs)(Se,{active:"false",children:[Object(ve.jsx)(Ee,{}),Object(ve.jsx)(Te,{}),Object(ve.jsxs)("div",{className:"horizontalContainer",children:[Object(ve.jsx)(Ne,{}),Object(ve.jsx)(we,{})]})]}),Object(ve.jsx)("div",{className:"MissionLabel",children:t})]})},nt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,99)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};console.log("init global: "+new Date),Object(c.setGlobal)({mission:"S1",altitude:"5000000",satellites:!0,appColor:"#ebd1d1",position:{clon:"0.5",clat:"45"},viewDate:new Date,goToDate:new Date,searchDate:new Date,searchPoint:"POINT(40 40)",geojson:null,mapSettings:{atmosphere:!1,starfield:!0,names:!1,background:1,overlay:2,dem:!1}}),o.a.render(Object(ve.jsx)(r.a.StrictMode,{children:Object(ve.jsx)(tt,{})}),document.getElementById("root")),nt()}},[[98,1,2]]]);
//# sourceMappingURL=main.64bfe2e8.chunk.js.map