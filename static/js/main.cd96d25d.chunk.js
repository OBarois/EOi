(this.webpackJsonpeoi=this.webpackJsonpeoi||[]).push([[0],{52:function(e,t,r){},56:function(e,t,r){},57:function(e,t,r){},68:function(e,t,r){},83:function(e,t,r){},86:function(e,t,r){},88:function(e,t,r){},89:function(e,t,r){},90:function(e,t,r){},91:function(e,t,r){},92:function(e,t,r){},93:function(e,t,r){},95:function(e,t,r){},96:function(e,t,r){},97:function(e,t,r){},98:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(33),o=r.n(a),s=(r(68),r(4)),l=r(6),c=(r(83),r(5)),u=(r(52),r(14)),h=r.n(u),d=r(17),g=r(2),f=r.n(g),p=f.a.AbstractError,m=f.a.Angle,_=f.a.Location,v=f.a.Logger,b=f.a.NotYetImplementedError,E=f.a.PickedObject,y=f.a.PolygonSplitter,x=f.a.Renderable,S=f.a.Sector,w=f.a.ShapeAttributes,T=f.a.Vec3,O=f.a.MemoryCache,R=f.a.BoundingBox,C=f.a.SurfaceShape;(C=function(e){x.call(this),this._displayName="Surface Shape",this._attributes=e||new w(null),this._highlightAttributes=null,this._highlighted=!1,this._enabled=!0,this._pathType=f.a.GREAT_CIRCLE,this._maximumNumEdgeIntervals=C.DEFAULT_NUM_EDGE_INTERVALS,this._polarThrottle=C.DEFAULT_POLAR_THROTTLE,this._sector=null,this.pickDelegate=null,this._sectors=[],this._locations=null,this._boundaries=null,this._interiorGeometry=null,this._outlineGeometry=null,this._isInteriorInhibited=!1,this.stateKeyInvalid=!0,this._attributesStateKey=null,this.boundariesArePrepared=!1,this.layer=null,this.pickColor=null,this.contours=[],this.containsPole=!1,this.crossesAntiMeridian=!1,this.expirationInterval=2e3,this.shapeDataCache=new O(3,2),this.currentData=null}).prototype=Object.create(x.prototype),Object.defineProperties(C.prototype,{stateKey:{get:function(){if(this._attributesStateKey){var e=null;this._highlighted?this._highlightAttributes&&(e=this._highlightAttributes.stateKey):this._attributes&&(e=this._attributes.stateKey),e!=this._attributesStateKey&&(this._attributesStateKey=e,this.stateKeyInvalid=!0)}else this._highlighted?this._highlightAttributes&&(this._attributesStateKey=this._highlightAttributes.stateKey):this._attributes&&(this._attributesStateKey=this._attributes.stateKey),this._attributesStateKey&&(this.stateKeyInvalid=!0);return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey()),this._stateKey}},displayName:{get:function(){return this._displayName},set:function(e){this.stateKeyInvalid=!0,this._displayName=e}},attributes:{get:function(){return this._attributes},set:function(e){this.stateKeyInvalid=!0,this._attributes=e,this._attributesStateKey=e.stateKey}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(e){this.stateKeyInvalid=!0,this._highlightAttributes=e}},highlighted:{get:function(){return this._highlighted},set:function(e){this.stateKeyInvalid=!0,this._highlighted=e}},enabled:{get:function(){return this._enabled},set:function(e){this.stateKeyInvalid=!0,this._enabled=e}},pathType:{get:function(){return this._pathType},set:function(e){this.stateKeyInvalid=!0,this.resetBoundaries(),this._pathType=e}},maximumNumEdgeIntervals:{get:function(){return this._maximumNumEdgeIntervals},set:function(e){this.stateKeyInvalid=!0,this.resetBoundaries(),this._maximumNumEdgeIntervals=e}},polarThrottle:{get:function(){return this._polarThrottle},set:function(e){this.stateKeyInvalid=!0,this.resetBoundaries(),this._polarThrottle=e}},sector:{get:function(){return this._sector}}}),C.staticStateKey=function(e){return e.stateKeyInvalid=!1,e.highlighted&&e._highlightAttributes?e._attributesStateKey=e._highlightAttributes.stateKey:e._attributes?e._attributesStateKey=e._attributes.stateKey:e._attributesStateKey=null,"dn "+e.displayName+" at "+(e._attributesStateKey?e._attributesStateKey:"null")+" hi "+e.highlighted+" en "+e.enabled+" pt "+e.pathType+" ne "+e.maximumNumEdgeIntervals+" po "+e.polarThrottle+" se ["+e.sector.minLatitude+","+e.sector.maxLatitude+","+e.sector.minLongitude+","+e.sector.maxLongitude+"]"},C.prototype.computeStateKey=function(){return C.staticStateKey(this)},C.prototype.area=function(e,t){throw new b(v.logMessage(v.LEVEL_SEVERE,"SurfaceShape","area","notYetImplemented"))},C.prototype.computeBoundaries=function(e){throw new p(v.logMessage(v.LEVEL_SEVERE,"SurfaceShape","computeBoundaries","abstractInvocation"))},C.prototype.intersectsFrustum=function(e){return!this.currentData||!this.currentData.extent||(e.pickingMode?this.currentData.extent.intersectsFrustum(e.pickFrustum):this.currentData.extent.intersectsFrustum(e.frustumInModelCoordinates))},C.prototype.isShapeDataCurrent=function(e,t){return t.verticalExaggeration===e.verticalExaggeration&&t.expiryTime>Date.now()},C.prototype.createShapeDataObject=function(){return{}},C.prototype.resetExpiration=function(e){e.expiryTime=Date.now()+this.expirationInterval+1e3*Math.random()},C.prototype.establishCurrentData=function(e){this.currentData=this.shapeDataCache.entryForKey(e.globeStateKey),this.currentData||(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(e.globeStateKey,this.currentData,1)),this.currentData.isExpired=!this.isShapeDataCurrent(e,this.currentData)},C.prototype.render=function(e){this.enabled&&(this.layer=e.currentLayer,this.prepareBoundaries(e),this.establishCurrentData(e),!this.currentData.isExpired&&this.currentData.extent||(this.computeExtent(e),this.currentData.verticalExaggeration=e.verticalExaggeration,this.resetExpiration(this.currentData)),this.currentData&&this.currentData.extent&&!this.intersectsFrustum(e)||e.surfaceShapeTileBuilder.insertSurfaceShape(this))},C.prototype.interpolateLocations=function(e){var t,r,n,i=e[0],a=i,o=!0,s=!0,l=0,c=!0;for(this._locations=[i],r=1,n=e.length;r<n;r+=1)t=a,s=o,c=!0,((o=(a=e[r]).latitude==i.latitude&&a.longitude==i.longitude)||s)&&(l+=1)>2&&(c=!1),c&&this.interpolateEdge(t,a,this._locations),this._locations.push(a),t=a;this._isInteriorInhibited||t.latitude==i.latitude&&t.longitude==i.longitude||(this.interpolateEdge(t,i,this._locations),this._locations.push(i))},C.prototype.interpolateEdge=function(e,t,r){var n,i,a=_.greatCircleDistance(e,t),o=Math.round(this._maximumNumEdgeIntervals*a/Math.PI);if(o>0){n=1/o,i=e;for(var s=this.throttledStep(n,i);s<1;s+=this.throttledStep(n,i))i=new _(0,0),_.interpolateAlongPath(this._pathType,s,e,t,i),180===e.longitude&&180===t.longitude?i.longitude=180:-180===e.longitude&&-180===t.longitude&&(i.longitude=-180),r.push(i)}},C.prototype.throttledStep=function(e,t){var r=Math.cos(t.latitude*m.DEGREES_TO_RADIANS);r*=r;var n=this._polarThrottle/(1+this._polarThrottle);return e*(1-n+n*r)},C.prototype.prepareBoundaries=function(e){if(!this.boundariesArePrepared){this._boundaries||this.computeBoundaries(e);var t=this.formatBoundaries();this.normalizeAngles(t),t=this.interpolateBoundaries(t);var r=[],n=y.splitContours(t,r);this.contours=r,this.crossesAntiMeridian=n,this.prepareGeometry(e,r),this.prepareSectors(),this.boundariesArePrepared=!0}},C.prototype.resetBoundaries=function(){this.boundariesArePrepared=!1,this.shapeDataCache.clear(!1)},C.prototype.formatBoundaries=function(){var e=[];return this._boundaries.length?(null!=this._boundaries[0].latitude?e.push(this._boundaries):e=this._boundaries,e):e},C.prototype.normalizeAngles=function(e){for(var t=0,r=e.length;t<r;t++)for(var n=e[t],i=0,a=n.length;i<a;i++){var o=n[i];(o.longitude<-180||o.longitude>180)&&(o.longitude=m.normalizedDegreesLongitude(o.longitude)),(o.latitude<-90||o.latitude>90)&&(o.latitude=m.normalizedDegreesLatitude(o.latitude))}},C.prototype.interpolateBoundaries=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];this.interpolateLocations(i),t.push(this._locations.slice()),this._locations.length=0}return t},C.prototype.computeSectors=function(e){return this._sectors&&this._sectors.length>0||this.prepareBoundaries(e),this._sectors},C.prototype.computeExtent=function(e){if(!this._sectors||0===this._sectors.length)return null;if(!this.currentData)return null;var t;if(this.currentData.extent||(this.currentData.extent=new R),1===this._sectors.length)t=this._sectors[0].computeBoundingPoints(e.globe,e.verticalExaggeration),this.currentData.extent.setToVec3Points(t);else{for(var r=[],n=0;n<this._sectors.length;n++){t=this._sectors[n].computeBoundingPoints(e.globe,e.verticalExaggeration);var i=new R;i.setToVec3Points(t);for(var a=i.getCorners(),o=0;o<a.length;o++)r.push(a[o])}this.currentData.extent.setToVec3Points(r)}return this.currentData.extent},C.prototype.computeShiftedLocations=function(e,t,r,n){var i=[],a=new T(0,0,0),o=new f.a.Position(0,0,0),s=e.computePointFromLocation(t.latitude,t.longitude,new T(0,0,0)),l=e.computePointFromLocation(r.latitude,r.longitude,new T(0,0,0));if(e.is2D())for(var c=l.subtract(s),u=0,h=n.length;u<h;u++)e.computePointFromLocation(n[u].latitude,n[u].longitude,a),a.add(c),e.computePositionFromPoint(a[0],a[1],a[2],o),i.push(new _(o.latitude,o.longitude));else{var d=r.latitude-t.latitude,g=r.longitude-t.longitude,p=-90,m=90;for(u=0,h=n.length;u<h;u++){var v=n[u].latitude+d,b=n[u].longitude+g;v>90?(v=180-v,b+=180):v<-90&&(v=-180-v,b+=180),b<-180?b+=360:b>180&&(b-=360),v>p&&(p=v),v<m&&(m=v),i.push(new _(v,b))}if(p>90)for(c=p-90,u=0,h=i.length;u<h;u++)i[u].latitude-=c}return i},C.prototype.prepareSectors=function(){this.determineSectors(),this.crossesAntiMeridian?this.sectorsOverAntiMeridian():this.sectorsNotOverAntiMeridian()},C.prototype.determineSectors=function(){for(var e=0,t=this.contours.length;e<t;e++){var r=this.contours[e],n=r.polygons;r.sectors=[];for(var i=0,a=n.length;i<a;i++){var o=n[i],s=new S(0,0,0,0);if(s.setToBoundingSector(o),this._pathType===f.a.GREAT_CIRCLE){var l=_.greatCircleArcExtremeLocations(o),c=Math.min(s.minLatitude,l[0].latitude),u=Math.max(s.maxLatitude,l[1].latitude);s.minLatitude=c,s.maxLatitude=u}r.sectors.push(s)}}},C.prototype.sectorsOverAntiMeridian=function(){for(var e=new S(90,-90,180,-180),t=new S(90,-90,180,-180),r=0,n=this.contours.length;r<n;r++)for(var i=this.contours[r].sectors,a=0,o=i.length;a<o;a++){var s=i[a];s.minLongitude<0&&s.maxLongitude>0?(t.union(s),e.union(s)):s.minLongitude<0?t.union(s):e.union(s)}var l=Math.min(e.minLatitude,t.minLatitude),c=Math.max(e.maxLatitude,e.maxLatitude);this._sector=new S(l,c,-180,180),this._sectors=[e,t]},C.prototype.sectorsNotOverAntiMeridian=function(){this._sector=new S(90,-90,180,-180);for(var e=0,t=this.contours.length;e<t;e++)for(var r=this.contours[e].sectors,n=0,i=r.length;n<i;n++)this._sector.union(r[n]);this._sectors=[this._sector]},C.prototype.prepareGeometry=function(e,t){for(var r=[],n=[],i=0,a=t.length;i<a;i++)for(var o=t[i],s=o.poleIndex,l=0,c=o.polygons.length;l<c;l++){var u=o.polygons[l],h=o.iMap[l];r.push(u),o.pole!==_.poles.NONE&&c>1?l===s?this.outlineForPole(u,h,n):this.outlineForSplit(u,h,n):o.pole!==_.poles.NONE&&1===c?this.outlineForPole(u,h,n):o.pole===_.poles.NONE&&c>1?this.outlineForSplit(u,h,n):o.pole===_.poles.NONE&&1===c&&n.push(u)}this._interiorGeometry=r,this._outlineGeometry=n},C.prototype.outlineForPole=function(e,t,r){this.containsPole=!0;for(var n=[],i=0,a=0,o=e.length;a<o;a++){var s=e[a],l=t.get(a);l&&l.forPole&&++i%2===1&&(n.push(s),r.push(n),n=[]),i%2===0&&n.push(s)}n.length&&r.push(n)},C.prototype.outlineForSplit=function(e,t,r){for(var n=[],i=0,a=0,o=e.length;a<o;a++){var s=e[a],l=t.get(a);l&&!l.forPole&&++i%2===0&&(n.push(s),r.push(n),n=[]),i%2===1&&n.push(s)}},C.prototype.resetPickColor=function(){this.pickColor=null},C.prototype.renderToTexture=function(e,t,r,n,i,a){var o=this._highlighted&&this._highlightAttributes||this._attributes,s=!this._isInteriorInhibited&&o.drawInterior,l=o.drawOutline&&o.outlineWidth>0;if(s||l){if(e.pickingMode&&!this.pickColor&&(this.pickColor=e.uniquePickColor()),e.pickingMode)var c=this.pickColor.toHexString();if(this.crossesAntiMeridian||this.containsPole?(s&&(this.draw(this._interiorGeometry,t,r,n,i,a),t.fillStyle=e.pickingMode?c:o.interiorColor.toRGBAString(),t.fill()),l&&(this.draw(this._outlineGeometry,t,r,n,i,a),t.lineWidth=4*o.outlineWidth,t.strokeStyle=e.pickingMode?c:o.outlineColor.toRGBAString(),t.stroke())):(this.draw(this._interiorGeometry,t,r,n,i,a),s&&(t.fillStyle=e.pickingMode?c:o.interiorColor.toRGBAString(),t.fill()),l&&(t.lineWidth=4*o.outlineWidth,t.strokeStyle=e.pickingMode?c:o.outlineColor.toRGBAString(),t.stroke())),e.pickingMode){var u=new E(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);e.resolvePick(u)}}},C.prototype.draw=function(e,t,r,n,i,a){t.beginPath();for(var o=0,s=e.length;o<s;o++){var l=e[o],c=l[0],u=c.longitude*r+i,h=c.latitude*n+a;t.moveTo(u,h);for(var d=1,g=l.length;d<g;d++)u=(c=l[d]).longitude*r+i,h=c.latitude*n+a,t.lineTo(u,h)}},C.DEFAULT_NUM_EDGE_INTERVALS=128,C.DEFAULT_POLAR_THROTTLE=10,f.a.SurfaceShape=C;var L=C;f.a.DrawContext.prototype.resolvePick=function(e){if(e.userObject instanceof L||!this.deepPicking||this.regionPicking)this.addPickedObject(e);else{var t=this.readPickColor(this.pickPoint);if(!t)return null;e.color.equals(t)&&this.addPickedObject(e)}};var A=r(7),j=r(8),N=function(){function e(t,r,n){Object(A.a)(this,e),this.textureId=t||null,this.imageWidth=r,this.imageHeight=n,this.size=r*n*4,this.originalImageWidth=r,this.originalImageHeight=n,this.creationTime=new Date}return Object(j.a)(e,[{key:"bind",value:function(e){return e.currentGlContext.bindTexture(e.currentGlContext.TEXTURE_2D,this.textureId),e.frameStatistics.incrementTextureLoadCount(1),!0}},{key:"dispose",value:function(e){e.deleteTexture(this.textureId),delete this.textureId}}]),e}(),D=function(){function e(){Object(A.a)(this,e),this.framebufferId=null,this.textureId=null,this.width=0,this.height=0,this.texture=null}return Object(j.a)(e,[{key:"attachTexture",value:function(e,t,r){return this.textureId=this.createTexture(e,t,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.textureId,0),this.texture=new N(this.textureId,t,r),!0}},{key:"bind",value:function(e,t,r){this.framebufferId||(this.framebufferId=e.createFramebuffer()),this.width=t,this.height=r,e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId),e.viewport(0,0,t,r)}},{key:"bind_or",value:function(e,t,r){return this.framebufferId||(this.framebufferId=e.createFramebuffer()),this.width=t,this.height=r,e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId),e.viewport(0,0,t,r),this.textureId=this.createTexture(e,t,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.textureId,0),this.texture=new N(this.textureId,t,r),!0}},{key:"clear",value:function(e){e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)}},{key:"unbind",value:function(e,t){t?(e.bindFramebuffer(e.FRAMEBUFFER,t.framebufferId),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height))}},{key:"createTexture",value:function(e,t,r){256!==t&&console.log("width",t),256!==r&&console.log("width",r);var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),n}}]),e}(),M=f.a.ArgumentError,k=f.a.Logger,P=f.a.SurfaceShapeTileBuilder,I=f.a.SurfaceShape,G=f.a.PickedObject,U="SurfaceShapeFBO";P.prototype.buildTiles=function(e){if(!e)throw new M(k.logMessage(k.LEVEL_SEVERE,"SurfaceShapeTileBuilder","buildTiles","missingDc"));if(this.surfaceShapes&&!(this.surfaceShapes.length<1)){if(this.assembleTiles(e),P.__fboBound__)P.getFbo(e).unbind(e.currentGlContext,e.currentFramebuffer),P.__fboBound__=!1;this.surfaceShapes.splice(0,this.surfaceShapes.length);for(var t=0,r=this.surfaceShapeTiles.length;t<r;t+=1){this.surfaceShapeTiles[t].clearShapes()}}},P.prototype.addTile=function(e,t){if(e.pickingMode&&(t.pickSequence=P.pickSequence),t.needsUpdate(e)){var r=P.getFbo(e);P.__fboBound__||(r.bind(e.currentGlContext,this.tileWidth,this.tileHeight),P.__fboBound__=!0),t.updateTexture(e)}this.surfaceShapeTiles.push(t)},P.prototype.doRender=function(e){if(e.pickingMode){for(var t=0,r=this.surfaceShapes.length;t<r;t+=1)this.surfaceShapes[t].resetPickColor();P.pickSequence+=1;var n=this.surfaceShapeTiles,i=this.topLevelTiles;this.surfaceShapeTiles=[],this.topLevelTiles=[],this.buildTiles(e),e.deepPicking?this.doDeepPickingRender(e):e.surfaceTileRenderer.renderTiles(e,this.surfaceShapeTiles,1),this.surfaceShapeTiles=n,this.topLevelTiles=i}else this.buildTiles(e),e.surfaceTileRenderer.renderTiles(e,this.surfaceShapeTiles,1)},P.prototype.doDeepPickingRender=function(e){var t,r,n,i,a,o,s,l,c,u=[];for(a=0,o=e.objectsAtPickPoint.objects.length;a<o;a+=1)(s=e.objectsAtPickPoint.objects[a]).userObject instanceof I&&(l=s.userObject,u.indexOf(l)<0&&(u.push(l),e.objectsAtPickPoint.objects.splice(a,1),a-=1,o-=1));if(!(u.length<=0)){var h=[];for(n=0,i=u.length;n<i;n+=1){l=u[n];var d=P.getFbo(e);for(P.__fboBound__||(d.bind(e.currentGlContext,this.tileWidth,this.tileHeight),P.__fboBound__=!0),t=0,r=this.surfaceShapeTiles.length;t<r;t+=1)(c=this.surfaceShapeTiles[t]).setShapes([l]),c.updateTexture(e);if(P.__fboBound__)P.getFbo(e).unbind(e.currentGlContext,e.currentFramebuffer),P.__fboBound__=!1;e.surfaceTileRenderer.renderTiles(e,this.surfaceShapeTiles,1);var g=e.readPickColor(e.pickPoint);g&&l.pickColor.equals(g)&&(s=new G(l.pickColor.clone(),l.pickDelegate?l.pickDelegate:l,null,l.layer,!1),h.push(s))}for(a=0,o=e.objectsAtPickPoint.objects.length;a<o;a+=1)(s=e.objectsAtPickPoint.objects[a]).userObject instanceof I&&(e.objectsAtPickPoint.objects.splice(a,1),a-=1,o-=1);for(a=0,o=h.length;a<o;a+=1)s=h[a],e.objectsAtPickPoint.objects.push(s)}},P.getFbo=function(e){var t=e.gpuResourceCache.resourceForKey(U);return t||(t=new D,e.gpuResourceCache.putResource(U,t,1)),t},P.__frameStart__=!1,P.__fboBound__=!1,f.a.SurfaceShapeTile.prototype.updateTexture=function(e){var t=e.currentGlContext,r=this.tileWidth/this.sector.deltaLongitude(),n=-this.tileHeight/this.sector.deltaLatitude(),i=-this.sector.minLongitude*r,a=-this.sector.maxLatitude*n;this.asRenderedSurfaceShapeStateKeys=[];var o=e.gpuResourceCache.resourceForKey("SurfaceShapeFBO");o.attachTexture(t,this.tileWidth,this.tileHeight),o.clear(t);for(var s=0,l=this.surfaceShapes.length;s<l;s+=1){var c=this.surfaceShapes[s];this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[s]),c.renderToTexture(e,o,r,n,i,a)}this.gpuCacheKey=this.getCacheKey();var u=e.gpuResourceCache,h=o.texture;return u.putResource(this.gpuCacheKey,h,h.size),h};var F=f.a.TiledImageLayer;F.prototype.retrieveTileImage=function(e,t,r){(this.pendingRequests||(this.pendingRequests=[]),this.MAX_REQUESTS||(this.MAX_REQUESTS=16),this.currentRetrievals.indexOf(t.imagePath)>=0)||(this.pendingRequests.some((function(e){return e.imagePath===t.imagePath}))||this.absentResourceList.isResourceAbsent(t.imagePath)||(this.resourceUrlForTile(t,this.retrievalImageFormat)?(20===this.pendingRequests.length&&this.pendingRequests.shift(),this.pendingRequests.push(t),this.currentRetrievals.length<=this.MAX_REQUESTS&&this.fetchMoreImages(e,this)):this.currentTilesInvalid=!0))},F.prototype.fetchMoreImages=function(e,t){var r=t.pendingRequests.length;if(t.pendingRequests=t.pendingRequests.filter((function(r){return t.isTileVisible(e,r)})),t.pendingRequests.length){t.pendingRequests.length;var n=t.pendingRequests.shift(),i=n.imagePath,a=t.resourceUrlForTile(n,t.retrievalImageFormat);if(i&&a){var o=e.gpuResourceCache;t.fetchImage(a,(function(r,n){if(r)return t.removeFromCurrentRetrievals(i),t.absentResourceList.markResourceAbsent(i),void(t.currentRetrievals.length<=t.MAX_REQUESTS&&t.fetchMoreImages(e,t));var a=t.createTexture(e,null,n);if(t.removeFromCurrentRetrievals(i),a){o.putResource(i,a,a.size),t.currentTilesInvalid=!0,t.absentResourceList.unmarkResourceAbsent(i);var s=document.createEvent("Event");s.initEvent(f.a.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(s)}t.currentRetrievals.length<=t.MAX_REQUESTS&&t.fetchMoreImages(e,t)})),t.currentRetrievals.push(i)}}},F.prototype.fetchImage=function(e,t){var r=new Image;r.onload=function(){t(null,r)},r.onerror=function(){t(new Error("Image retrieval failed"),null)},r.crossOrigin="anonymous",window.webkit||!window.webkit&&window.AndroidApp,r.src=e},F.prototype.doRender_=function(e){e.terrain&&(!this.currentTilesInvalid&&this.lasTtMVP&&e.navigatorState.modelviewProjection.equals(this.lasTtMVP)&&e.globeStateKey===this.lastGlobeStateKey||(this.currentTilesInvalid=!1,this.assembleTiles(e)),this.lasTtMVP=e.navigatorState.modelviewProjection,this.lastGlobeStateKey=e.globeStateKey,this.currentTiles.length>0&&(e.surfaceTileRenderer.renderTiles(e,this.currentTiles,this.opacity,e.surfaceOpacity>=1),e.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0))},F.prototype.cleanCache=function(){};var B=r(9),V=r(10),z={DEBUG:!1,assert:function(e,t){if(z.DEBUG&&!e)throw new Error("Assertion failed"+(t?": "+t:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,TESS_MAX_CACHE:100,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};z.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},z.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},z.geom.edgeEval=function(e,t,r){var n=t.s-e.s,i=r.s-t.s;return n+i>0?n<i?t.t-e.t+(e.t-r.t)*(n/(n+i)):t.t-r.t+(r.t-e.t)*(i/(n+i)):0},z.geom.edgeSign=function(e,t,r){var n=t.s-e.s,i=r.s-t.s;return n+i>0?(t.t-r.t)*n+(t.t-e.t)*i:0},z.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},z.geom.transEval=function(e,t,r){var n=t.t-e.t,i=r.t-t.t;return n+i>0?n<i?t.s-e.s+(e.s-r.s)*(n/(n+i)):t.s-r.s+(r.s-e.s)*(i/(n+i)):0},z.geom.transSign=function(e,t,r){var n=t.t-e.t,i=r.t-t.t;return n+i>0?(t.s-r.s)*n+(t.s-e.s)*i:0},z.geom.edgeGoesLeft=function(e){return z.geom.vertLeq(e.dst(),e.org)},z.geom.edgeGoesRight=function(e){return z.geom.vertLeq(e.org,e.dst())},z.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},z.geom.vertCCW=function(e,t,r){return e.s*(t.t-r.t)+t.s*(r.t-e.t)+r.s*(e.t-t.t)>=0},z.geom.interpolate_=function(e,t,r,n){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+n)/2:t+e/(e+r)*(n-t):n+r/(e+r)*(t-n)},z.geom.edgeIntersect=function(e,t,r,n,i){var a,o,s;z.geom.vertLeq(e,t)||(s=e,e=t,t=s),z.geom.vertLeq(r,n)||(s=r,r=n,n=s),z.geom.vertLeq(e,r)||(s=e,e=r,r=s,s=t,t=n,n=s),z.geom.vertLeq(r,t)?z.geom.vertLeq(t,n)?((a=z.geom.edgeEval(e,r,t))+(o=z.geom.edgeEval(r,t,n))<0&&(a=-a,o=-o),i.s=z.geom.interpolate_(a,r.s,o,t.s)):((a=z.geom.edgeSign(e,r,t))+(o=-z.geom.edgeSign(e,n,t))<0&&(a=-a,o=-o),i.s=z.geom.interpolate_(a,r.s,o,n.s)):i.s=(r.s+t.s)/2,z.geom.transLeq(e,t)||(s=e,e=t,t=s),z.geom.transLeq(r,n)||(s=r,r=n,n=s),z.geom.transLeq(e,r)||(s=e,e=r,r=s,s=t,t=n,n=s),z.geom.transLeq(r,t)?z.geom.transLeq(t,n)?((a=z.geom.transEval(e,r,t))+(o=z.geom.transEval(r,t,n))<0&&(a=-a,o=-o),i.t=z.geom.interpolate_(a,r.t,o,t.t)):((a=z.geom.transSign(e,r,t))+(o=-z.geom.transSign(e,n,t))<0&&(a=-a,o=-o),i.t=z.geom.interpolate_(a,r.t,o,n.t)):i.t=(r.t+t.t)/2},z.mesh={},z.mesh.makeEdge=function(e){var t=z.mesh.makeEdgePair_(e.eHead);return z.mesh.makeVertex_(t,e.vHead),z.mesh.makeVertex_(t.sym,e.vHead),z.mesh.makeFace_(t,e.fHead),t},z.mesh.meshSplice=function(e,t){var r=!1,n=!1;e!==t&&(t.org!==e.org&&(n=!0,z.mesh.killVertex_(t.org,e.org)),t.lFace!==e.lFace&&(r=!0,z.mesh.killFace_(t.lFace,e.lFace)),z.mesh.splice_(t,e),n||(z.mesh.makeVertex_(t,e.org),e.org.anEdge=e),r||(z.mesh.makeFace_(t,e.lFace),e.lFace.anEdge=e))},z.mesh.deleteEdge=function(e){var t=e.sym,r=!1;e.lFace!==e.rFace()&&(r=!0,z.mesh.killFace_(e.lFace,e.rFace())),e.oNext===e?z.mesh.killVertex_(e.org,null):(e.rFace().anEdge=e.oPrev(),e.org.anEdge=e.oNext,z.mesh.splice_(e,e.oPrev()),r||z.mesh.makeFace_(e,e.lFace)),t.oNext===t?(z.mesh.killVertex_(t.org,null),z.mesh.killFace_(t.lFace,null)):(e.lFace.anEdge=t.oPrev(),t.org.anEdge=t.oNext,z.mesh.splice_(t,t.oPrev())),z.mesh.killEdge_(e)},z.mesh.addEdgeVertex=function(e){var t=z.mesh.makeEdgePair_(e),r=t.sym;return z.mesh.splice_(t,e.lNext),t.org=e.dst(),z.mesh.makeVertex_(r,t.org),t.lFace=r.lFace=e.lFace,t},z.mesh.splitEdge=function(e){var t=z.mesh.addEdgeVertex(e).sym;return z.mesh.splice_(e.sym,e.sym.oPrev()),z.mesh.splice_(e.sym,t),e.sym.org=t.org,t.dst().anEdge=t.sym,t.sym.lFace=e.rFace(),t.winding=e.winding,t.sym.winding=e.sym.winding,t},z.mesh.connect=function(e,t){var r=!1,n=z.mesh.makeEdgePair_(e),i=n.sym;return t.lFace!==e.lFace&&(r=!0,z.mesh.killFace_(t.lFace,e.lFace)),z.mesh.splice_(n,e.lNext),z.mesh.splice_(i,t),n.org=e.dst(),i.org=t.org,n.lFace=i.lFace=e.lFace,e.lFace.anEdge=i,r||z.mesh.makeFace_(n,e.lFace),n},z.mesh.zapFace=function(e){var t,r=e.anEdge,n=r.lNext;do{if(n=(t=n).lNext,t.lFace=null,null===t.rFace()){t.oNext===t?z.mesh.killVertex_(t.org,null):(t.org.anEdge=t.oNext,z.mesh.splice_(t,t.oPrev()));var i=t.sym;i.oNext===i?z.mesh.killVertex_(i.org,null):(i.org.anEdge=i.oNext,z.mesh.splice_(i,i.oPrev())),z.mesh.killEdge_(t)}}while(t!==r);var a=e.prev,o=e.next;o.prev=a,a.next=o},z.mesh.meshUnion=function(e,t){var r=e.fHead,n=e.vHead,i=e.eHead,a=t.fHead,o=t.vHead,s=t.eHead;return a.next!==a&&(r.prev.next=a.next,a.next.prev=r.prev,a.prev.next=r,r.prev=a.prev),o.next!==o&&(n.prev.next=o.next,o.next.prev=n.prev,o.prev.next=n,n.prev=o.prev),s.next!==s&&(i.sym.next.sym.next=s.next,s.next.sym.next=i.sym.next,s.sym.next.sym.next=i,i.sym.next=s.sym.next),e},z.mesh.deleteMesh=function(e){},z.mesh.makeEdgePair_=function(e){var t=new z.GluHalfEdge,r=new z.GluHalfEdge,n=e.sym.next;return r.next=n,n.sym.next=t,t.next=e,e.sym.next=r,t.sym=r,t.oNext=t,t.lNext=r,r.sym=t,r.oNext=r,r.lNext=t,t},z.mesh.splice_=function(e,t){var r=e.oNext,n=t.oNext;r.sym.lNext=t,n.sym.lNext=e,e.oNext=n,t.oNext=r},z.mesh.makeVertex_=function(e,t){var r=t.prev,n=new z.GluVertex(t,r);r.next=n,t.prev=n,n.anEdge=e;var i=e;do{i.org=n,i=i.oNext}while(i!==e)},z.mesh.makeFace_=function(e,t){var r=t.prev,n=new z.GluFace(t,r);r.next=n,t.prev=n,n.anEdge=e,n.inside=t.inside;var i=e;do{i.lFace=n,i=i.lNext}while(i!==e)},z.mesh.killEdge_=function(e){var t=e.next,r=e.sym.next;t.sym.next=r,r.sym.next=t},z.mesh.killVertex_=function(e,t){var r=e.anEdge,n=r;do{n.org=t,n=n.oNext}while(n!==r);var i=e.prev,a=e.next;a.prev=i,i.next=a},z.mesh.killFace_=function(e,t){var r=e.anEdge,n=r;do{n.lFace=t,n=n.lNext}while(n!==r);var i=e.prev,a=e.next;a.prev=i,i.next=a},z.normal={},z.normal.S_UNIT_X_=1,z.normal.S_UNIT_Y_=0,z.normal.projectPolygon=function(e){var t=!1,r=[e.normal[0],e.normal[1],e.normal[2]];0===r[0]&&0===r[1]&&0===r[2]&&(z.normal.computeNormal_(e,r),t=!0);var n=e.sUnit,i=e.tUnit,a=z.normal.longAxis_(r);if(z.TRUE_PROJECT){z.normal.normalize_(r),n[a]=0,n[(a+1)%3]=z.normal.S_UNIT_X_,n[(a+2)%3]=z.normal.S_UNIT_Y_;var o=z.normal.dot_(n,r);n[0]-=o*r[0],n[1]-=o*r[1],n[2]-=o*r[2],z.normal.normalize_(n),i[0]=r[1]*n[2]-r[2]*n[1],i[1]=r[2]*n[0]-r[0]*n[2],i[2]=r[0]*n[1]-r[1]*n[0],z.normal.normalize_(i)}else n[a]=0,n[(a+1)%3]=z.normal.S_UNIT_X_,n[(a+2)%3]=z.normal.S_UNIT_Y_,i[a]=0,i[(a+1)%3]=r[a]>0?-z.normal.S_UNIT_Y_:z.normal.S_UNIT_Y_,i[(a+2)%3]=r[a]>0?z.normal.S_UNIT_X_:-z.normal.S_UNIT_X_;for(var s=e.mesh.vHead,l=s.next;l!==s;l=l.next)l.s=z.normal.dot_(l.coords,n),l.t=z.normal.dot_(l.coords,i);t&&z.normal.checkOrientation_(e)},z.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},z.normal.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},z.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},z.normal.computeNormal_=function(e,t){var r,n=[-2*z.GLU_TESS_MAX_COORD,-2*z.GLU_TESS_MAX_COORD,-2*z.GLU_TESS_MAX_COORD],i=[2*z.GLU_TESS_MAX_COORD,2*z.GLU_TESS_MAX_COORD,2*z.GLU_TESS_MAX_COORD],a=[],o=[],s=e.mesh.vHead;for(r=s.next;r!==s;r=r.next)for(var l=0;l<3;++l){var c=r.coords[l];c<i[l]&&(i[l]=c,o[l]=r),c>n[l]&&(n[l]=c,a[l]=r)}var u=0;if(n[1]-i[1]>n[0]-i[0]&&(u=1),n[2]-i[2]>n[u]-i[u]&&(u=2),i[u]>=n[u])return t[0]=0,t[1]=0,void(t[2]=1);var h=0,d=o[u],g=a[u],f=[0,0,0],p=[d.coords[0]-g.coords[0],d.coords[1]-g.coords[1],d.coords[2]-g.coords[2]],m=[0,0,0];for(r=s.next;r!==s;r=r.next){m[0]=r.coords[0]-g.coords[0],m[1]=r.coords[1]-g.coords[1],m[2]=r.coords[2]-g.coords[2],f[0]=p[1]*m[2]-p[2]*m[1],f[1]=p[2]*m[0]-p[0]*m[2],f[2]=p[0]*m[1]-p[1]*m[0];var _=f[0]*f[0]+f[1]*f[1]+f[2]*f[2];_>h&&(h=_,t[0]=f[0],t[1]=f[1],t[2]=f[2])}h<=0&&(t[0]=t[1]=t[2]=0,t[z.normal.longAxis_(p)]=1)},z.normal.checkOrientation_=function(e){for(var t=0,r=e.mesh.fHead,n=r.next;n!==r;n=n.next){var i=n.anEdge;if(!(i.winding<=0))do{t+=(i.org.s-i.dst().s)*(i.org.t+i.dst().t),i=i.lNext}while(i!==n.anEdge)}if(t<0){for(var a=e.mesh.vHead,o=a.next;o!==a;o=o.next)o.t=-o.t;e.tUnit[0]=-e.tUnit[0],e.tUnit[1]=-e.tUnit[1],e.tUnit[2]=-e.tUnit[2]}},z.render={},z.render.renderMesh=function(e,t,r){for(var n=!1,i=-1,a=t.fHead.prev;a!==t.fHead;a=a.prev)if(a.inside){n||(e.callBeginOrBeginData(z.primitiveType.GL_TRIANGLES),n=!0);var o=a.anEdge;do{if(r){var s=o.rFace().inside?0:1;i!==s&&(i=s,e.callEdgeFlagOrEdgeFlagData(!!i))}e.callVertexOrVertexData(o.org.data),o=o.lNext}while(o!==a.anEdge)}n&&e.callEndOrEndData()},z.render.renderBoundary=function(e,t){for(var r=t.fHead.next;r!==t.fHead;r=r.next)if(r.inside){e.callBeginOrBeginData(z.primitiveType.GL_LINE_LOOP);var n=r.anEdge;do{e.callVertexOrVertexData(n.org.data),n=n.lNext}while(n!==r.anEdge);e.callEndOrEndData()}},z.sweep={},z.sweep.SENTINEL_COORD_=4*z.GLU_TESS_MAX_COORD,z.sweep.TOLERANCE_NONZERO_=!1,z.sweep.computeInterior=function(e){var t;for(e.fatalError=!1,z.sweep.removeDegenerateEdges_(e),z.sweep.initPriorityQ_(e),z.sweep.initEdgeDict_(e);null!==(t=e.pq.extractMin());){for(;;){var r=e.pq.minimum();if(null===r||!z.geom.vertEq(r,t))break;r=e.pq.extractMin(),z.sweep.spliceMergeVertices_(e,t.anEdge,r.anEdge)}z.sweep.sweepEvent_(e,t)}var n=e.dict.getMin().getKey();e.event=n.eUp.org,z.sweep.doneEdgeDict_(e),z.sweep.donePriorityQ_(e),z.sweep.removeDegenerateFaces_(e.mesh),e.mesh.checkMesh()},z.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},z.sweep.edgeLeq_=function(e,t,r){var n=e.event,i=t.eUp,a=r.eUp;return i.dst()===n?a.dst()===n?z.geom.vertLeq(i.org,a.org)?z.geom.edgeSign(a.dst(),i.org,a.org)<=0:z.geom.edgeSign(i.dst(),a.org,i.org)>=0:z.geom.edgeSign(a.dst(),n,a.org)<=0:a.dst()===n?z.geom.edgeSign(i.dst(),n,i.org)>=0:z.geom.edgeEval(i.dst(),n,i.org)>=z.geom.edgeEval(a.dst(),n,a.org)},z.sweep.deleteRegion_=function(e,t){t.fixUpperEdge,t.eUp.activeRegion=null,e.dict.deleteNode(t.nodeUp),t.nodeUp=null},z.sweep.fixUpperEdge_=function(e,t){z.mesh.deleteEdge(e.eUp),e.fixUpperEdge=!1,e.eUp=t,t.activeRegion=e},z.sweep.topLeftRegion_=function(e){var t=e.eUp.org;do{e=e.regionAbove()}while(e.eUp.org===t);if(e.fixUpperEdge){var r=z.mesh.connect(e.regionBelow().eUp.sym,e.eUp.lNext);z.sweep.fixUpperEdge_(e,r),e=e.regionAbove()}return e},z.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do{e=e.regionAbove()}while(e.eUp.dst()===t);return e},z.sweep.addRegionBelow_=function(e,t,r){var n=new z.ActiveRegion;return n.eUp=r,n.nodeUp=e.dict.insertBefore(t.nodeUp,n),r.activeRegion=n,n},z.sweep.isWindingInside_=function(e,t){switch(e.windingRule){case z.windingRule.GLU_TESS_WINDING_ODD:return 0!==(1&t);case z.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==t;case z.windingRule.GLU_TESS_WINDING_POSITIVE:return t>0;case z.windingRule.GLU_TESS_WINDING_NEGATIVE:return t<0;case z.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return t>=2||t<=-2}return!1},z.sweep.computeWinding_=function(e,t){t.windingNumber=t.regionAbove().windingNumber+t.eUp.winding,t.inside=z.sweep.isWindingInside_(e,t.windingNumber)},z.sweep.finishRegion_=function(e,t){var r=t.eUp,n=r.lFace;n.inside=t.inside,n.anEdge=r,z.sweep.deleteRegion_(e,t)},z.sweep.finishLeftRegions_=function(e,t,r){for(var n=t,i=t.eUp;n!==r;){n.fixUpperEdge=!1;var a=n.regionBelow(),o=a.eUp;if(o.org!==i.org){if(!a.fixUpperEdge){z.sweep.finishRegion_(e,n);break}o=z.mesh.connect(i.lPrev(),o.sym),z.sweep.fixUpperEdge_(a,o)}i.oNext!==o&&(z.mesh.meshSplice(o.oPrev(),o),z.mesh.meshSplice(i,o)),z.sweep.finishRegion_(e,n),i=a.eUp,n=a}return i},z.sweep.addRightEdges_=function(e,t,r,n,i,a){var o=!0,s=r;do{z.sweep.addRegionBelow_(e,t,s.sym),s=s.oNext}while(s!==n);null===i&&(i=t.regionBelow().eUp.rPrev());for(var l,c=t,u=i;(s=(l=c.regionBelow()).eUp.sym).org===u.org;)s.oNext!==u&&(z.mesh.meshSplice(s.oPrev(),s),z.mesh.meshSplice(u.oPrev(),s)),l.windingNumber=c.windingNumber-s.winding,l.inside=z.sweep.isWindingInside_(e,l.windingNumber),c.dirty=!0,!o&&z.sweep.checkForRightSplice_(e,c)&&(z.sweep.addWinding_(s,u),z.sweep.deleteRegion_(e,c),z.mesh.deleteEdge(u)),o=!1,c=l,u=s;c.dirty=!0,a&&z.sweep.walkDirtyRegions_(e,c)},z.sweep.callCombine_=function(e,t,r,n,i){var a=[t.coords[0],t.coords[1],t.coords[2]];t.data=null,t.data=e.callCombineOrCombineData(a,r,n),null===t.data&&(i?e.fatalError||(e.callErrorOrErrorData(z.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),e.fatalError=!0):t.data=r[0])},z.sweep.spliceMergeVertices_=function(e,t,r){var n=[null,null,null,null];n[0]=t.org.data,n[1]=r.org.data,z.sweep.callCombine_(e,t.org,n,[.5,.5,0,0],!1),z.mesh.meshSplice(t,r)},z.sweep.vertexWeights_=function(e,t,r,n,i){var a=z.geom.vertL1dist(t,e),o=z.geom.vertL1dist(r,e),s=i,l=i+1;n[s]=.5*o/(a+o),n[l]=.5*a/(a+o),e.coords[0]+=n[s]*t.coords[0]+n[l]*r.coords[0],e.coords[1]+=n[s]*t.coords[1]+n[l]*r.coords[1],e.coords[2]+=n[s]*t.coords[2]+n[l]*r.coords[2]},z.sweep.getIntersectData_=function(e,t,r,n,i,a){var o=[0,0,0,0],s=[r.data,n.data,i.data,a.data];t.coords[0]=t.coords[1]=t.coords[2]=0,z.sweep.vertexWeights_(t,r,n,o,0),z.sweep.vertexWeights_(t,i,a,o,2),z.sweep.callCombine_(e,t,s,o,!0)},z.sweep.checkForRightSplice_=function(e,t){var r=t.regionBelow(),n=t.eUp,i=r.eUp;if(z.geom.vertLeq(n.org,i.org)){if(z.geom.edgeSign(i.dst(),n.org,i.org)>0)return!1;z.geom.vertEq(n.org,i.org)?n.org!==i.org&&(e.pq.remove(n.org.pqHandle),z.sweep.spliceMergeVertices_(e,i.oPrev(),n)):(z.mesh.splitEdge(i.sym),z.mesh.meshSplice(n,i.oPrev()),t.dirty=r.dirty=!0)}else{if(z.geom.edgeSign(n.dst(),i.org,n.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,z.mesh.splitEdge(n.sym),z.mesh.meshSplice(i.oPrev(),n)}return!0},z.sweep.checkForLeftSplice_=function(e,t){var r,n=t.regionBelow(),i=t.eUp,a=n.eUp;if(z.geom.vertLeq(i.dst(),a.dst())){if(z.geom.edgeSign(i.dst(),a.dst(),i.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,r=z.mesh.splitEdge(i),z.mesh.meshSplice(a.sym,r),r.lFace.inside=t.inside}else{if(z.geom.edgeSign(a.dst(),i.dst(),a.org)>0)return!1;t.dirty=n.dirty=!0,r=z.mesh.splitEdge(a),z.mesh.meshSplice(i.lNext,a.sym),r.rFace().inside=t.inside}return!0},z.sweep.checkForIntersect_=function(e,t){var r=t.regionBelow(),n=t.eUp,i=r.eUp,a=n.org,o=i.org,s=n.dst(),l=i.dst(),c=new z.GluVertex;if(a===o)return!1;if(Math.min(a.t,s.t)>Math.max(o.t,l.t))return!1;if(z.geom.vertLeq(a,o)){if(z.geom.edgeSign(l,a,o)>0)return!1}else if(z.geom.edgeSign(s,o,a)<0)return!1;z.geom.edgeIntersect(s,a,l,o,c),z.geom.vertLeq(c,e.event)&&(c.s=e.event.s,c.t=e.event.t);var u=z.geom.vertLeq(a,o)?a:o;if(z.geom.vertLeq(u,c)&&(c.s=u.s,c.t=u.t),z.geom.vertEq(c,a)||z.geom.vertEq(c,o))return z.sweep.checkForRightSplice_(e,t),!1;if(!z.geom.vertEq(s,e.event)&&z.geom.edgeSign(s,e.event,c)>=0||!z.geom.vertEq(l,e.event)&&z.geom.edgeSign(l,e.event,c)<=0){if(l===e.event)return z.mesh.splitEdge(n.sym),z.mesh.meshSplice(i.sym,n),n=(t=z.sweep.topLeftRegion_(t)).regionBelow().eUp,z.sweep.finishLeftRegions_(e,t.regionBelow(),r),z.sweep.addRightEdges_(e,t,n.oPrev(),n,n,!0),!0;if(s===e.event){z.mesh.splitEdge(i.sym),z.mesh.meshSplice(n.lNext,i.oPrev()),r=t;var h=(t=z.sweep.topRightRegion_(t)).regionBelow().eUp.rPrev();return r.eUp=i.oPrev(),i=z.sweep.finishLeftRegions_(e,r,null),z.sweep.addRightEdges_(e,t,i.oNext,n.rPrev(),h,!0),!0}return z.geom.edgeSign(s,e.event,c)>=0&&(t.regionAbove().dirty=t.dirty=!0,z.mesh.splitEdge(n.sym),n.org.s=e.event.s,n.org.t=e.event.t),z.geom.edgeSign(l,e.event,c)<=0&&(t.dirty=r.dirty=!0,z.mesh.splitEdge(i.sym),i.org.s=e.event.s,i.org.t=e.event.t),!1}return z.mesh.splitEdge(n.sym),z.mesh.splitEdge(i.sym),z.mesh.meshSplice(i.oPrev(),n),n.org.s=c.s,n.org.t=c.t,n.org.pqHandle=e.pq.insert(n.org),z.sweep.getIntersectData_(e,n.org,a,s,o,l),t.regionAbove().dirty=t.dirty=r.dirty=!0,!1},z.sweep.walkDirtyRegions_=function(e,t){for(var r=t.regionBelow();;){for(;r.dirty;)t=r,r=r.regionBelow();if(!t.dirty&&(r=t,null===(t=t.regionAbove())||!t.dirty))return;t.dirty=!1;var n=t.eUp,i=r.eUp;if(n.dst()!==i.dst()&&z.sweep.checkForLeftSplice_(e,t)&&(r.fixUpperEdge?(z.sweep.deleteRegion_(e,r),z.mesh.deleteEdge(i),i=(r=t.regionBelow()).eUp):t.fixUpperEdge&&(z.sweep.deleteRegion_(e,t),z.mesh.deleteEdge(n),n=(t=r.regionAbove()).eUp)),n.org!==i.org)if(n.dst()===i.dst()||t.fixUpperEdge||r.fixUpperEdge||n.dst()!==e.event&&i.dst()!==e.event)z.sweep.checkForRightSplice_(e,t);else if(z.sweep.checkForIntersect_(e,t))return;n.org===i.org&&n.dst()===i.dst()&&(z.sweep.addWinding_(i,n),z.sweep.deleteRegion_(e,t),z.mesh.deleteEdge(n),t=r.regionAbove())}},z.sweep.connectRightVertex_=function(e,t,r){var n,i=r.oNext,a=t.regionBelow(),o=t.eUp,s=a.eUp,l=!1;(o.dst()!==s.dst()&&z.sweep.checkForIntersect_(e,t),z.geom.vertEq(o.org,e.event)&&(z.mesh.meshSplice(i.oPrev(),o),i=(t=z.sweep.topLeftRegion_(t)).regionBelow().eUp,z.sweep.finishLeftRegions_(e,t.regionBelow(),a),l=!0),z.geom.vertEq(s.org,e.event)&&(z.mesh.meshSplice(r,s.oPrev()),r=z.sweep.finishLeftRegions_(e,a,null),l=!0),l)?z.sweep.addRightEdges_(e,t,r.oNext,i,i,!0):(n=z.geom.vertLeq(s.org,o.org)?s.oPrev():o,n=z.mesh.connect(r.lPrev(),n),z.sweep.addRightEdges_(e,t,n,n.oNext,n.oNext,!1),n.sym.activeRegion.fixUpperEdge=!0,z.sweep.walkDirtyRegions_(e,t))},z.sweep.connectLeftDegenerate_=function(e,t,r){var n=t.eUp;if(z.geom.vertEq(n.org,r))z.sweep.TOLERANCE_NONZERO_&&z.sweep.spliceMergeVertices_(e,n,r.anEdge);else{if(!z.geom.vertEq(n.dst(),r))return z.mesh.splitEdge(n.sym),t.fixUpperEdge&&(z.mesh.deleteEdge(n.oNext),t.fixUpperEdge=!1),z.mesh.meshSplice(r.anEdge,n),void z.sweep.sweepEvent_(e,r);if(z.sweep.TOLERANCE_NONZERO_){var i=(t=z.sweep.topRightRegion_(t)).regionBelow(),a=i.eUp.sym,o=a.oNext,s=o;i.fixUpperEdge&&(z.sweep.deleteRegion_(e,i),z.mesh.deleteEdge(a),a=o.oPrev()),z.mesh.meshSplice(r.anEdge,a),z.geom.edgeGoesLeft(o)||(o=null),z.sweep.addRightEdges_(e,t,a.oNext,s,o,!0)}}},z.sweep.connectLeftVertex_=function(e,t){var r=new z.ActiveRegion;r.eUp=t.anEdge.sym;var n=e.dict.search(r).getKey(),i=n.regionBelow(),a=n.eUp,o=i.eUp;if(0!==z.geom.edgeSign(a.dst(),t,a.org)){var s,l=z.geom.vertLeq(o.dst(),a.dst())?n:i;if(n.inside||l.fixUpperEdge){if(l===n)s=z.mesh.connect(t.anEdge.sym,a.lNext);else s=z.mesh.connect(o.dNext(),t.anEdge).sym;l.fixUpperEdge?z.sweep.fixUpperEdge_(l,s):z.sweep.computeWinding_(e,z.sweep.addRegionBelow_(e,n,s)),z.sweep.sweepEvent_(e,t)}else z.sweep.addRightEdges_(e,n,t.anEdge,t.anEdge,null,!0)}else z.sweep.connectLeftDegenerate_(e,n,t)},z.sweep.sweepEvent_=function(e,t){e.event=t;for(var r=t.anEdge;null===r.activeRegion;)if((r=r.oNext)===t.anEdge)return void z.sweep.connectLeftVertex_(e,t);var n=z.sweep.topLeftRegion_(r.activeRegion),i=n.regionBelow(),a=i.eUp,o=z.sweep.finishLeftRegions_(e,i,null);o.oNext===a?z.sweep.connectRightVertex_(e,n,o):z.sweep.addRightEdges_(e,n,o.oNext,a,a,!0)},z.sweep.addSentinel_=function(e,t){var r=new z.ActiveRegion,n=z.mesh.makeEdge(e.mesh);n.org.s=z.sweep.SENTINEL_COORD_,n.org.t=t,n.dst().s=-z.sweep.SENTINEL_COORD_,n.dst().t=t,e.event=n.dst(),r.eUp=n,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=e.dict.insert(r)},z.sweep.initEdgeDict_=function(e){e.dict=new z.Dict(e,z.sweep.edgeLeq_),z.sweep.addSentinel_(e,-z.sweep.SENTINEL_COORD_),z.sweep.addSentinel_(e,z.sweep.SENTINEL_COORD_)},z.sweep.doneEdgeDict_=function(e){for(var t;null!==(t=e.dict.getMin().getKey());)t.sentinel,z.sweep.deleteRegion_(e,t);e.dict=null},z.sweep.removeDegenerateEdges_=function(e){for(var t,r=e.mesh.eHead,n=r.next;n!==r;n=t){t=n.next;var i=n.lNext;z.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(z.sweep.spliceMergeVertices_(e,i,n),z.mesh.deleteEdge(n),i=(n=i).lNext),i.lNext===n&&(i!==n&&(i!==t&&i!==t.sym||(t=t.next),z.mesh.deleteEdge(i)),n!==t&&n!==t.sym||(t=t.next),z.mesh.deleteEdge(n))}},z.sweep.initPriorityQ_=function(e){var t=new z.PriorityQ(z.geom.vertLeq);e.pq=t;var r,n=e.mesh.vHead;for(r=n.next;r!==n;r=r.next)r.pqHandle=t.insert(r);t.init()},z.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},z.sweep.removeDegenerateFaces_=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t){t=r.next;var n=r.anEdge;n.lNext.lNext===n&&(z.sweep.addWinding_(n.oNext,n),z.mesh.deleteEdge(n))}},z.tessmono={},z.tessmono.tessellateMonoRegion_=function(e){for(var t=e.anEdge;z.geom.vertLeq(t.dst(),t.org);t=t.lPrev());for(;z.geom.vertLeq(t.org,t.dst());t=t.lNext);for(var r,n=t.lPrev();t.lNext!==n;)if(z.geom.vertLeq(t.dst(),n.org)){for(;n.lNext!==t&&(z.geom.edgeGoesLeft(n.lNext)||z.geom.edgeSign(n.org,n.dst(),n.lNext.dst())<=0);)n=(r=z.mesh.connect(n.lNext,n)).sym;n=n.lPrev()}else{for(;n.lNext!==t&&(z.geom.edgeGoesRight(t.lPrev())||z.geom.edgeSign(t.dst(),t.org,t.lPrev().org)>=0);)r=z.mesh.connect(t,t.lPrev()),t=r.sym;t=t.lNext}for(;n.lNext.lNext!==t;)n=(r=z.mesh.connect(n.lNext,n)).sym},z.tessmono.tessellateInterior=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)t=r.next,r.inside&&z.tessmono.tessellateMonoRegion_(r)},z.tessmono.discardExterior=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)t=r.next,r.inside||z.mesh.zapFace(r)},z.tessmono.setWindingNumber=function(e,t,r){for(var n,i=e.eHead.next;i!==e.eHead;i=n)n=i.next,i.rFace().inside!==i.lFace.inside?i.winding=i.lFace.inside?t:-t:r?z.mesh.deleteEdge(i):i.winding=0},z.Dict=function(e,t){this.head_=new z.DictNode,this.frame_=e,this.leq_=t},z.Dict.prototype.deleteDict_=function(){},z.Dict.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq_(this.frame_,e.key,t));var r=new z.DictNode(t,e.next,e);return e.next.prev=r,e.next=r,r},z.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},z.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},z.Dict.prototype.search=function(e){var t=this.head_;do{t=t.next}while(null!==t.key&&!this.leq_(this.frame_,e,t.key));return t},z.Dict.prototype.getMin=function(){return this.head_.next},z.Dict.prototype.getMax=function(){return this.head_.prev},z.DictNode=function(e,t,r){this.key=e||null,this.next=t||this,this.prev=r||this},z.DictNode.prototype.getKey=function(){return this.key},z.DictNode.prototype.getSuccessor=function(){return this.next},z.DictNode.prototype.getPredecessor=function(){return this.prev},z.CachedVertex=function(){this.coords=[0,0,0],this.data=null},z.GluTesselator=function(){this.state=z.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.callError_=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.relTolerance=z.GLU_TESS_DEFAULT_TOLERANCE,this.windingRule=z.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.callCombine_=null,this.boundaryOnly=!1,this.callBegin_=null,this.callEdgeFlag_=null,this.callVertex_=null,this.callEnd_=null,this.callMesh_=null,this.callBeginData_=null,this.callEdgeFlagData_=null,this.callVertexData_=null,this.callEndData_=null,this.callErrorData_=null,this.callCombineData_=null,this.polygonData_=null,this.emptyCache=!1,this.cacheCount=0,this.cache=new Array(z.TESS_MAX_CACHE);for(var e=0;e<z.TESS_MAX_CACHE;e++)this.cache[e]=new z.CachedVertex},z.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},z.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(z.GluTesselator.tessState_.T_DORMANT)},z.GluTesselator.prototype.gluTessProperty=function(e,t){switch(e){case z.gluEnum.GLU_TESS_TOLERANCE:if(t<0||t>1)break;return void(this.relTolerance=t);case z.gluEnum.GLU_TESS_WINDING_RULE:var r=t;switch(r){case z.windingRule.GLU_TESS_WINDING_ODD:case z.windingRule.GLU_TESS_WINDING_NONZERO:case z.windingRule.GLU_TESS_WINDING_POSITIVE:case z.windingRule.GLU_TESS_WINDING_NEGATIVE:case z.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=r)}break;case z.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly=!!t);default:return void this.callErrorOrErrorData(z.gluEnum.GLU_INVALID_ENUM)}this.callErrorOrErrorData(z.gluEnum.GLU_INVALID_VALUE)},z.GluTesselator.prototype.gluGetTessProperty=function(e){switch(e){case z.gluEnum.GLU_TESS_TOLERANCE:return this.relTolerance;case z.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case z.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly;default:this.callErrorOrErrorData(z.gluEnum.GLU_INVALID_ENUM)}return!1},z.GluTesselator.prototype.gluTessNormal=function(e,t,r){this.normal[0]=e,this.normal[1]=t,this.normal[2]=r},z.GluTesselator.prototype.gluTessCallback=function(e,t){var r=t||null;switch(e){case z.gluEnum.GLU_TESS_BEGIN:return void(this.callBegin_=r);case z.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.callBeginData_=r);case z.gluEnum.GLU_TESS_EDGE_FLAG:return void(this.callEdgeFlag_=r);case z.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.callEdgeFlagData_=r);case z.gluEnum.GLU_TESS_VERTEX:return void(this.callVertex_=r);case z.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.callVertexData_=r);case z.gluEnum.GLU_TESS_END:return void(this.callEnd_=r);case z.gluEnum.GLU_TESS_END_DATA:return void(this.callEndData_=r);case z.gluEnum.GLU_TESS_ERROR:return void(this.callError_=r);case z.gluEnum.GLU_TESS_ERROR_DATA:return void(this.callErrorData_=r);case z.gluEnum.GLU_TESS_COMBINE:return void(this.callCombine_=r);case z.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.callCombineData_=r);case z.gluEnum.GLU_TESS_MESH:return void(this.callMesh_=r);default:return void this.callErrorOrErrorData(z.gluEnum.GLU_INVALID_ENUM)}},z.GluTesselator.prototype.gluTessVertex=function(e,t){var r=!1,n=[0,0,0];this.requireState_(z.GluTesselator.tessState_.T_IN_CONTOUR),this.emptyCache&&(this.emptyCache_(),this.lastEdge_=null);for(var i=0;i<3;++i){var a=e[i];a<-z.GLU_TESS_MAX_COORD&&(a=-z.GLU_TESS_MAX_COORD,r=!0),a>z.GLU_TESS_MAX_COORD&&(a=z.GLU_TESS_MAX_COORD,r=!0),n[i]=a}if(r&&this.callErrorOrErrorData(z.errorType.GLU_TESS_COORD_TOO_LARGE),null===this.mesh){if(this.cacheCount<z.TESS_MAX_CACHE)return void this.cacheVertex_(n,t);this.emptyCache_()}this.addVertex_(n,t)},z.GluTesselator.prototype.gluTessBeginPolygon=function(e){this.requireState_(z.GluTesselator.tessState_.T_DORMANT),this.state=z.GluTesselator.tessState_.T_IN_POLYGON,this.cacheCount=0,this.emptyCache=!1,this.mesh=null,this.polygonData_=e},z.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(z.GluTesselator.tessState_.T_IN_POLYGON),this.state=z.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null,this.cacheCount>0&&(this.emptyCache=!0)},z.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(z.GluTesselator.tessState_.T_IN_CONTOUR),this.state=z.GluTesselator.tessState_.T_IN_POLYGON},z.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(z.GluTesselator.tessState_.T_IN_POLYGON),this.state=z.GluTesselator.tessState_.T_DORMANT,null===this.mesh&&this.emptyCache_(),z.normal.projectPolygon(this),z.sweep.computeInterior(this),!this.fatalError){var e=this.mesh;if(this.boundaryOnly?z.tessmono.setWindingNumber(e,1,!0):z.tessmono.tessellateInterior(e),this.mesh.checkMesh(),this.callBegin_||this.callEnd_||this.callVertex_||this.callEdgeFlag_||this.callBeginData_||this.callEndData_||this.callVertexData_||this.callEdgeFlagData_)if(this.boundaryOnly)z.render.renderBoundary(this,this.mesh);else{var t=!(!this.callEdgeFlag_&&!this.callEdgeFlagData_);z.render.renderMesh(this,this.mesh,t)}if(this.callMesh_)return z.tessmono.discardExterior(this.mesh),this.callMesh_(this.mesh),this.mesh=null,void(this.polygonData_=null)}z.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},z.GluTesselator.prototype.makeDormant_=function(){this.mesh&&z.mesh.deleteMesh(this.mesh),this.state=z.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null},z.GluTesselator.prototype.requireState_=function(e){this.state!==e&&this.gotoState_(e)},z.GluTesselator.prototype.gotoState_=function(e){for(;this.state!==e;)if(this.state<e)switch(this.state){case z.GluTesselator.tessState_.T_DORMANT:this.callErrorOrErrorData(z.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case z.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(z.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state){case z.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorOrErrorData(z.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case z.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(z.errorType.GLU_TESS_MISSING_END_POLYGON),this.makeDormant_()}},z.GluTesselator.prototype.addVertex_=function(e,t){var r=this.lastEdge_;null===r?(r=z.mesh.makeEdge(this.mesh),z.mesh.meshSplice(r,r.sym)):(z.mesh.splitEdge(r),r=r.lNext),r.org.data=t,r.org.coords[0]=e[0],r.org.coords[1]=e[1],r.org.coords[2]=e[2],r.winding=1,r.sym.winding=-1,this.lastEdge_=r},z.GluTesselator.prototype.cacheVertex_=function(e,t){var r=this.cache[this.cacheCount];r.data=t,r.coords[0]=e[0],r.coords[1]=e[1],r.coords[2]=e[2],++this.cacheCount},z.GluTesselator.prototype.emptyCache_=function(){this.mesh=new z.GluMesh;for(var e=0;e<this.cacheCount;e++){var t=this.cache[e];this.addVertex_(t.coords,t.data)}this.cacheCount=0,this.emptyCache=!1},z.GluTesselator.prototype.callBeginOrBeginData=function(e){this.callBeginData_?this.callBeginData_(e,this.polygonData_):this.callBegin_&&this.callBegin_(e)},z.GluTesselator.prototype.callVertexOrVertexData=function(e){this.callVertexData_?this.callVertexData_(e,this.polygonData_):this.callVertex_&&this.callVertex_(e)},z.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData=function(e){this.callEdgeFlagData_?this.callEdgeFlagData_(e,this.polygonData_):this.callEdgeFlag_&&this.callEdgeFlag_(e)},z.GluTesselator.prototype.callEndOrEndData=function(){this.callEndData_?this.callEndData_(this.polygonData_):this.callEnd_&&this.callEnd_()},z.GluTesselator.prototype.callCombineOrCombineData=function(e,t,r){var n;return this.callCombineData_?n=this.callCombineData_(e,t,r,this.polygonData_):this.callCombine_&&(n=this.callCombine_(e,t,r)),void 0===n&&(n=null),n},z.GluTesselator.prototype.callErrorOrErrorData=function(e){this.callErrorData_?this.callErrorData_(e,this.polygonData_):this.callError_&&this.callError_(e)},z.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.inside=!1},z.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},z.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},z.GluHalfEdge.prototype.dst=function(){return this.sym.org},z.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},z.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},z.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},z.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},z.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},z.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},z.GluMesh=function(){this.vHead=new z.GluVertex,this.fHead=new z.GluFace,this.eHead=new z.GluHalfEdge,this.eHeadSym=new z.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},z.GluMesh.prototype.checkMesh=function(){if(z.DEBUG){var e,t,r,n=this.fHead,i=this.vHead,a=this.eHead,o=n;for(o=n;(t=o.next)!==n;o=t){e=t.anEdge;do{e=e.lNext}while(e!==t.anEdge)}var s=i;for(s=i;(r=s.next)!==i;s=r){e=r.anEdge;do{e=e.oNext}while(e!==r.anEdge)}var l=a;for(l=a;(e=l.next)!==a;l=e);}},z.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=null},z.PQHandleElem=function(){this.key=null,this.node=0},z.PQHandleElem.realloc=function(e,t){var r=new Array(t),n=0;if(null!==e)for(;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=new z.PQHandleElem;return r},z.PQNode=function(){this.handle=0},z.PQNode.realloc=function(e,t){var r=new Array(t),n=0;if(null!==e)for(;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=new z.PQNode;return r},z.PriorityQ=function(e){this.keys_=z.PriorityQ.prototype.PQKeyRealloc_(null,z.PriorityQ.INIT_SIZE_),this.order_=null,this.size_=0,this.max_=z.PriorityQ.INIT_SIZE_,this.initialized_=!1,this.leq_=e,this.heap_=new z.PriorityQHeap(this.leq_)},z.PriorityQ.INIT_SIZE_=32,z.PriorityQ.prototype.deleteQ=function(){this.heap_.deleteHeap(),this.heap_=null,this.order_=null,this.keys_=null},z.PriorityQ.prototype.init=function(){this.order_=[];for(var e=0;e<this.size_;e++)this.order_[e]=e;var t,r,n=(t=this.keys_,r=this.leq_,function(e,n){return r(t[e],t[n])?1:-1});if(this.order_.sort(n),this.max_=this.size_,this.initialized_=!0,this.heap_.init(),z.DEBUG){var i=0+this.size_-1;for(e=0;e<i;++e);}},z.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_;return++this.size_>=this.max_&&(this.max_*=2,this.keys_=z.PriorityQ.prototype.PQKeyRealloc_(this.keys_,this.max_)),this.keys_[t]=e,-(t+1)},z.PriorityQ.prototype.PQKeyRealloc_=function(e,t){var r=new Array(t),n=0;if(null!==e)for(;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=null;return r},z.PriorityQ.prototype.keyLessThan_=function(e,t){var r=this.keys_[e],n=this.keys_[t];return!this.leq_(n,r)},z.PriorityQ.prototype.keyGreaterThan_=function(e,t){var r=this.keys_[e],n=this.keys_[t];return!this.leq_(r,n)},z.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var e=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(this.leq_(t,e))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.keys_[this.order_[this.size_-1]]);return e},z.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var e=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(this.leq_(t,e))return t}return e},z.PriorityQ.prototype.isEmpty_=function(){return 0===this.size_&&this.heap_.isEmpty()},z.PriorityQ.prototype.remove=function(e){if(e>=0)this.heap_.remove(e);else for(e=-(e+1),this.keys_[e]=null;this.size_>0&&null===this.keys_[this.order_[this.size_-1]];)--this.size_},z.PriorityQHeap=function(e){this.nodes_=z.PQNode.realloc(null,z.PriorityQHeap.INIT_SIZE_+1),this.handles_=z.PQHandleElem.realloc(null,z.PriorityQHeap.INIT_SIZE_+1),this.size_=0,this.max_=z.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.leq_=e,this.nodes_[1].handle=1},z.PriorityQHeap.INIT_SIZE_=32,z.PriorityQHeap.prototype.deleteHeap=function(){this.handles_=null,this.nodes_=null},z.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},z.PriorityQHeap.prototype.insert=function(e){var t,r=++this.size_;return 2*r>this.max_&&(this.max_*=2,this.nodes_=z.PQNode.realloc(this.nodes_,this.max_+1),this.handles_=z.PQHandleElem.realloc(this.handles_,this.max_+1)),0===this.freeList_?t=r:(t=this.freeList_,this.freeList_=this.handles_[t].node),this.nodes_[r].handle=t,this.handles_[t].node=r,this.handles_[t].key=e,this.initialized_&&this.floatUp_(r),t},z.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},z.PriorityQHeap.prototype.minimum=function(){return this.handles_[this.nodes_[1].handle].key},z.PriorityQHeap.prototype.extractMin=function(){var e=this.nodes_,t=this.handles_,r=e[1].handle,n=t[r].key;return this.size_>0&&(e[1].handle=e[this.size_].handle,t[e[1].handle].node=1,t[r].key=null,t[r].node=this.freeList_,this.freeList_=r,--this.size_>0&&this.floatDown_(1)),n},z.PriorityQHeap.prototype.remove=function(e){var t=this.nodes_,r=this.handles_,n=r[e].node;t[n].handle=t[this.size_].handle,r[t[n].handle].node=n,n<=--this.size_&&(n<=1||this.leq_(r[t[n>>1].handle].key,r[t[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),r[e].key=null,r[e].node=this.freeList_,this.freeList_=e},z.PriorityQHeap.prototype.floatDown_=function(e){for(var t=this.nodes_,r=this.handles_,n=t[e].handle;;){var i=e<<1;i<this.size_&&this.leq_(r[t[i+1].handle].key,r[t[i].handle].key)&&++i;var a=t[i].handle;if(i>this.size_||this.leq_(r[n].key,r[a].key)){t[e].handle=n,r[n].node=e;break}t[e].handle=a,r[a].node=e,e=i}},z.PriorityQHeap.prototype.floatUp_=function(e){for(var t=this.nodes_,r=this.handles_,n=t[e].handle;;){var i=e>>1,a=t[i].handle;if(0===i||this.leq_(r[a].key,r[n].key)){t[e].handle=n,r[n].node=e;break}t[e].handle=a,r[a].node=e,e=i}},z.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},z.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},z.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};var q=z,W=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e){var n;Object(A.a)(this,r);return(n=t.call(this,e,"attribute vec3 a_position;\nuniform vec2 u_resolution;\nvoid main() {\n   vec2 zeroToOne = a_position.xy / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n   gl_Position = vec4(clipSpace, 0, 1);\n}","precision mediump float;\nuniform vec4 color;\nvoid main() {\n   gl_FragColor = color;\n}",["a_position"])).resolutionLocation=n.uniformLocation(e,"u_resolution"),n.colorLocation=n.uniformLocation(e,"color"),n.localCache={resolution:{width:null,height:null},color:{r:null,g:null,b:null,a:null}},n}return Object(j.a)(r,[{key:"loadResolution",value:function(e,t,r){this.localCache.resolution.width===t&&this.localCache.resolution.height===r||(e.uniform2f(this.resolutionLocation,t,r),this.localCache.resolution.width=t,this.localCache.resolution.height=r)}},{key:"loadColor",value:function(e,t){var r=this.localCache.color;if(r.r!==t.red||r.g!==t.green||r.b!==t.blue||r.a!==t.alpha){var n=t.alpha;e.uniform4f(this.colorLocation,t.red*n,t.green*n,t.blue*n,t.alpha),r.r=t.red,r.g=t.green,r.b=t.blue,r.a=t.alpha}}}]),r}(f.a.GpuProgram);W.key="WorldWindGpuScreenColorProgram";var K=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e){var n;Object(A.a)(this,r);return(n=t.call(this,e,"attribute vec3 a_position;\nattribute vec2 vertexTexCoord;\nuniform vec2 u_resolution;\nvarying vec2 texCoord;\nvoid main() {\n   vec2 zeroToOne = a_position.xy / u_resolution;\n   vec2 zeroToTwo = zeroToOne * 2.0;\n   vec2 clipSpace = zeroToTwo - 1.0;\n   gl_Position = vec4(clipSpace, 0, 1);\n   gl_PointSize = 3.0;\n   texCoord = vertexTexCoord;\n}","precision mediump float;\nuniform sampler2D textureSampler;\nvarying vec2 texCoord;\nvoid main() {\n   gl_FragColor = texture2D(textureSampler, texCoord);\n}",["a_position","vertexTexCoord"])).resolutionLocation=n.uniformLocation(e,"u_resolution"),n.texUnitLocation=n.uniformLocation(e,"textureSampler"),n.localCache={resolution:{width:null,height:null},textureUnit:null},n}return Object(j.a)(r,[{key:"loadResolution",value:function(e,t,r){this.localCache.resolution.width===t&&this.localCache.resolution.height===r||(e.uniform2f(this.resolutionLocation,t,r),this.localCache.resolution.width=t,this.localCache.resolution.height=r)}},{key:"loadTextureUnit",value:function(e,t){this.localCache.textureUnit!==t&&(e.uniform1i(this.texUnitLocation,t-e.TEXTURE0),this.localCache.textureUnit=t)}}]),r}(f.a.GpuProgram);K.key="WorldWindGpuScreenTextureProgram";var H=f.a.Angle,Y=f.a.SurfaceShape,X=f.a.PickedObject,Q=f.a.Texture,Z=f.a.Location,J=6378137,$=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,e))._image=null,n._imageUUID="",n._interiorVboCacheKey="",n._outlineVboCacheKey="",n._contoursPrepered=!1,n._contoursInfo=[],n._id=r.nextId(),n}return Object(j.a)(r,[{key:"image",get:function(){return this._image},set:function(e){this._image=e,this.stateKeyInvalid=!0}},{key:"imageUUID",get:function(){return this._imageUUID},set:function(e){this._imageUUID=e}},{key:"renderToTexture",value:function(e,t,r,n,i,a){var o=this._highlighted&&this._highlightAttributes||this._attributes,s=!this._isInteriorInhibited&&o.drawInterior,l=o.drawOutline&&o.outlineWidth>0;if(s||l){e.pickingMode&&!this.pickColor&&(this.pickColor=e.uniquePickColor());var c,u=this.mapGeometry(this._interiorGeometry,r,n,i,a);for(c=0;c<u.length;c++){if(!this._contoursPrepered){var h=this.windingOrder_all(u[c]);this._contoursInfo.push({wo:h})}var d=u[c];d[0]===d[d.length-2]&&d[1]===d[d.length-1]&&(d.pop(),d.pop())}if(!this._image||e.pickingMode||this.crossesAntiMeridian||this.containsPole)this.renderColor(e,{tileWidth:256,tileHeight:256,xScale:r,yScale:n,dx:i,dy:a,drawInterior:s,interiorColor:o.interiorColor,drawOutline:l,outlineColor:o.outlineColor}),this._contoursPrepered=!0;else{if(!this._contoursPrepered&&1===u.length){var g=this.getCorners(u[0],this._contoursInfo[0].wo),f=g.anglesMap,p=g.topLeftIndex,m=this.computeUvs(this._contoursInfo[0].wo,f,p,this._interiorGeometry[0]);this._contoursInfo[0].anglesMap=f,this._contoursInfo[0].topLeftIndex=p,this._contoursInfo[0].uvs=m;var _=this.tessellate_p1(u[0],m),v=[];for(c=0;c<_.length;c+=5)for(var b=_[c],E=_[c+1],y=0;y<u[0].length;y+=2){var x=u[0][y],S=u[0][y+1];if(x===b&&S===E){v.push(y/2);break}}this._contoursInfo[0].iboData=new Uint16Array(v);var w=5*Math.floor(u[0].length/2);this._contoursInfo[0].vboData=new Float32Array(w);var T=this._contoursInfo[0].vboData,O=0;for(c=0;c<T.length;c+=5)T[c]=u[O],T[c+1]=u[O+1],T[c+2]=0,T[c+3]=m[O],T[c+4]=m[O+1],O+=2;this._contoursPrepered=!0}this.renderTexture(e,{points:u[0],tileWidth:256,tileHeight:256,xScale:r,yScale:n,dx:i,dy:a})}if(e.pickingMode){var R=new X(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);e.resolvePick(R)}}}},{key:"renderColor",value:function(e,t){var r=t.tileWidth,n=t.tileHeight,i=t.xScale,a=t.yScale,o=t.dx,s=t.dy,l=t.drawInterior,c=t.interiorColor;if(this.tessGeom||(this.tessGeom=this.tessellate(this._interiorGeometry),this.tessTris=new Float32Array(this.tessGeom.length)),!this.wo){var u=this.mapGeometry(this._interiorGeometry,i,a,o,s);this.wo=this.windingOrder_all(u[0])}var h=e.currentGlContext,d=e.findAndBindProgram(W);if(d.loadResolution(h,r,n),h.enableVertexAttribArray(0),l){d.loadColor(h,e.pickingMode?this.pickColor:c);for(var g=0;g<this.tessGeom.length;g+=3){var f=this.tessGeom[g],p=this.tessGeom[g+1];this.tessTris[g]=f*H.RADIANS_TO_DEGREES*i+o,this.tessTris[g+1]=p*H.RADIANS_TO_DEGREES*a+s,this.tessTris[g+2]=0}this.bindInteriorVbo(e,this.tessTris,null),h.vertexAttribPointer(0,3,h.FLOAT,!1,0,0),"CW"===this.wo&&h.frontFace(h.CW),h.drawArrays(h.TRIANGLES,0,Math.floor(this.tessTris.length/3)),"CW"===this.wo&&h.frontFace(h.CCW)}}},{key:"renderTexture",value:function(e,t){for(var r=t.points,n=t.tileWidth,i=t.tileHeight,a=(t.xScale,t.yScale,t.dx,t.dy,t.anglesMap,t.topLeftIndex,this._contoursInfo[0].vboData),o=0,s=0;s<a.length;s+=5)a[s]=r[o],a[s+1]=r[o+1],o+=2;var l=e.currentGlContext,c=e.findAndBindProgram(K);c.loadResolution(l,n,i),l.enableVertexAttribArray(0),l.enableVertexAttribArray(1),c.loadTextureUnit(l,l.TEXTURE0);var u=this._imageUUID||this._image.src;u||console.error("TexturedSurfaceShape, no uuid for image. Use shape.imageUUID to set a unique id");var h=e.gpuResourceCache.resourceForKey(u);h||(h=new Q(l,this._image,null,!0),e.gpuResourceCache.putResource(u,h,h.size)),h.bind(e),this.bindInteriorVbo(e,a,null),this.bindInteriorIbo(e,this._contoursInfo[0].iboData,null);l.vertexAttribPointer(0,3,l.FLOAT,!1,20,0),l.vertexAttribPointer(1,2,l.FLOAT,!1,20,12),"CW"===this._contoursInfo[0].wo&&l.frontFace(l.CW),l.drawElements(l.TRIANGLES,this._contoursInfo[0].iboData.length,l.UNSIGNED_SHORT,0),"CW"===this._contoursInfo[0].wo&&l.frontFace(l.CCW),l.disableVertexAttribArray(1)}},{key:"computeUvs",value:function(e,t,r,n){var i=n.slice();i.pop();for(var a=new Float32Array(2*i.length),o="",s=r;s<i.length+r;s++){var l=s%i.length,c={s:-1,t:-1};if(t[l]){o=this.nextSide(o,e);for(var u=i[l],h=null,d=s+1;d<i.length+r;d++){var g=d%i.length;if(null!=t[g]){h=i[g];break}}h||(h=i[r]);var f=Z.greatCircleDistance(u,h)*J}var p=Z.greatCircleDistance(u,i[l])*J;"CW"===e?"top"===o?(c.s=p/f,c.t=0):"right"===o?(c.s=1,c.t=p/f):"bottom"===o?(c.s=1-p/f,c.t=1):"left"===o&&(c.s=0,c.t=1-p/f):"left"===o?(c.s=0,c.t=p/f):"bottom"===o?(c.s=p/f,c.t=1):"right"===o?(c.s=1,c.t=1-p/f):"top"===o&&(c.s=1-p/f,c.t=0),a[2*l]=c.s,a[2*l+1]=c.t}return a}},{key:"nextSide",value:function(e,t){var r="";return"CW"===t?(r="top","top"===e?r="right":"right"===e?r="bottom":"bottom"===e?r="left":"left"===e&&(r="top")):(r="left","left"===e?r="bottom":"bottom"===e?r="right":"right"===e?r="top":"top"===e&&(r="left")),r}},{key:"mapGeometry",value:function(e,t,r,n,i){return e.map((function(e){return e.reduce((function(e,a){var o=a.longitude*t+n,s=a.latitude*r+i;return e.push(o,s),e}),[])}))}},{key:"bindInteriorVbo",value:function(e,t,r){r=r||e.currentGlContext.STATIC_DRAW,this._interiorVboCacheKey||(this._interiorVboCacheKey=e.gpuResourceCache.generateCacheKey()),this.bindVbo(e,t,r,this._interiorVboCacheKey)}},{key:"bindOutlineVbo",value:function(e,t,r){r=r||e.currentGlContext.STATIC_DRAW,this._outlineVboCacheKey||(this._outlineVboCacheKey=e.gpuResourceCache.generateCacheKey()),this.bindVbo(e,t,r,this._outlineVboCacheKey)}},{key:"bindVbo",value:function(e,t,r,n){var i=e.currentGlContext,a=e.gpuResourceCache.resourceForKey(n),o=e.gpuResourceCache.entries.entries[n],s=0;o&&(s=o.size),!a||s<t.length*t.BYTES_PER_ELEMENT?(a=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferData(i.ARRAY_BUFFER,t,r),e.gpuResourceCache.putResource(n,a,t.length*t.BYTES_PER_ELEMENT)):(i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferSubData(i.ARRAY_BUFFER,0,t))}},{key:"bindInteriorIbo",value:function(e,t,r){r=r||e.currentGlContext.STATIC_DRAW,this._interiorIboCacheKey||(this._interiorIboCacheKey=e.gpuResourceCache.generateCacheKey()),this.bindIbo(e,t,r,this._interiorIboCacheKey)}},{key:"bindIbo",value:function(e,t,r,n){var i=e.currentGlContext,a=e.gpuResourceCache.resourceForKey(n),o=e.gpuResourceCache.entries.entries[n],s=0;o&&(s=o.size),!a||s<t.length*t.BYTES_PER_ELEMENT?(a=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,a),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t,r),e.gpuResourceCache.putResource(n,a,t.length*t.BYTES_PER_ELEMENT)):i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,a)}},{key:"tessellate_p",value:function(e,t){var n=r.tesselator(),i=[];n.gluTessCallback(q.gluEnum.GLU_TESS_BEGIN,(function(e){e!==q.primitiveType.GL_TRIANGLES&&console.error("Tessellation error, primitive is not TRIANGLES.")})),n.gluTessCallback(q.gluEnum.GLU_TESS_COMBINE,(function(e,r,n){var i=[e[0],e[1],e[2]];if(t&&t.length)for(var a=3;a<=4;a++){for(var o=0,s=0;s<4;s++)n[s]>0&&(o+=n[s]*r[s][a]);i[a]=o}return i})),n.gluTessCallback(q.gluEnum.GLU_TESS_EDGE_FLAG,(function(){})),n.gluTessCallback(q.gluEnum.GLU_TESS_VERTEX_DATA,(function(e,r){r.push(e[0]),r.push(e[1]),r.push(e[2]),t&&t.length&&(r.push(e[3]),r.push(e[4]))})),n.gluTessCallback(q.gluEnum.GLU_TESS_ERROR,(function(e){console.error("tess err",e)})),n.gluTessBeginPolygon(i),n.gluTessBeginContour();for(var a=0,o=0;o<e.length;o++){var s=[e[o].x,e[o].y,0];t&&t.length&&(s.push(t[a],t[a+1]),a+=2),n.gluTessVertex(s,s)}return n.gluTessEndContour(),n.gluTessEndPolygon(),i}},{key:"tessellate_p1",value:function(e,t){var n=r.tesselator(),i=[];n.gluTessCallback(q.gluEnum.GLU_TESS_BEGIN,(function(e){e!==q.primitiveType.GL_TRIANGLES&&console.error("Tessellation error, primitive is not TRIANGLES.")})),n.gluTessCallback(q.gluEnum.GLU_TESS_COMBINE,(function(e,r,n){var i=[e[0],e[1],e[2]];if(t&&t.length)for(var a=3;a<=4;a++){for(var o=0,s=0;s<4;s++)n[s]>0&&(o+=n[s]*r[s][a]);i[a]=o}return i})),n.gluTessCallback(q.gluEnum.GLU_TESS_EDGE_FLAG,(function(){})),n.gluTessCallback(q.gluEnum.GLU_TESS_VERTEX_DATA,(function(e,r){r.push(e[0]),r.push(e[1]),r.push(e[2]),t&&t.length&&(r.push(e[3]),r.push(e[4]))})),n.gluTessCallback(q.gluEnum.GLU_TESS_ERROR,(function(e){console.error("tess err",e)})),n.gluTessBeginPolygon(i),n.gluTessBeginContour();for(var a=0,o=0;o<e.length;o+=2){var s=[e[o],e[o+1],0];t&&t.length&&(s.push(t[a],t[a+1]),a+=2),n.gluTessVertex(s,s)}return n.gluTessEndContour(),n.gluTessEndPolygon(),i}},{key:"tessellate",value:function(e,t){var n=r.tesselator(),i=[];n.gluTessCallback(q.gluEnum.GLU_TESS_BEGIN,(function(e){e!==q.primitiveType.GL_TRIANGLES&&console.error("Tessellation error, primitive is not TRIANGLES.")})),n.gluTessCallback(q.gluEnum.GLU_TESS_COMBINE,(function(e,r,n){var i=[e[0],e[1],e[2]];if(t&&t.length)for(var a=3;a<=4;a++){for(var o=0,s=0;s<4;s++)n[s]>0&&(o+=n[s]*r[s][a]);i[a]=o}return i})),n.gluTessCallback(q.gluEnum.GLU_TESS_EDGE_FLAG,(function(){})),n.gluTessCallback(q.gluEnum.GLU_TESS_VERTEX_DATA,(function(e,r){r.push(e[0]),r.push(e[1]),r.push(e[2]),t&&t.length&&(r.push(e[3]),r.push(e[4]))})),n.gluTessCallback(q.gluEnum.GLU_TESS_ERROR,(function(e){console.error("tess err",e)})),n.gluTessBeginPolygon(i);for(var a=0,o=0;o<e.length;o++){n.gluTessBeginContour();for(var s=e[o],l=0;l<s.length;l+=1){var c=s[l],u=[c.longitude*H.DEGREES_TO_RADIANS,c.latitude*H.DEGREES_TO_RADIANS,0];t&&t.length&&(u.push(t[a],t[a+1]),a+=2),n.gluTessVertex(u,u)}n.gluTessEndContour()}return n.gluTessEndPolygon(),i}},{key:"getBbox",value:function(e){for(var t={minX:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},r=0;r<e.length;r++){var n=e[r];t.minX=Math.min(t.minX,n.x),t.maxX=Math.max(t.maxX,n.x),t.minY=Math.min(t.minY,n.y),t.maxY=Math.max(t.maxY,n.y)}return t.width=Math.abs(t.maxX-t.minX),t.height=Math.abs(t.maxY-t.minY),t}},{key:"getCorners",value:function(e,t){e.length;for(var r=[],n=0;n<e.length;n+=2){var i,a,o,s,l,c;0===n?(i=e[e.length-2],a=e[e.length-1]):(i=e[n-2],a=e[n-1]),o=e[n],s=e[n+1],n===e.length-2?(l=e[0],c=e[1]):(l=e[n+2],c=e[n+3]);var u=Math.atan2(c-s,l-o)-Math.atan2(a-s,i-o);r.push({index:n/2,angle:Math.abs(u)*H.RADIANS_TO_DEGREES})}var h={x:e[2*(r=r.filter((function(e){return e.angle<170||e.angle>190})))[0].index],y:e[2*r[0].index+1],index:r[0].index},d={x:e[2*r[1].index],y:e[2*r[1].index+1],index:r[1].index},g={x:e[2*r[2].index],y:e[2*r[2].index+1],index:r[2].index},f={x:e[2*r[3].index],y:e[2*r[3].index+1],index:r[3].index},p=this.findWhichCorners([h,d,g,f]),m=p[0].index;return{anglesMap:r.reduce((function(e,r){var n="",i=p.findIndex((function(e){return e.index===r.index}));return"CW"===t?0===i?n="tl":1===i?n="tr":2===i?n="br":3===i&&(n="bl"):0===i?n="tl":1===i?n="bl":2===i?n="br":3===i&&(n="tr"),e[r.index]=n,e}),Object.create(null)),topLeftIndex:m}}},{key:"findWhichCorners",value:function(e){var t=this.userProperties;if(t&&t.identifier){var r=t.identifier;if(0===r.indexOf("S3")&&-1!==r.indexOf("OL_1_ERR___")){var n=this._interiorGeometry[0],i=e.map((function(e){var t=n[e.index];return{latitude:t.latitude,longitude:t.longitude,index:e.index}}));i.sort((function(e,t){return e.latitude-t.latitude})),i.length=2;var a=i[0],o=i[1];a.longitude<0&&o.longitude>0||a.longitude>0&&o.longitude<0?i.sort((function(e,t){return Math.abs(t.longitude)-Math.abs(e.longitude)})):i.sort((function(e,t){return Math.abs(e.longitude)-Math.abs(t.longitude)}));var s,l=e.findIndex((function(e){return e.index===i[0].index}));if(l>0){s=[];for(var c=l;c<e.length+l;c++)s.push(e[c%e.length])}return s||e}}return this.reindexCorners(e)}},{key:"getCorners_old",value:function(e,t){if(this.isEqualPoints(e[0],e[e.length-1])&&e.pop(),4===e.length)return this.reindexCorners(e);t=t||this.getBbox(e);for(var r=[],n=0;n<e.length-1;n++){var i=e[n];i.x===t.minX||i.x===t.maxX?r.push(i):i.y!==t.minY&&i.y!==t.maxY||r.push(i)}return r.length<4?r:this.reindexCorners(r)}},{key:"reindexCorners",value:function(e){var t,r,n=e.slice();if(n.sort((function(e,t){return t.y-e.y})),n.length=2,n.sort((function(e,t){return e.x-t.x})),n[0].index,(t=e.findIndex((function(e){return e.index===n[0].index})))>0){r=[];for(var i=t;i<e.length+t;i++)r.push(e[i%e.length])}return r||e}},{key:"reindexCorners_old",value:function(e){var t,r=-1;if(this.getSlope(e[0],e[2])>0&&(r=e[0].y<e[2].y?0:2),this.getSlope(e[1],e[3])>0&&(e[1].y<e[3].y?(-1!==r&&console.error("slope method is not ok 1"),r=1):(-1!==r&&console.error("slope method is not ok 2"),r=3)),-1===r&&console.error("slope method could not determine topLeft"),r>0){t=[];for(var n=r;n<e.length+r;n++)t.push(e[n%e.length])}return t||e}},{key:"isEqualPoints",value:function(e,t){return e.x===t.x&&e.y===t.y}},{key:"windingOrder",value:function(e){return(e[1].x-e[0].x)*(e[1].y+e[0].y)+(e[2].x-e[1].x)*(e[2].y+e[1].y)+(e[3].x-e[2].x)*(e[3].y+e[2].y)+(e[0].x-e[3].x)*(e[0].y+e[3].y)<0?"CCW":"CW"}},{key:"windingOrder_all",value:function(e){for(var t=0,r=0;r<e.length-2;r+=2){var n=(r+2)%e.length,i=r%e.length,a=e[n],o=e[n+1];t+=(a-e[i])*(o+e[i+1])}return t<0?"CCW":"CW"}},{key:"getSlope",value:function(e,t){return(e.y-t.y)/(e.x-t.x)}},{key:"distance2D",value:function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}}],[{key:"tesselator",value:function(){return r.tess||(r.tess=new q.GluTesselator),r.tess}},{key:"nextId",value:function(){return r._nextId||(r._nextId=0),r._nextId++}},{key:"staticStateKey",value:function(e){return e.stateKeyInvalid=!1,e.highlighted&&e._highlightAttributes?e._attributesStateKey=e._highlightAttributes.stateKey:e._attributes?e._attributesStateKey=e._attributes.stateKey:e._attributesStateKey=null,"dn "+e.displayName+" id "+e._id+" at "+(e._attributesStateKey?e._attributesStateKey:"null")+" hi "+e.highlighted+" en "+e.enabled+" pt "+e.pathType+" ne "+e.maximumNumEdgeIntervals+" po "+e.polarThrottle+" img "+!!e.image+" se ["+e.sector.minLatitude+","+e.sector.maxLatitude+","+e.sector.minLongitude+","+e.sector.maxLongitude+"]"}}]),r}(Y),ee=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e,n){var i;if(Object(A.a)(this,r),i=t.call(this,n),!Array.isArray(e))throw new Error("TexturedSurfacePolygon - constructor - The specified boundary is not an array.");return i._boundaries=i.removeDuplicateLocations(e),i}return Object(j.a)(r,[{key:"boundaries",get:function(){return this._boundaries},set:function(e){if(!Array.isArray(e))throw new Error("TexturedSurfacePolygon - set boundaries - The specified boundary is not an array.");this._boundaries=this.removeDuplicateLocations(e),this.isPrepared=!1,this.stateKeyInvalid=!0}},{key:"removeDuplicateLocations",value:function(e){if(Array.isArray(e[0])){for(var t=[],r=0;r<e.length;r++){var n=this.removeDuplicateLocationsFromContour(e[r]);t.push(n)}return t}return this.removeDuplicateLocationsFromContour(e)}},{key:"removeDuplicateLocationsFromContour",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(n);for(var i=r+1;i<e.length;i++){var a=e[i];if(n.latitude!==a.latitude||n.longitude!==a.longitude)break;r++}}return t}},{key:"computeStateKey",value:function(){return r.staticStateKey(this)}}],[{key:"staticStateKey",value:function(e){return $.staticStateKey(e)}}]),r}($),te=f.a.ArgumentError,re=(f.a.GeoJSONConstants,f.a.GeoJSONParser),ne=f.a.Location,ie=f.a.Logger,ae=f.a.RenderableLayer;re.prototype.addRenderablesForPolygon=function(e,t,r){if(!e)throw new te(ie.logMessage(ie.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingLayer"));if(!t)throw new te(ie.logMessage(ie.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(t,r);if(!this.crs||this.crs.isCRSSupported()){for(var i,a=[],o=0,s=t.coordinates;o<s.length;o++){for(var l=[],c=0,u=s[o];c<u.length;c++){var h=u[c][0],d=u[c][1],g=this.getReprojectedIfRequired(d,h,this.crs),f=new ne(g[1],g[0]);l.push(f)}a.push(l)}i=new ee(a,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(i.highlightAttributes=n.highlightAttributes),n&&n.name&&(i.displayName=n.name),n&&n.pickDelegate&&(i.pickDelegate=n.pickDelegate),n&&n.userProperties&&(i.userProperties=n.userProperties),n&&n.timeRange&&(i.timeRange=n.timeRange),e.addRenderable(i)}},re.prototype.load=function(e,t,r){e&&(this._parserCompletionCallback=e),t&&(this._shapeConfigurationCallback=t),this._layer=r||new ae;var n=typeof this.dataSource;if("string"===n){var i=re.tryParseJSONString(this.dataSource);null!==i?this.handle(i):this.requestUrl(this.dataSource)}else"object"===n?this.handle(this.dataSource):ie.logMessage(ie.LEVEL_SEVERE,"GeoJSON","load","Unsupported data source type: "+n)},re.prototype.addRenderablesForMultiPolygon=function(e,t,r){if(!e)throw new te(ie.logMessage(ie.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingLayer"));if(!t)throw new te(ie.logMessage(ie.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingGeometry"));var n=this.shapeConfigurationCallback(t,r);if(!this.crs||this.crs.isCRSSupported())for(var i=0,a=t.coordinates;i<a.length;i++){for(var o,s=[],l=0;l<a[i].length;l++){for(var c=[],u=0,h=a[i][l];u<h.length;u++){var d=h[u][0],g=h[u][1],f=this.getReprojectedIfRequired(g,d,this.crs),p=new ne(f[1],f[0]);c.push(p)}s.push(c)}o=new ee(s,n&&n.attributes?n.attributes:null),n.highlightAttributes&&(o.highlightAttributes=n.highlightAttributes),n&&n.name&&(o.displayName=n.name),n&&n.pickDelegate&&(o.pickDelegate=n.pickDelegate),n&&n.userProperties&&(o.userProperties=n.userProperties),n&&n.timeRange&&(o.timeRange=n.timeRange),e.addRenderable(o)}};var oe=f.a.ArcBallCamera,se=f.a.ArgumentError,le=(f.a.BasicWorldWindowController,f.a.DrawContext),ce=f.a.EarthElevationModel,ue=f.a.FrameStatistics,he=f.a.Frustum,de=f.a.Globe,ge=(f.a.Globe2D,f.a.GoToAnimator),fe=(f.a.GpuResourceCache,f.a.Line),pe=f.a.Logger,me=(f.a.LookAtNavigator,f.a.Matrix),_e=f.a.Navigator,ve=f.a.PickedObjectList,be=f.a.Position,Ee=f.a.Rectangle,ye=(f.a.Sector,f.a.SurfaceShape),xe=(f.a.SurfaceShapeTileBuilder,f.a.Terrain,f.a.Vec2),Se=f.a.Vec3,we=f.a.WWMath,Te=function(){function e(t,r,n,i){if(Object(A.a)(this,e),console.log("constructing worlwindow"),!window.WebGLRenderingContext)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","constructor","webglNotSupported"));var a;if(t instanceof HTMLCanvasElement)a=t;else if(!(a=document.getElementById(t)))throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas ID is not in the document."));var o=this.createContext(a);if(!o)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","constructor","webglNotSupported"));function s(e){e.preventDefault()}this.drawContext=new le(o),this.eventListeners={},this.redrawRequested=!0,this.redrawRequestId=null,this.scratchModelview=me.fromIdentity(),this.scratchProjection=me.fromIdentity(),this.hasStencilBuffer=o.getContextAttributes().stencil,this.canvas=a,this.depthBits=o.getParameter(o.DEPTH_BITS),this.viewport=new Ee(0,0,o.drawingBufferWidth,o.drawingBufferHeight),this.globe=new de(r||new ce),this.layers=[],this.navigator=new _e(i&&new i(this)||new oe(this)),this.verticalExaggeration=1,this.deepPicking=!1,this.subsurfaceMode=!1,this.surfaceOpacity=1,this.frameStatistics=new ue,this.goToAnimator=new ge(this),this._redrawCallbacks=[],this._orderedRenderingFilters=[function(e){l.declutter(e,1)},function(e){l.declutter(e,2)}],this.pixelScale=1,this.addEventListener("mousedown",s),this.addEventListener("touchstart",s),this.addEventListener("contextmenu",s),this.addEventListener("wheel",s);var l=this;function c(e){l.handleRedrawEvent(e)}this.canvas.addEventListener("webglcontextlost",(function(e){l.handleContextLost(e)}),!1),this.canvas.addEventListener("webglcontextrestored",(function(e){l.handleContextRestored(e)}),!1),this.canvas.addEventListener(f.a.REDRAW_EVENT_TYPE,c,!1),window.addEventListener(f.a.REDRAW_EVENT_TYPE,c,!1),this.animationFrameLoop()}return Object(j.a)(e,[{key:"orderedRenderingFilters",value:function(){return this._orderedRenderingFilters}},{key:"redrawCallbacks",value:function(){return this._redrawCallbacks}},{key:"canvasCoordinates",value:function(e,t){var r=this.canvas.getBoundingClientRect(),n=e-(r.left+this.canvas.clientLeft),i=t-(r.top+this.canvas.clientTop);return new xe(n,i)}},{key:"addEventListener",value:function(e,t){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","addEventListener","missingType"));if(!t)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","addEventListener","missingListener"));var r=this,n=this.eventListeners[e];n||(n={listeners:[],callback:function(e){e.worldWindow=r;for(var t=0,i=n.listeners.length;t<i;t++)n.listeners[t](e)}},this.eventListeners[e]=n),-1==n.listeners.indexOf(t)&&(n.listeners.splice(0,0,t),1==n.listeners.length&&this.canvas.addEventListener(e,n.callback,!1))}},{key:"removeEventListener",value:function(e,t){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingType"));if(!t)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingListener"));var r=this.eventListeners[e];if(r){var n=r.listeners.indexOf(t);-1!=n&&(r.listeners.splice(n,1),0==r.listeners.length&&this.canvas.removeEventListener(e,r.callback,!1))}}},{key:"redraw",value:function(){this.redrawRequested=!0}},{key:"pick",value:function(e){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","pick","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new ve:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickPoint=e,this.drawContext.pickRay=this.rayThroughScreenPoint(e),this.drawFrame(),this.drawContext.objectsAtPickPoint)}},{key:"pickTerrain",value:function(e){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","pickTerrain","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new ve:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickTerrainOnly=!0,this.drawContext.pickPoint=e,this.drawContext.pickRay=this.rayThroughScreenPoint(e),this.drawFrame(),this.drawContext.objectsAtPickPoint)}},{key:"pickShapesInRegion",value:function(e){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","pickShapesInRegion","missingRectangle"));return this.drawContext.currentGlContext.isContextLost()?new ve:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.regionPicking=!0,this.drawContext.pickRectangle=new Ee(e.x,this.canvas.height-e.y,e.width,e.height),this.drawFrame(),this.drawContext.objectsAtPickPoint)}},{key:"createContext",value:function(e){var t={antialias:!1,stencil:!0},r=e.getContext("webgl",t);return r||(r=e.getContext("experimental-webgl",t)),r}},{key:"handleContextLost",value:function(e){pe.log(pe.LEVEL_INFO,"WebGL context event: "+e.statusMessage),e.preventDefault(),this.drawContext.contextLost(),window.cancelAnimationFrame(this.redrawRequestId)}},{key:"handleContextRestored",value:function(e){pe.log(pe.LEVEL_INFO,"WebGL context event: "+e.statusMessage),this.drawContext.contextRestored(),this.redraw(),this.animationFrameLoop()}},{key:"handleRedrawEvent",value:function(e){this.redraw()}},{key:"animationFrameLoop",value:function(){this.redrawIfNeeded();var e=this;this.redrawRequestId=window.requestAnimationFrame((function(){e.animationFrameLoop()}))}},{key:"redrawIfNeeded",value:function(){if(this.resize(),this.redrawRequested)try{this.redrawRequested=!1,this.drawContext.previousRedrawTimestamp=this.drawContext.timestamp,this.callRedrawCallbacks(f.a.BEFORE_REDRAW),this.resetDrawContext(),this.drawFrame()}catch(e){pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","redrawIfNeeded","Exception occurred during redrawing.\n"+e.toString())}finally{this.callRedrawCallbacks(f.a.AFTER_REDRAW),this.drawContext.redrawRequested&&(this.redrawRequested=!0)}}},{key:"resize",value:function(){var e=this.drawContext.currentGlContext,t=e.canvas.clientWidth*this.pixelScale,r=e.canvas.clientHeight*this.pixelScale;e.canvas.width==t&&e.canvas.height==r||(e.canvas.width=t,e.canvas.height=r,e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),this.viewport=new Ee(0,0,e.drawingBufferWidth,e.drawingBufferHeight),this.redrawRequested=!0)}},{key:"computeViewingTransform",value:function(e,t){if(!t)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","computeViewingTransform","missingModelview"));var r=this.globe;if(this.navigator.camera.createViewMatrix(t),e){e.setToIdentity();var n=we.max(r.equatorialRadius,r.polarRadius),i=t.extractEyePoint(new Se(0,0,0)),a=r.computePositionFromPoint(i[0],i[1],i[2],new be(0,0,0)),o=we.horizonDistanceForGlobeRadius(n,a.altitude),s=we.horizonDistanceForGlobeRadius(n,16e4),l=this.viewport,c=o+s;c<1e3&&(c=1e3);var u=we.perspectiveNearDistanceForFarDistance(c,10,this.depthBits),h=a.altitude-r.elevationAtLocation(a.latitude,a.longitude);if(h>0){var d=we.perspectiveNearDistance(l.width,l.height,h);u>d&&(u=d)}u<1&&(u=1),e.setToPerspectiveProjection(l.width,l.height,u,c)}}},{key:"computePixelMetrics",value:function(e){var t=me.fromIdentity();t.invertMatrix(e);var r=new Se(-1,-1,-1),n=new Se(1,1,-1),i=new Se(-1,-1,1),a=new Se(1,1,1);r.multiplyByMatrix(t),n.multiplyByMatrix(t),i.multiplyByMatrix(t),a.multiplyByMatrix(t);var o=we.fabs(n[0]-r[0]),s=we.fabs(a[0]-i[0]),l=-r[2],c=(s-o)/(-i[2]-l),u=o-c*l;return{pixelSizeFactor:c/this.viewport.width,pixelSizeOffset:u/this.viewport.height}}},{key:"pixelSizeAtDistance",value:function(e){this.computeViewingTransform(this.scratchProjection,this.scratchModelview);var t=this.computePixelMetrics(this.scratchProjection);return t.pixelSizeFactor*e+t.pixelSizeOffset}},{key:"computeDrawContext",value:function(){var e=this.drawContext;this.computeViewingTransform(e.projection,e.modelview),e.viewport=this.viewport,e.eyePoint=e.modelview.extractEyePoint(new Se(0,0,0)),e.modelviewProjection.setToIdentity(),e.modelviewProjection.setToMultiply(e.projection,e.modelview);var t=this.computePixelMetrics(e.projection);e.pixelSizeFactor=t.pixelSizeFactor,e.pixelSizeOffset=t.pixelSizeOffset;var r=me.fromIdentity();r.invertOrthonormalMatrix(e.modelview),e.modelviewNormalTransform=me.fromIdentity().setToTransposeOfMatrix(r.upper3By3());var n=me.fromIdentity();n.setToTransposeOfMatrix(e.modelview),e.frustumInModelCoordinates=he.fromProjectionMatrix(e.projection),e.frustumInModelCoordinates.transformByMatrix(n),e.frustumInModelCoordinates.normalize()}},{key:"resetDrawContext",value:function(){this.globe.offset=0;var e=this.drawContext;e.reset(),e.globe=this.globe,e.navigator=this.navigator,e.layers=this.layers.slice(),e.layers.push(e.screenCreditController),this.computeDrawContext(),e.verticalExaggeration=this.verticalExaggeration,e.surfaceOpacity=this.surfaceOpacity,e.deepPicking=this.deepPicking,e.frameStatistics=this.frameStatistics,e.pixelScale=this.pixelScale,e.update()}},{key:"drawFrame",value:function(){try{this.drawContext.frameStatistics.beginFrame(),this.beginFrame(),this.drawContext.globe.is2D()&&this.drawContext.globe.continuous?this.do2DContiguousRepaint():this.doNormalRepaint()}finally{this.endFrame(),this.drawContext.frameStatistics.endFrame()}}},{key:"doNormalRepaint",value:function(){this.createTerrain(),this.clearFrame(),this.deferOrderedRendering=!1,this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.doPick(),this.resolvePick()):(this.doDraw(),this.subsurfaceMode&&this.hasStencilBuffer&&(this.redrawSurface(),this.drawScreenRenderables()))}},{key:"do2DContiguousRepaint",value:function(){this.createTerrain2DContiguous(),this.clearFrame(),this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.pick2DContiguous(),this.resolvePick()):this.draw2DContiguous()}},{key:"resolvePick",value:function(){this.drawContext.pickTerrainOnly?this.resolveTerrainPick():this.drawContext.regionPicking?this.resolveRegionPick():this.resolveTopPick()}},{key:"beginFrame",value:function(){var e=this.drawContext.currentGlContext;e.enable(e.BLEND),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.depthFunc(e.LEQUAL),this.drawContext.pickingMode&&(this.drawContext.makePickFramebuffer(),this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer))}},{key:"endFrame",value:function(){var e=this.drawContext.currentGlContext;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ZERO),e.depthFunc(e.LESS),e.clearColor(0,0,0,1),this.drawContext.bindFramebuffer(null),this.drawContext.bindProgram(null)}},{key:"clearFrame",value:function(){var e=this.drawContext,t=e.currentGlContext;t.clearColor(e.clearColor.red,e.clearColor.green,e.clearColor.blue,e.clearColor.alpha),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}},{key:"doDraw",value:function(){this.drawContext.renderShapes=!0,this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables()))}},{key:"redrawSurface",value:function(){this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!1),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST)}},{key:"doPick",value:function(){this.drawContext.terrain&&this.drawContext.terrain.pick(this.drawContext),this.drawContext.pickTerrainOnly||(this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.terrain.pick(this.drawContext),this.drawScreenRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables())))}},{key:"createTerrain",value:function(){var e=this.drawContext;e.terrain=this.globe.tessellator.tessellate(e),e.frameStatistics.setTerrainTileCount(e.terrain?e.terrain.surfaceGeometry.length:0)}},{key:"makeCurrent",value:function(e){var t=this.drawContext;switch(t.globe.offset=e,t.globeStateKey=t.globe.stateKey,e){case-1:t.terrain=this.terrainLeft;break;case 0:t.terrain=this.terrainCenter;break;case 1:t.terrain=this.terrainRight}}},{key:"createTerrain2DContiguous",value:function(){var e=this.drawContext;this.terrainCenter=null,e.globe.offset=0,e.globeStateKey=e.globe.stateKey,e.globe.intersectsFrustum(e.frustumInModelCoordinates)&&(this.terrainCenter=e.globe.tessellator.tessellate(e)),this.terrainRight=null,e.globe.offset=1,e.globeStateKey=e.globe.stateKey,e.globe.intersectsFrustum(e.frustumInModelCoordinates)&&(this.terrainRight=e.globe.tessellator.tessellate(e)),this.terrainLeft=null,e.globe.offset=-1,e.globeStateKey=e.globe.stateKey,e.globe.intersectsFrustum(e.frustumInModelCoordinates)&&(this.terrainLeft=e.globe.tessellator.tessellate(e))}},{key:"draw2DContiguous",value:function(){this.terrainCenter&&(" 0 ",this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doDraw()),this.terrainRight&&(" 1 ",this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doDraw()),this.deferOrderedRendering=!1,this.terrainLeft&&(" -1 ",this.makeCurrent(-1),this.doDraw()),this.subsurfaceMode&&this.hasStencilBuffer&&(this.deferOrderedRendering=!0,this.terrainCenter&&(" 0 ",this.makeCurrent(0),this.redrawSurface()),this.terrainRight&&(" 1 ",this.makeCurrent(1),this.redrawSurface()),this.terrainLeft&&(" -1 ",this.makeCurrent(-1),this.redrawSurface())),this.drawScreenRenderables()}},{key:"pick2DContiguous",value:function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doPick()),this.terrainRight&&(this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doPick()),this.deferOrderedRendering=!1,this.terrainLeft&&(this.makeCurrent(-1),this.doPick())}},{key:"drawLayers",value:function(e){var t,r=Date.now(),n=this.drawContext,i=n.layers;n.accumulateOrderedRenderables=e;for(var a=0,o=i.length;a<o;a++)if(t=i[a]){n.currentLayer=t;try{t.render(n)}catch(l){pe.log(pe.LEVEL_SEVERE,"Error while rendering layer "+t.displayName+".\n"+l.toString())}}n.currentLayer=null;var s=Date.now();n.frameStatistics.layerRenderingTime=s-r}},{key:"addLayer",value:function(e){e&&this.layers.push(e)}},{key:"removeLayer",value:function(e){var t=this.indexOfLayer(e);t>=0&&this.layers.splice(t,1)}},{key:"insertLayer",value:function(e,t){t&&this.layers.splice(e,0,t)}},{key:"indexOfLayer",value:function(e){return this.layers.indexOf(e)}},{key:"drawSurfaceRenderables",value:function(){var e,t=this.drawContext;for(t.reverseSurfaceRenderables();e=t.popSurfaceRenderable();)try{e.renderSurface(t)}catch(r){pe.logMessage(pe.LEVEL_WARNING,"WorldWindow","drawSurfaceRenderables","Error while rendering a surface renderable.\n"+r.message)}}},{key:"drawOrderedRenderables",value:function(){var e,t=Date.now(),r=this.drawContext;if(r.sortOrderedRenderables(),this._orderedRenderingFilters)for(var n=0;n<this._orderedRenderingFilters.length;n++)this._orderedRenderingFilters[n](this.drawContext);for(r.orderedRenderingMode=!0;e=r.popOrderedRenderable();)try{e.renderOrdered(r)}catch(i){pe.logMessage(pe.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering an ordered renderable.\n"+i.message)}r.orderedRenderingMode=!1,r.frameStatistics.orderedRenderingTime=Date.now()-t}},{key:"drawScreenRenderables",value:function(){for(var e,t=this.drawContext;e=t.nextScreenRenderable();)try{e.renderOrdered(t)}catch(r){pe.logMessage(pe.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering a screen renderable.\n"+r.message)}}},{key:"resolveTopPick",value:function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length){var e=this.drawContext.objectsAtPickPoint,t=this.drawContext.readPickColor(this.drawContext.pickPoint),r=null,n=null;if(t){for(var i=0,a=e.objects.length;i<a;i++){var o=e.objects[i];if(o.isTerrain&&(n=o),o.color.equals(t)&&(o.isOnTop=!0,r=o,n))break}this.drawContext.deepPicking||(e.clear(),r&&e.add(r),n&&n!=r&&e.add(n))}else e.clear()}}},{key:"resolveTerrainPick",value:function(){for(var e,t=this.drawContext.objectsAtPickPoint,r=0,n=t.objects.length;r<n;r++)if((e=t.objects[r]).isTerrain){e.isOnTop=!0;break}}},{key:"resolveRegionPick",value:function(){if(0!=this.drawContext.objectsAtPickPoint.objects.length)for(var e,t=this.drawContext.objectsAtPickPoint,r=this.drawContext.readPickColors(this.drawContext.pickRectangle),n=0,i=t.objects.length;n<i;n++){if(e=t.objects[n])r[e.color.toByteString()]?e.isOnTop=!0:e.userObject instanceof ye&&(t.objects.splice(n,1),n-=1)}}},{key:"callRedrawCallbacks",value:function(e){for(var t=0,r=this._redrawCallbacks.length;t<r;t++)try{this._redrawCallbacks[t](this,e)}catch(n){pe.log(pe.LEVEL_SEVERE,"Exception calling redraw callback.\n"+n.toString())}}},{key:"goTo",value:function(e,t){this.goToAnimator.goTo(e,t)}},{key:"declutter",value:function(e,t){if(!t)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","declutter","Group ID is null, undefined or 0."));for(var r=[],n=0;n<e.orderedRenderables.length;n++){var i=e.orderedRenderables[n].orderedRenderable;i.declutterGroup===t&&r.push(i)}for(var a=[],o=0;o<r.length;o++){var s=r[o],l=s.screenBounds;l&&l.intersectsRectangles(a)?s.targetVisibility=0:(s.targetVisibility=1,l&&a.push(l))}}},{key:"rayThroughScreenPoint",value:function(e){if(!e)throw new se(pe.logMessage(pe.LEVEL_SEVERE,"WorldWindow","rayThroughScreenPoint","missingPoint"));var t=new Se(e[0],this.viewport.height-e[1],0),r=new Se(0,0,0),n=new Se(0,0,0);this.computeViewingTransform(this.scratchProjection,this.scratchModelview);var i=me.fromIdentity();i.setToMultiply(this.scratchProjection,this.scratchModelview);var a=me.fromIdentity();if(a.invertMatrix(i),!a.unProject(t,this.viewport,r))return null;if(t[2]=1,!a.unProject(t,this.viewport,n))return null;var o=this.scratchModelview.extractEyePoint(new Se(0,0,0)),s=new Se(o[0],o[1],o[2]),l=new Se(n[0],n[1],n[2]);return l.subtract(r),l.normalize(),new fe(s,l)}}]),e}(),Oe=f.a.Angle,Re=f.a.ArgumentError,Ce=f.a.Logger,Le={getAsGeographicLocation:function(e){if(e instanceof Date===!1)throw new Re(Ce.logMessage(Ce.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var t=this.getAsCelestialLocation(e);return this.celestialToGeographic(t,e)},getAsCelestialLocation:function(e){if(e instanceof Date===!1)throw new Re(Ce.logMessage(Ce.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var t=this.computeJulianDate(e)-2451545,r=this.normalizeAngle360(280.46+.9856474*t),n=this.normalizeAngle360(357.528+.9856003*t)*Oe.DEGREES_TO_RADIANS,i=r+1.915*Math.sin(n)+.02*Math.sin(2*n),a=i*Oe.DEGREES_TO_RADIANS,o=(23.439-4e-7*t)*Oe.DEGREES_TO_RADIANS,s=Math.asin(Math.sin(o)*Math.sin(a))*Oe.RADIANS_TO_DEGREES,l=Math.atan(Math.cos(o)*Math.tan(a))*Oe.RADIANS_TO_DEGREES;return i>=90&&i<270&&(l+=180),{declination:s,rightAscension:l=this.normalizeAngle360(l)}},celestialToGeographic:function(e,t){if(!e)throw new Re(Ce.logMessage(Ce.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(t instanceof Date===!1)throw new Re(Ce.logMessage(Ce.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var r=this.computeJulianDate(t)-2451545,n=this.normalizeAngle360(280.46061837+360.98564736629*r),i=this.normalizeAngle360(n-e.rightAscension),a=Oe.normalizedDegreesLongitude(-i);return{latitude:e.declination,longitude:a}},computeJulianDate:function(e){if(e instanceof Date===!1)throw new Re(Ce.logMessage(Ce.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var t=e.getUTCFullYear(),r=e.getUTCMonth()+1,n=e.getUTCDate(),i=(e.getUTCHours()+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24;r<=2&&(t-=1,r+=12);var a=Math.trunc(t/100),o=2-a+Math.trunc(a/4);return Math.trunc(365.25*(t+4716))+Math.trunc(30.6001*(r+1))+n+o-1524.5+i},normalizeAngle360:function(e){var t=e%360;return t>=0?t:t<0?360+t:360-t}},Ae=f.a.Angle,je={SUN:0,MERCURY:1,VENUS:2,MARS:4,JUPITER:5,SATURN:6,URANUS:7,NEPTUNE:8,getCelestialLocation:function(e,t){var r,n=Le.computeJulianDate(t)-2451543.5;switch(e){case this.SUN:r=this.computeSun(n);break;case this.MERCURY:r=this.computeMercury(n);break;case this.VENUS:r=this.computeVenus(n);break;case this.MARS:r=this.computeMars(n);break;case this.JUPITER:r=this.computeJupiter(n);break;case this.SATURN:r=this.computeSaturn(n);break;case this.URANUS:r=this.computeUranus(n);break;case this.NEPTUNE:r=this.computeNeptune(n)}return this.computePosition(n,r)},computeMercury:function(e){return{N:48.3313+324587e-10*e,i:7.0047+5e-8*e,w:29.1241+101444e-10*e,a:.387098,e:.205635+5.59e-10*e,M:168.6562+4.0923344368*e}},computeVenus:function(e){return{N:76.6799+24659e-9*e,i:3.3946+2.75e-8*e,w:54.891+138374e-10*e,a:.72333,e:.006773-1.302e-9*e,M:48.0052+1.6021302244*e}},computeMars:function(e){return{N:49.5574+211081e-10*e,i:1.8497-1.78e-8*e,w:286.5016+292961e-10*e,a:1.523688,e:.093405+2.516e-9*e,M:18.6021+.5240207766*e}},computeJupiter:function(e){return{N:100.4542+276854e-10*e,i:1.303-1.557e-7*e,w:273.8777+164505e-10*e,a:5.20256,e:.048498+4.469e-9*e,M:19.895+.0830853001*e}},computeSaturn:function(e){return{N:113.6634+23898e-9*e,i:2.4886-1.081e-7*e,w:339.3939+297661e-10*e,a:9.55475,e:.055546-9.499e-9*e,M:316.967+.0334442282*e}},computeUranus:function(e){return{N:74.0005+13978e-9*e,i:.7733+19e-9*e,w:96.6612+30565e-9*e,a:19.18171-1.55e-8*e,e:.047318+7.45e-9*e,M:142.5905+.011725806*e}},computeNeptune:function(e){return{N:131.7806+30173e-9*e,i:1.77-255e-9*e,w:272.8461-6027e-9*e,a:30.05826+3.313e-8*e,e:.008606+2.15e-9*e,M:260.2471+.005995147*e}},computeSun:function(e){return{N:0,i:0,w:282.9404+470935e-10*e,a:1,e:.016709-1.151e-9*e,M:356.047+.9856002585*e}},computePosition:function(e,t){var r=t.N,n=t.i,i=t.w,a=t.a,o=t.e,s=t.M;r=Le.normalizeAngle360(r)*Ae.DEGREES_TO_RADIANS,n=Le.normalizeAngle360(n)*Ae.DEGREES_TO_RADIANS,i=Le.normalizeAngle360(i)*Ae.DEGREES_TO_RADIANS;var l=(s=Le.normalizeAngle360(s)*Ae.DEGREES_TO_RADIANS)+o*Math.sin(s)*(1+o*Math.cos(s));if(o>=.06)for(var c=0;c<10;c++){var u=l-(l-o*Math.sin(l)-s)/(1-o*Math.cos(l));if(Math.abs(u-l)<.001){l=u;break}l=u}var h=a*(Math.cos(l)-o),d=a*(Math.sqrt(1-o*o)*Math.sin(l)),g=Math.atan2(d,h),f=Math.sqrt(h*h+d*d),p=f*(Math.cos(r)*Math.cos(g+i)-Math.sin(r)*Math.sin(g+i)*Math.cos(n)),m=f*(Math.sin(r)*Math.cos(g+i)+Math.cos(r)*Math.sin(g+i)*Math.cos(n)),_=f*(Math.sin(g+i)*Math.sin(n)),v=382394e-10*(0-e)*Ae.DEGREES_TO_RADIANS,b=Math.atan2(m,p)+v,E=Math.atan2(_,Math.sqrt(p*p+m*m));p=f*Math.cos(b)*Math.cos(E),m=f*Math.sin(b)*Math.cos(E),_=f*Math.sin(E);var y=this.getLonSun(e,this.computeSun(e)),x=y.lonsun,S=y.rsun;x*=Ae.RADIANS_TO_DEGREES,x=Le.normalizeAngle360(x)*Ae.DEGREES_TO_RADIANS;var w=p+S*Math.cos(x),T=m+S*Math.sin(x),O=_,R=Le.normalizeAngle360(23.4393-3.563e-7*e)*Ae.DEGREES_TO_RADIANS,C=w,L=T*Math.cos(R)-O*Math.sin(R),A=T*Math.sin(R)+O*Math.cos(R);return{ra:Le.normalizeAngle360(Math.atan2(L,C)*Ae.RADIANS_TO_DEGREES),dec:Math.atan2(A,Math.sqrt(C*C+L*L))*Ae.RADIANS_TO_DEGREES}},getLonSun:function(e,t){var r=t.w,n=t.e,i=t.M;r=Le.normalizeAngle360(r)*Ae.DEGREES_TO_RADIANS;var a=(i=Le.normalizeAngle360(i)*Ae.DEGREES_TO_RADIANS)+n*Math.sin(i)*(1+n*Math.cos(i)),o=Math.cos(a)-n,s=Math.sqrt(1-n*n)*Math.sin(a);return{lonsun:Math.atan2(s,o)+r,rsun:Math.sqrt(o*o+s*s)}}},Ne=f.a.ArgumentError,De=f.a.GpuProgram,Me=f.a.Logger,ke=f.a.Matrix,Pe=f.a.Color,Ie=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,e,"attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}","precision mediump float;\nuniform sampler2D textureSampler;\nuniform int fragMode;\nuniform vec4 color;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (fragMode == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else if (fragMode == 0) {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n   else if (fragMode == 2) {\n       gl_FragColor = color;\n   }\n}",["vertexPoint"])).FRAG_MODE_MIX_COLOR=0,n.FRAG_MODE_TEXTURE=1,n.FRAG_MODE_COLOR=2,n.vertexPointLocation=n.attributeLocation(e,"vertexPoint"),n.mvpMatrixLocation=n.uniformLocation(e,"mvpMatrix"),n.numDaysLocation=n.uniformLocation(e,"numDays"),n.magnitudeRangeLocation=n.uniformLocation(e,"magnitudeRange"),n.textureUnitLocation=n.uniformLocation(e,"textureSampler"),n.fragModeLocation=n.uniformLocation(e,"fragMode"),n.colorLocation=n.uniformLocation(e,"color"),n.localState={mvpMatrix:null,numDays:null,magnitudeRange:null,textureUnit:null,fragMode:null,color:null},n}return Object(j.a)(r,[{key:"loadModelviewProjection",value:function(e,t){if(!t)throw new Ne(Me.logMessage(Me.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));var r=!1;null===this.localState.mvpMatrix&&(r=!0,this.localState.mvpMatrix=ke.fromIdentity()),!r&&this.localState.mvpMatrix.equals(t)||(this.loadUniformMatrix(e,t,this.mvpMatrixLocation),this.localState.mvpMatrix.copy(t))}},{key:"loadNumDays",value:function(e,t){if(null==t)throw new Ne(Me.logMessage(Me.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));this.localState.numDays!==t&&(e.uniform1f(this.numDaysLocation,t),this.localState.numDays=t)}},{key:"loadMagnitudeRange",value:function(e,t,r){if(null==t)throw new Ne(Me.logMessage(Me.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==r)throw new Ne(Me.logMessage(Me.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));var n=!1;null===this.localState.magnitudeRange&&(n=!0,this.localState.magnitudeRange=[t,r]),(n||this.localState.magnitudeRange[0]!==t||this.localState.magnitudeRange[1]!==r)&&(e.uniform2f(this.magnitudeRangeLocation,t,r),this.localState.magnitudeRange[0]=t,this.localState.magnitudeRange[1]=r)}},{key:"loadTextureUnit",value:function(e,t){this.localState.textureUnit!==t&&(e.uniform1i(this.textureUnitLocation,t-e.TEXTURE0),this.localState.textureUnit=t)}},{key:"loadFragMode",value:function(e,t){this.localState.fragMode!==t&&(e.uniform1i(this.fragModeLocation,t),this.localState.fragMode=t)}},{key:"loadColor",value:function(e,t){var r=!1;null===this.localState.color&&(r=!0,this.localState.color=new Pe(0,0,0,0)),!r&&this.localState.color.equals(t)||(this.loadUniformColor(e,t,this.colorLocation),this.localState.color.copy(t))}}]),r}(De);Ie.key="WorldWindGpuStarFieldFullProgram";var Ge=Ie,Ue=(f.a.Color,f.a.Layer),Fe=f.a.Logger,Be=f.a.Matrix,Ve=f.a.REDRAW_EVENT_TYPE,ze=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e){var n;Object(A.a)(this,r),(n=t.call(this,"StarField")).pickEnabled=!1,n.sunSize=128,n.showSun=!0,n._starDataSource=e||f.a.configuration.baseUrl+"data/stars.json",n._sunImageSource=f.a.configuration.baseUrl+"images/sunTexture.png",n._matrix=Be.fromIdentity(),n._starsPositionsVboCacheKey=null,n._numStars=0,n._starData=null,n._minMagnitude=Number.MAX_VALUE,n._maxMagnitude=Number.MIN_VALUE,n._loadStarted=!1,n._minScale=3e7,n._scale=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,n._sunPositionsCacheKey="",n._sunBufferView=new Float32Array(4),n._MAX_GL_POINT_SIZE=0,n.showPlanets=!0;var i=32;return n.planets=[{id:je.MERCURY,url:"images/Mercury64.png",size:8,ra:null,dec:null},{id:je.VENUS,url:"images/Venus64.png",size:8,ra:null,dec:null},{id:je.MARS,url:"images/Mars64.png",size:8,ra:null,dec:null},{id:je.JUPITER,url:"images/Jupiter64.png",size:i,ra:null,dec:null},{id:je.SATURN,url:"images/Saturn64.png",size:i,ra:null,dec:null},{id:je.URANUS,url:"images/Uranus64.png",size:16,ra:null,dec:null},{id:je.NEPTUNE,url:"images/Neptune64.png",size:16,ra:null,dec:null}],n._planetsBufferView=null,n._cacheKeys={sunPosition:"",planetPositions:"",starPositions:""},n}return Object(j.a)(r,[{key:"starDataSource",get:function(){return this._starDataSource},set:function(e){this._starDataSource=e,this.invalidateStarData()}},{key:"sunImageSource",get:function(){return this._sunImageSource},set:function(e){this._sunImageSource=e}},{key:"doRender",value:function(e){if(!e.globe.is2D())if(this.haveResources(e)){this.beginRendering(e);try{this.doDraw(e)}finally{this.endRendering(e)}}else this.loadResources(e)}},{key:"haveResources",value:function(e){var t=e.gpuResourceCache.resourceForKey(this._sunImageSource),r=this.planets.every((function(t){return!!e.gpuResourceCache.resourceForKey(t.url)}));return null!=this._starData&&null!=t&&r}},{key:"loadResources",value:function(e){var t=e.currentGlContext,r=e.gpuResourceCache;this._starData||this.fetchStarData(),r.resourceForKey(this._sunImageSource)||r.retrieveTexture(t,this._sunImageSource),this.planets.forEach((function(e){r.resourceForKey(e.url)||r.retrieveTexture(t,e.url)}))}},{key:"beginRendering",value:function(e){var t=e.currentGlContext;e.findAndBindProgram(Ge),t.enableVertexAttribArray(0),t.depthMask(!1)}},{key:"doDraw",value:function(e){this.loadCommonUniforms(e),this.renderStars(e),this.showSun&&this.renderSun(e),this.showPlanets&&this.renderPlanets(e)}},{key:"loadCommonUniforms",value:function(e){var t=e.currentGlContext,r=e.currentProgram,n=e.modelviewProjection||e.navigatorState.modelviewProjection;this._matrix.copy(n),this._matrix.multiplyByScale(this._scale,this._scale,this._scale),r.loadModelviewProjection(t,this._matrix);var i=Le.computeJulianDate(this.time||new Date);r.loadNumDays(t,i-2451545)}},{key:"renderStars",value:function(e){var t=e.currentGlContext,r=e.gpuResourceCache,n=e.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=r.generateCacheKey());var i=r.resourceForKey(this._starsPositionsVboCacheKey);if(i)t.bindBuffer(t.ARRAY_BUFFER,i);else{i=t.createBuffer();var a=this.createStarsGeometry();r.putResource(this._starsPositionsVboCacheKey,i,4*a.length),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW)}e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),n.loadMagnitudeRange(t,this._minMagnitude,this._maxMagnitude),n.loadFragMode(t,n.FRAG_MODE_MIX_COLOR),t.drawArrays(t.POINTS,0,this._numStars)}},{key:"renderPlanets",value:function(e){var t=this,r=e.currentGlContext,n=e.currentProgram,i=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&Fe.log(Fe.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE),this.planets.forEach((function(e){var r=je.getCelestialLocation(e.id,t.time||new Date),n=r.ra,i=r.dec;e.ra=n,e.dec=i}),this),this._planetsBufferView||(this._planetsBufferView=new Float32Array(4*this.planets.length));for(var a=0;a<this.planets.length;a++){var o=this.planets[a];this._planetsBufferView[4*a+0]=o.dec,this._planetsBufferView[4*a+1]=o.ra,this._planetsBufferView[4*a+2]=Math.min(o.size,this._MAX_GL_POINT_SIZE),this._planetsBufferView[4*a+3]=1}this._planetsPositionsVboCacheKey||(this._planetsPositionsVboCacheKey=i.generateCacheKey());var s=i.resourceForKey(this._planetsPositionsVboCacheKey);s?(r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferSubData(r.ARRAY_BUFFER,0,this._planetsBufferView)):(s=r.createBuffer(),i.putResource(this._planetsPositionsVboCacheKey,s,4*this._planetsBufferView.length),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,this._planetsBufferView,r.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),r.vertexAttribPointer(0,4,r.FLOAT,!1,0,0),n.loadFragMode(r,n.FRAG_MODE_TEXTURE);for(var l=0;l<this.planets.length;l++){var c=this.planets[l].url;e.gpuResourceCache.resourceForKey(c).bind(e),r.drawArrays(r.POINTS,l,1)}}},{key:"renderSun",value:function(e){var t=e.currentGlContext,r=e.currentProgram,n=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&Fe.log(Fe.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var i=Le.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=i.declination,this._sunBufferView[1]=i.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=n.generateCacheKey());var a=n.resourceForKey(this._sunPositionsCacheKey);a?(t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferSubData(t.ARRAY_BUFFER,0,this._sunBufferView)):(a=t.createBuffer(),n.putResource(this._sunPositionsCacheKey,a,4*this._sunBufferView.length),t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,this._sunBufferView,t.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),r.loadFragMode(t,r.FRAG_MODE_TEXTURE),e.gpuResourceCache.resourceForKey(this._sunImageSource).bind(e),t.drawArrays(t.POINTS,0,1)}},{key:"endRendering",value:function(e){var t=e.currentGlContext;t.depthMask(!0),t.disableVertexAttribArray(0)}},{key:"fetchStarData",value:function(){if(!this._loadStarted){this._loadStarted=!0;var e=this,t=new XMLHttpRequest;t.onload=function(){if(this.status>=200&&this.status<300)try{e._starData=JSON.parse(this.response),e.sendRedrawRequest()}catch(t){Fe.log(Fe.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+t.toString())}else Fe.log(Fe.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);e._loadStarted=!1},t.onerror=function(){Fe.log(Fe.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),e._loadStarted=!1},t.ontimeout=function(){Fe.log(Fe.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),e._loadStarted=!1},t.open("GET",this._starDataSource,!0),t.send()}}},{key:"createStarsGeometry",value:function(){var e=this.parseStarsMetadata(this._starData.metadata);if(-1===e.raIndex)throw new Error(Fe.logMessage(Fe.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(-1===e.decIndex)throw new Error(Fe.logMessage(Fe.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(-1===e.magIndex)throw new Error(Fe.logMessage(Fe.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var t=this._starData.data,r=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var n=0,i=t.length;n<i;n++){var a=t[n],o=a[e.decIndex],s=a[e.raIndex],l=a[e.magIndex],c=l<2?2:1;r.push(o,s,c,l),this._minMagnitude=Math.min(this._minMagnitude,l),this._maxMagnitude=Math.max(this._maxMagnitude,l)}return this._numStars=Math.floor(r.length/4),r}},{key:"parseStarsMetadata",value:function(e){for(var t=-1,r=-1,n=-1,i=0,a=e.length;i<a;i++){var o=e[i];"ra"===o.name&&(t=i),"dec"===o.name&&(r=i),"vmag"===o.name&&(n=i)}return{raIndex:t,decIndex:r,magIndex:n}}},{key:"invalidateStarData",value:function(){this._starData=null,this._starsPositionsVboCacheKey=null}},{key:"sendRedrawRequest",value:function(){var e=document.createEvent("Event");e.initEvent(Ve,!0,!0),window.dispatchEvent(e)}}]),r}(Ue),qe=r(36),We=r.n(qe),Ke=f.a.Color,He=[{key:"s1a",name:"SENTINEL-1A",shortName:"S-1A",satIndex:0,swathTypes:["black","red","green","white"],swathColors:[Ke.colorFromKmlHex("ff000000"),Ke.colorFromKmlHex("ff0000ff"),Ke.colorFromKmlHex("ff00ff00"),Ke.colorFromKmlHex("ffffffff")],swatModes:["IW","EW","SM"],tleLineOne:"1 39634U 14016A   18124.03591006  .00000001  00000-0  10014-4 0  9998",tleLineTwo:"2 39634  98.1819 132.0838 0001369  78.7198 281.4156 14.59198520217480",hasModel:!0,filePath:"./satellites/sentinel1/s1.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0,launchDate:new Date("2014-04-03T21:02:00.000Z")},{key:"s2a",name:"SENTINEL-2A",shortName:"S-2A",satIndex:1,swathTypes:["red","purple","white","darkGrey","green","greener"],swathColors:[Ke.colorFromKmlHex("ff0000ff"),Ke.colorFromKmlHex("ffff00ff"),Ke.colorFromKmlHex("ffffffff"),Ke.colorFromKmlHex("ff7f7f7f"),Ke.colorFromKmlHex("ff00ff00"),Ke.colorFromKmlHex("ff00fff7")],swatModes:["NOBS"],tleLineOne:"1 40697U 15028A   18124.08865983  .00000004  00000-0  17994-4 0  9993",tleLineTwo:"2 40697  98.5686 199.4434 0001286  92.5669 267.5666 14.30817033149583",hasModel:!0,filePath:"./satellites/senti2version6/s2.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:1e6,translations:{x:.1,y:.385,z:.02},ignoreLocalTransforms:!0,launchDate:new Date("2015-06-23T01:52:00.000Z")},{key:"s3a",name:"SENTINEL-3A",shortName:"S-3A",satIndex:2,tleLineOne:"1 41335U 16011A   18124.14356592 -.00000000  00000-0  18017-4 0  9998",tleLineTwo:"2 41335  98.6266 192.0005 0001035 100.1921 259.9376 14.26736754115121",hasModel:!0,filePath:"./satellites/Sentinel3/s3.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:180,headingMultiply:1},preRotations:{x:0,y:180,z:0},scale:1e6,translations:{x:.01,y:1.98,z:.07},ignoreLocalTransforms:!0,launchDate:new Date("2016-02-16T17:57:00.000Z")},{key:"s1b",name:"SENTINEL-1B",shortName:"S-1B",satIndex:3,swathTypes:["black","red","green","white"],swathColors:[Ke.colorFromKmlHex("ff000000"),Ke.colorFromKmlHex("ff0000ff"),Ke.colorFromKmlHex("ff00ff00"),Ke.colorFromKmlHex("ffffffff")],swatModes:["IW","EW","SM"],tleLineOne:"1 41456U 16025A   18124.13828432 -.00000022  00000-0  49756-5 0  9992",tleLineTwo:"2 41456  98.1817 132.0102 0001487  82.9964 277.1419 14.59197806107664",hasModel:!0,filePath:"./satellites/sentinel1/s1.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0,launchDate:new Date("2016-04-25T21:02:00.000Z")},{key:"s2b",name:"SENTINEL-2B",shortName:"S-2B",satIndex:4,swathTypes:["blue"],swathColors:[Ke.colorFromKmlHex("ffffff00")],swatModes:["NOBS"],tleLineOne:"1 42063U 17013A   18124.12358125  .00000002  00000-0  17497-4 0  9994",tleLineTwo:"2 42063  98.5687 199.4702 0001382  97.5073 262.6270 14.30817718 60503",groundPosition:{latitude:5.2079,longitude:-52.7724,altitude:0},hasModel:!0,filePath:"./satellites/senti2version6/s2.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:1e6,translations:{x:.1,y:.385,z:.02},ignoreLocalTransforms:!0,launchDate:new Date("2017-03-07T01:49:00.000Z")},{key:"s5p",name:"SENTINEL-5P",shortName:"S-5P",satIndex:5,swathTypes:[],swathColors:[],tleLineOne:"1 42969U 17064A   18123.85141871 -.00000009  00000-0  16636-4 0  9994",tleLineTwo:"2 42969  98.7352  64.1585 0001101  78.1817 281.9482 14.19565315 28712",groundPosition:{latitude:62.92786,longitude:40.57483,altitude:0},hasModel:!0,filePath:"./satellites/sentinel5p/s5p.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:210,y:0,z:0},scale:7e4,translations:{x:.5,y:.4,z:-1.2},ignoreLocalTransforms:!0,launchDate:new Date("2017-10-13T09:27:00.000Z")},{key:"s3b",name:"SENTINEL-3B",shortName:"S-3B",satIndex:6,tleLineOne:"1 43437U 18039A   18122.61596633  .00002473  00000-0  10753-2 0  9999",tleLineTwo:"2 43437  98.6226 190.4610 0008811 292.4467  67.5830 14.24954518   977",groundPosition:{latitude:62.925556,longitude:40.577778,altitude:0},hasModel:!0,filePath:"satellites/Sentinel3/s3.json",rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:180,headingMultiply:1},preRotations:{x:0,y:180,z:0},scale:1e6,translations:{x:.01,y:1.98,z:.07},ignoreLocalTransforms:!0,launchDate:new Date("2018-04-25T17:57:00.000Z")}],Ye=He,Xe=r(16),Qe=f.a.ArgumentError,Ze=f.a.BasicTextureProgram,Je=f.a.Color,$e=f.a.Logger,et=f.a.Matrix,tt=(f.a.Position,f.a.PickedObject),rt=f.a.Renderable,nt=f.a.Vec3,it=function(e,t){if(!e)throw new Qe($e.logMessage($e.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));rt.call(this),this._position=e,this._nodes=[],this._meshes={},this._materials={},this._images={},this._upAxis="",this._dirPath="",this._xRotation=0,this._yRotation=0,this._zRotation=0,this.preX=0,this.preY=0,this.preZ=0,this._xTranslation=0,this._yTranslation=0,this._zTranslation=0,this._scale=1,this._altitudeMode=f.a.ABSOLUTE,this._localTransforms=!0,this._useTexturePaths=!0,this._nodesToHide=[],this._hideNodes=!1,this._placePoint=new nt(0,0,0),this._transformationMatrix=et.fromIdentity(),this._mvpMatrix=et.fromIdentity(),this._normalTransformMatrix=et.fromIdentity(),this._normalMatrix=et.fromIdentity(),this._texCoordMatrix=et.fromIdentity().setToUnitYFlip(),this._entities=[],this._activeTexture=null,this._tmpVector=new nt(0,0,0),this._tmpColor=new Je(1,1,1,1),this._vboCacheKey="",this._iboCacheKey="",this.setSceneData(t)};(it.prototype=Object.create(rt.prototype)).constructor=it,Object.defineProperties(it.prototype,{position:{get:function(){return this._position},set:function(e){this._position=e}},nodes:{get:function(){return this._nodes},set:function(e){this._nodes=e}},meshes:{get:function(){return this._meshes},set:function(e){this._meshes=e}},materials:{get:function(){return this._materials},set:function(e){this._materials=e}},images:{get:function(){return this._images},set:function(e){this._images=e}},upAxis:{get:function(){return this._upAxis},set:function(e){this._upAxis=e}},dirPath:{get:function(){return this._dirPath},set:function(e){this._dirPath=e}},xRotation:{get:function(){return this._xRotation},set:function(e){this._xRotation=e}},yRotation:{get:function(){return this._yRotation},set:function(e){this._yRotation=e}},zRotation:{get:function(){return this._zRotation},set:function(e){this._zRotation=e}},xTranslation:{get:function(){return this._xTranslation},set:function(e){this._xTranslation=e}},yTranslation:{get:function(){return this._yTranslation},set:function(e){this._yTranslation=e}},zTranslation:{get:function(){return this._zTranslation},set:function(e){this._zTranslation=e}},scale:{get:function(){return this._scale},set:function(e){this._scale=e}},placePoint:{get:function(){return this._placePoint},set:function(e){this._placePoint=e}},altitudeMode:{get:function(){return this._altitudeMode},set:function(e){this._altitudeMode=e}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(e){this._transformationMatrix=e}},normalMatrix:{get:function(){return this._normalMatrix},set:function(e){this._normalMatrix=e}},localTransforms:{get:function(){return this._localTransforms},set:function(e){this._localTransforms=e}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(e){this._useTexturePaths=e}},nodesToHide:{get:function(){return this._nodesToHide},set:function(e){this._nodesToHide=e}},hideNodes:{get:function(){return this._hideNodes},set:function(e){this._hideNodes=e}}}),it.prototype.setSceneData=function(e){e&&(this._nodes=e.root.children,this._meshes=e.meshes,this._materials=e.materials,this._images=e.images,this._upAxis=e.metadata.up_axis,this._dirPath=e.dirPath,this.flattenModel())},it.prototype.flattenModel=function(){for(var e=0,t=this._nodes.length;e<t;e++)this.flattenNode(this._nodes[e]);this._entities.sort((function(e,t){var r=null===e.imageKey?"":""+e,n=null===t.imageKey?"":""+t;return r>n?1:r===n?0:-1}))},it.prototype.flattenNode=function(e){if(e.mesh)for(var t=e.mesh,r=this._meshes[t].buffers,n=0,i=r.length;n<i;n++){for(var a=r[n].material,o=0;o<e.materials.length;o++)if(a===e.materials[o].symbol){var s=e.materials[o].id;break}var l=this._materials[s],c=null;l&&l.textures&&r[n].uvs&&r[n].uvs.length>0&&(l.textures.diffuse?c=l.textures.diffuse.mapId:l.textures.reflective&&(c=l.textures.reflective.mapId)),this._entities.push({mesh:r[n],material:l,node:e,imageKey:c})}for(var u=0;u<e.children.length;u++)this.flattenNode(e.children[u])},it.prototype.render=function(e){var t,r=e.frustumInModelCoordinates;this.enabled&&(this.lastFrameTime!==e.timestamp&&(t=this.makeOrderedRenderable(e)),t&&r.containsPoint(this._placePoint)&&(t.layer=e.currentLayer,this.lastFrameTime=e.timestamp,e.addOrderedRenderable(t)))},it.prototype.makeOrderedRenderable=function(e){return e.surfacePointForMode(this._position.latitude,this._position.longitude,this._position.altitude,this._altitudeMode,this._placePoint),this.eyeDistance=e.eyePoint.distanceTo(this._placePoint),this},it.prototype.renderOrdered=function(e){if(this.drawOrderedScene(e),e.pickingMode){var t=new tt(this.pickColor.clone(),this,this._position,this.layer,!1);e.resolvePick(t)}},it.prototype.drawOrderedScene=function(e){try{this.beginDrawing(e)}finally{this.endDrawing(e)}},it.prototype.beginDrawing=function(e){var t=e.currentGlContext,r=e.gpuResourceCache,n=r.resourceForKey(this._vboCacheKey),i=r.resourceForKey(this._iboCacheKey);n||(this.setupBuffers(e),n=r.resourceForKey(this._vboCacheKey),i=r.resourceForKey(this._iboCacheKey)),t.bindBuffer(t.ARRAY_BUFFER,n),i&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),e.findAndBindProgram(Ze),t.enableVertexAttribArray(0),e.pickingMode&&(this.pickColor=e.uniquePickColor()),this.computeTransformationMatrix(e.globe);for(var a=0,o=this._entities.length;a<o;a++){this.mustRenderNode(this._entities[a].node.id)&&this.draw(e,this._entities[a])}},it.prototype.setupBuffers=function(e){for(var t=e.currentGlContext,r=Float32Array.BYTES_PER_ELEMENT||4,n=Uint16Array.BYTES_PER_ELEMENT||2,i=Uint32Array.BYTES_PER_ELEMENT||4,a=!1,o=0,s=0,l=0,c=this._entities.length;l<c;l++){var u=this._entities[l].mesh;u.indexedRendering&&(o+=u.indices.length,u.indices instanceof Uint32Array&&(a=!0)),s+=u.vertices.length,this._entities[l].imageKey&&(s+=u.uvs.length),u.normals&&u.normals.length&&(s+=u.normals.length)}var h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,s*r,t.STATIC_DRAW);var d=0;for(l=0,c=this._entities.length;l<c;l++){var g=this._entities[l].mesh.vertices;this._entities[l].vertexOffset=d,t.bufferSubData(t.ARRAY_BUFFER,d*r,g),d+=g.length}for(l=0,c=this._entities.length;l<c;l++)this._entities[l].imageKey&&(g=this._entities[l].mesh.uvs,this._entities[l].uvOffset=d,t.bufferSubData(t.ARRAY_BUFFER,d*r,g),d+=g.length);for(l=0,c=this._entities.length;l<c;l++)(g=g=this._entities[l].mesh.normals)&&g.length&&(this._entities[l].normalOffset=d,t.bufferSubData(t.ARRAY_BUFFER,d*r,g),d+=g.length);var f,p=n,m=o*p;if(a&&((f=e.getExtension("OES_element_index_uint"))?m=o*(p=i):$e.log($e.LEVEL_SEVERE,'The 3D model is too big and might not render properly. \nYour browser does not support the "OES_element_index_uint" extension, required to render large models.')),o){var _=t.createBuffer();for(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,_),t.bufferData(t.ELEMENT_ARRAY_BUFFER,m,t.STATIC_DRAW),d=0,l=0,c=this._entities.length;l<c;l++)(u=this._entities[l].mesh).indexedRendering&&((g=u.indices)instanceof Uint32Array&&!f&&(g=new Uint16Array(g)),this._entities[l].indexOffset=d,this._entities[l].indexSize=p,t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,d*p,g),d+=g.length)}this._vboCacheKey=e.gpuResourceCache.generateCacheKey(),e.gpuResourceCache.putResource(this._vboCacheKey,h,s*r),o&&(this._iboCacheKey=e.gpuResourceCache.generateCacheKey(),e.gpuResourceCache.putResource(this._iboCacheKey,_,m))},it.prototype.draw=function(e,t){var r=e.currentGlContext,n=e.currentProgram,i=e.gpuResourceCache,a=t.mesh,o=t.material,s=t.node.worldMatrix,l=t.node.normalMatrix,c=a.normals&&a.normals.length,u=t.imageKey;if(this.applyColor(e,o),u){var h=this._useTexturePaths?this._images[u].path:this._images[u].filename,d=this._dirPath+h;if(this._activeTexture=i.resourceForKey(d),!this._activeTexture){var g=a.isClamp?r.CLAMP_TO_EDGE:r.REPEAT;this._activeTexture=i.retrieveTexture(r,d,g)}this._activeTexture&&this._activeTexture.bind(e)?(n.loadTextureEnabled(r,!0),r.vertexAttribPointer(2,2,r.FLOAT,!1,8,4*t.uvOffset),r.enableVertexAttribArray(2),n.loadModulateColor(r,e.pickingMode)):(n.loadTextureEnabled(r,!1),r.disableVertexAttribArray(2))}else n.loadTextureEnabled(r,!1),r.disableVertexAttribArray(2);if(c&&!e.pickingMode?(n.loadApplyLighting(r,1),r.vertexAttribPointer(1,3,r.FLOAT,!1,12,4*t.normalOffset),r.enableVertexAttribArray(1)):(n.loadApplyLighting(r,0),r.disableVertexAttribArray(1)),this.applyMatrix(e,c,d,s,l),r.vertexAttribPointer(0,3,r.FLOAT,!1,12,4*t.vertexOffset),a.indexedRendering){var f=t.indexOffset*t.indexSize;a.indices instanceof Uint32Array&&e.getExtension("OES_element_index_uint")?r.drawElements(r.TRIANGLES,a.indices.length,r.UNSIGNED_INT,f):r.drawElements(r.TRIANGLES,a.indices.length,r.UNSIGNED_SHORT,f)}else r.drawArrays(r.TRIANGLES,0,Math.floor(a.vertices.length/3))},it.prototype.applyColor=function(e,t){var r,n=e.currentGlContext,i=e.currentProgram;if(t)if("constant"===t.techniqueType)var a=t.reflective;else a=t.diffuse;var o=1,s=1,l=1,c=1;a&&(o=a[0],s=a[1],l=a[2],c=null!=a[3]?a[3]:1),this._tmpColor.set(o,s,l,c),r=c*this.layer.opacity,n.depthMask(r>=1||e.pickingMode),i.loadColor(n,e.pickingMode?this.pickColor:this._tmpColor),i.loadOpacity(n,e.pickingMode?r>0?1:0:r)},it.prototype.applyMatrix=function(e,t,r,n,i){this._mvpMatrix.copy(e.modelviewProjection),this._mvpMatrix.multiplyMatrix(this._transformationMatrix),n&&this._localTransforms&&this._mvpMatrix.multiplyMatrix(n),t&&!e.pickingMode&&(this._normalMatrix.copy(e.modelviewNormalTransform),this._normalMatrix.multiplyMatrix(this._normalTransformMatrix),i&&this._localTransforms&&this._normalMatrix.multiplyMatrix(i),e.currentProgram.loadModelviewInverse(e.currentGlContext,this._normalMatrix)),r&&this._activeTexture&&(e.currentProgram.loadTextureMatrix(e.currentGlContext,this._texCoordMatrix),this._activeTexture=null),e.currentProgram.loadModelviewProjection(e.currentGlContext,this._mvpMatrix)},it.prototype.endDrawing=function(e){var t=e.currentGlContext,r=e.currentProgram;t.disableVertexAttribArray(1),t.disableVertexAttribArray(2),r.loadApplyLighting(t,0),r.loadTextureEnabled(t,!1)},it.prototype.computeTransformationMatrix=function(e){this._transformationMatrix.setToIdentity(),this._transformationMatrix.multiplyByLocalCoordinateTransform(this._placePoint,e),this._transformationMatrix.multiplyByRotation(1,0,0,this._xRotation),this._transformationMatrix.multiplyByRotation(0,1,0,this._yRotation),this._transformationMatrix.multiplyByRotation(0,0,1,this._zRotation),this._transformationMatrix.multiplyByScale(this._scale,this._scale,this._scale),this._transformationMatrix.multiplyByTranslation(this._xTranslation,this._yTranslation,this._zTranslation),this._transformationMatrix.multiplyByRotation(1,0,0,this.preX),this._transformationMatrix.multiplyByRotation(0,1,0,this.preY),this._transformationMatrix.multiplyByRotation(0,0,1,this.preZ),this.computeNormalMatrix()},it.prototype.computeNormalMatrix=function(){this._transformationMatrix.extractRotationAngles(this._tmpVector),this._normalTransformMatrix.setToIdentity(),this._normalTransformMatrix.multiplyByRotation(-1,0,0,this._tmpVector[0]),this._normalTransformMatrix.multiplyByRotation(0,-1,0,this._tmpVector[1]),this._normalTransformMatrix.multiplyByRotation(0,0,-1,this._tmpVector[2])},it.prototype.mustRenderNode=function(e){var t=!0;this._hideNodes&&(t=-1===this._nodesToHide.indexOf(e));return t};for(var at=it,ot=f.a.Matrix,st=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e,n,i){var a;Object(A.a)(this,r),(a=t.call(this))._satellite=n;var o=a.parse(e);return a.draw(i,o),a}return Object(j.a)(r,[{key:"position",value:function(e){this._model.position=e}},{key:"draw",value:function(e,t){var r=this._satellite,n=r.rotations,i=r.translations,a=r.preRotations,o=r.scale,s=r.shortName,l=r.ignoreLocalTransforms,c=new at(e,t);c.type=this.type,c.satShortName=s,c.nodesToHide=["PlatformCircleAndName","SolarWingsCircleAndName","C-SarCircleAndName","PlatformTextsAndArrows","SolarWingsTextsAndArrows","C-SarTextsAndArrows","SolarArrayGroup","WingsDetailsGroup","Group004","MsiGroup","SatelliteGroup","SatelliteDimensionsGroup","MWRGroup","SRALGroup","OLCIGroup","SLSTRGroup"],c.hideNodes=!0,c.useTexturePaths=!1,c.localTransforms=l,c.scale=o,c.xRotation=n.x,c.yRotation=n.y,c.zRotation=n.z,c.xTranslation=i.x,c.yTranslation=i.y,c.zTranslation=i.z,c.preX=a.x,c.preY=a.y,c.preZ=a.z,this._model=c,t=null}},{key:"parse",value:function(e){var t=e.meshes,r=e.root.children,n=e.materials;for(var i in t)if(t.hasOwnProperty(i))for(var a=t[i].buffers,o=0;o<a.length;o++){var s=a[o].vertices||[],l=a[o].normals||[],c=a[o].uvs||[],u=a[o].indices||[],h=new Float32Array(s),d=new Float32Array(l),g=new Float32Array(c),f=new Uint16Array(u);a[o].vertices=h,a[o].normals=d,a[o].uvs=g,a[o].indices=f}for(var p=0;p<r.length;p++){var m=r[p];if(m.mesh){var _=m.worldMatrix.slice(0);m.worldMatrix=ot.fromIdentity(),m.worldMatrix.copy(_),m.children.length&&console.info("node has children",m)}}for(var v in n)if(n.hasOwnProperty(v)){var b=n[v];"_3_-_Default-material"===b.id?b.reflective&&(b.reflective[0]=.289219,b.reflective[1]=.713497,b.reflective[2]=.870753,b.reflective[3]=1):"_1_-_Default_004-material"===b.id||"_1_-_Default-material"===b.id?b.diffuse[3]=0:"Chrome-material"===b.id?(b.textures=null,b.diffuse[0]=.3137,b.diffuse[1]=.3137,b.diffuse[2]=.3137):"Satellite_panel-material"===b.id?b.textures.reflective.mapId="image9":"_3_-_Default"===b.id?b.textures.reflective.mapId="image4":"_4_-_Default-material"===b.id?b.textures.reflective.mapId="image5":"_5_-_Default_002-material"===b.id?b.textures.reflective.mapId="image6":"_5_-_Default-material"===b.id&&(b.textures.reflective.mapId="image5")}return e}},{key:"render",value:function(e){this._model&&this.enabled&&this._model.render(e)}}]),r}(f.a.Renderable),lt=f.a.RenderableLayer,ct=f.a.Position,ut=We.a.EoUtils,ht={rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0},dt=function(e){Object(B.a)(r,e);var t=Object(V.a)(r);function r(e,n){var i;return Object(A.a)(this,r),(i=t.call(this,e)).type="SatelliteModelLayer",i._satelliteOptions=n,i._rerenderMap=null,i.key=e.key,i.model=null,i.time=e.time,i.Tle=null,i.heading=null,i.onLayerChanged=e.onLayerChanged||null,i}return Object(j.a)(r,[{key:"setModel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ht,r=arguments.length>2?arguments[2]:void 0;e&&(this.model=new st(e,t,r),this.removeAllRenderables(),this.addRenderable(this.model),this.doRerender())}},{key:"setPosition",value:function(e){e&&this.model&&this.model.position(e)}},{key:"setTle",value:function(e){e&&(this.Tle=e,this.update())}},{key:"update",value:function(){if(this.Tle&&this.time){var e=ut.computeSatrec.apply(ut,Object(Xe.a)(this.Tle)),t=ut.getOrbitPosition(e,new Date(this.time));this.setPosition(new ct(t.latitude,t.longitude,t.altitude)),this.model&&this.alignWithOrbit(this.time,t,ut.computeSatrec.apply(ut,Object(Xe.a)(this.Tle)),this._satelliteOptions.rotations,this.model._model),this.doRerender()}}},{key:"alignWithOrbit",value:function(e,t,r,n,i){var a=e.getTime(),o=ut.getOrbitPosition(r,new Date(a+1e4)),s=ut.headingAngleRadians(t.latitude,t.longitude,o.latitude,o.longitude),l=ut.rad2deg(s);this.heading=l,"function"===typeof this.onLayerChanged&&this.onLayerChanged({satKey:this.satName,layerKey:this.key,type:this.type},{update:{heading:this.heading}});var c=(l+n.headingAdd)*n.headingMultiply;0!==l&&(1===n.headingAxis[0]?i.xRotation=c:1===n.headingAxis[1]?i.yRotation=c:1===n.headingAxis[2]&&(i.zRotation=c))}},{key:"setTime",value:function(e){e&&(this.time=e,this.update())}},{key:"setRerender",value:function(e){"function"===typeof e&&(this._rerenderMap=e)}},{key:"doRerender",value:function(){"function"===typeof this._rerenderMap&&this._rerenderMap()}}]),r}(lt),gt=We.a.EoUtils,ft=[],pt=function(e){console.log(Ye[e].name);var t={rotations:Ye[e].rotations,preRotations:Ye[e].preRotations,scale:Ye[e].scale,translations:Ye[e].translations,ignoreLocalTransforms:Ye[e].ignoreLocalTransforms},r=Ye[e].launchDate,n=new Date(r.getTime());n.setUTCFullYear(n.getUTCFullYear()+20);var i=new dt({key:Ye[e].key,time:new Date},t);i.timeRange=[r,n];var a=gt.computeSatrec(Ye[e].tleLineOne,Ye[e].tleLineTwo),o=gt.getOrbitPosition(a,new Date);fetch(Ye[e].filePath).then((function(e){return e.json()})).then((function(t){i.setModel(t,{rotations:Ye[e].rotations,preRotations:Ye[e].preRotations,scale:Ye[e].scale,translations:Ye[e].translations,ignoreLocalTransforms:Ye[e].ignoreLocalTransforms},o)})),i.setTle([Ye[e].tleLineOne,Ye[e].tleLineTwo]),ft.push(i)},mt=0;mt<Ye.length;mt++)pt(mt);var _t=ft,vt=[{service:"https://tiles.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018 esa",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"osm",title:"osm",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},{service:"https://tiles.esa.maps.eox.at/wms",layerNames:"terrain-light",title:"terrain-light",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},{service:"https://tiles.maps.eox.at/wms",layerNames:"terrain",title:"terrain",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)}],bt=[{service:"https://tiles.maps.eox.at/wms",layerNames:"hydrography",title:"hydrography",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},{service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",title:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)}];function Et(e){var t=e.id,r=e.clon,i=e.clat,a=e.alt,o=e.starfield,l=e.atmosphere,u=e.background,g=e.overlay,p=e.names,m=e.satellites,_=e.dem,v=864e5,b=36e5,E=Object(n.useRef)(null),y=Object(n.useState)("3D"),x=Object(s.a)(y,2),S=(x[0],x[1]),w=Object(n.useState)(""),T=Object(s.a)(w,2),O=(T[0],T[1],Object(n.useState)({latitude:i,longitude:r,altitude:a,aoi:"",pickedItems:[]})),R=Object(s.a)(O,2),C=R[0],L=R[1],A=Object(n.useRef)(_),j=Object(n.useRef)(0),N=Object(n.useRef)(0),D=Object(n.useState)(m),M=Object(s.a)(D,2),k=M[0],P=M[1],I=Object(n.useState)(o),G=Object(s.a)(I,2),U=G[0],F=G[1],B=Object(n.useState)(l),V=Object(s.a)(B,2),z=V[0],q=V[1],W=Object(n.useRef)(new Date);function K(){var e=E.current,t=e.navigator.heading/-20;setTimeout((function r(){Math.abs(e.navigator.heading)>Math.abs(t)?(e.navigator.heading+=t,setTimeout(r,10)):e.navigator.heading=0,e.redraw()}),10)}function H(e){console.log("toggleAtmosphere: "+e),te("Atmosphere").enabled=null!=e?e:!te("Atmosphere").enabled,E.current.redraw()}function Y(e){console.log("toggleModel: "+e),re(W.current,e),E.current.redraw()}function X(e){console.log("toggleStarfield: "+e),te("StarField").enabled=null!==e?e:!te("StarField").enabled,E.current.redraw()}function Q(e){console.log("toggleNames: "+e),te("overlay_bright").enabled=null!==e?e:!te("overlay_bright").enabled,E.current.redraw()}function Z(e){E.current.layers[j.current].enabled=!1,j.current=null===e?j.current+1:(e-1)%vt.length,console.log("Background Layer ["+(j.current+1)+"/"+vt.length+"]: "+E.current.layers[j.current].displayName),E.current.layers[j.current].enabled=!0,E.current.redraw()}function J(e){E.current.layers[N.current+vt.length].enabled=!1,N.current=null===e?N.current+1:(e-1)%bt.length,E.current.layers[N.current+vt.length].enabled=!0,E.current.redraw()}function $(e){var t;A.current=null!==e?e:!A.current,A.current?(console.log("Switching to Copernicus Dem"),(t=new f.a.ElevationModel).addCoverage(new f.a.TiledElevationCoverage({coverageSector:f.a.Sector.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"image/tiff",minElevation:-11e3,maxElevation:8850,urlBuilder:new f.a.WcsTileUrlBuilder("https://dem.esa.maps.eox.at/elevation","copdem","2.0.1")}))):(console.log("Switching to NASA Dem"),t=new f.a.EarthElevationModel),E.current.globe.elevationModel=t,E.current.redraw()}function te(e){for(var t=0;t<E.current.layers.length;t++)if(E.current.layers[t].displayName===e)return E.current.layers[t];return null}function re(e,t){for(var r=0;r<_t.length;r++)_t[r].timeRange[0].getTime()>e||_t[r].timeRange[1].getTime()<e?_t[r].enabled=!1:(_t[r].setTime(new Date(e)),_t[r].enabled=null===t?k:t)}function ne(e,t,r){if(0!==e.renderables.length){for(var n=0,i=0,a=0;a<e.renderables.length;a++){var o=e.renderables[a];if(0!=t){var s=o.timeRange[1].getTime();s>i&&s<=t&&(n=a,i=s),o.enabled=t-r<s&&s<=t}else o.enabled=!1}return e.renderables[n].enabled=!0,e.renderables[n]}}var ie=Object(n.useRef)(null),ae=function(e,t){var r=new Image;r.onload=function(){var e=r.width,n=r.height,i=document.createElement("canvas"),a=i.getContext("2d");i.width=e,i.height=n,a.transform(1,0,0,-1,0,n),a.drawImage(r,0,0),t(i.toDataURL())},r.src=e},oe=function(){var e=Object(d.a)(h.a.mark((function e(t,r,n,i,a){var o,s,l,c,u,g,f,p;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=function(){return(s=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){ae(t,(function(t){var r=new Image;r.addEventListener("load",(function(){e(r)}),!1),r.src=t}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},o=function(e){return s.apply(this,arguments)},ie.current=new AbortController,l=0;case 4:if(!(l<a.renderables.length)){e.next=10;break}if(a.renderables[l].displayName!==n[1].toUTCString()){e.next=7;break}return e.abrupt("return");case 7:l++,e.next=4;break;case 10:return e.prev=10,e.next=13,fetch(t,{mode:"cors",credentials:"include",signal:ie.current.signal,cache:"force-cache"});case 13:if((c=e.sent).ok){e.next=16;break}throw new Error("HTTP error! status: ".concat(c.status));case 16:return e.next=18,c.blob();case 18:return u=e.sent,g=URL.createObjectURL(u),e.next=22,o(g);case 22:f=e.sent,(p=new ee(r,i)).maximumNumEdgeIntervals=2,p.polarThrottle=1,p.timeRange=n,p.displayName=n[1].toUTCString(),p.image=f,a.addRenderable(p),URL.revokeObjectURL(g),E.current.redraw(),e.next=38;break;case 34:e.prev=34,e.t0=e.catch(10),console.log("Error contacting server..."),console.log(e.t0);case 38:case"end":return e.stop()}}),e,null,[[10,34]])})));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),se=function(){var e=Object(d.a)(h.a.mark((function e(t){var r,n,i,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(r=t.userProperties.quicklookUrl,n=t.boundaries[0],(i=[])[1]=t.timeRange[1],i[0]=new Date(i[1].getTime()-b),a=t.attributes,o=te("Quicklooks"),oe(r,n,i,a,o),le());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function le(){for(var e=te("Quicklooks").renderables;e.length>50;)e.shift();E.current.redraw()}function ce(){return(ce=Object(d.a)(h.a.mark((function e(t){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t||W.current,U&&(te("StarField").time=new Date(t)),z&&(te("Atmosphere").time=new Date(t)),r=ne(te("Products"),t,v),ne(te("Quicklooks"),t,b),k&&re(t,null),E.current.redraw(),W.current=t,L((function(e){return Object(c.a)(Object(c.a)({},e),{},{closestRenderable:r})}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue=function(){var e=E.current.navigator.lookAtLocation.longitude,t=E.current.navigator.lookAtLocation.latitude,r=E.current.navigator.range,n=r<2e6?function(){var e,t,r=E.current.viewport,n="";try{(e=E.current.pickTerrain(E.current.canvasCoordinates(r.x,r.y+r.height)).terrainObject().position).latitude=Math.round(1e4*e.latitude)/1e4,e.longitude=Math.round(1e4*e.longitude)/1e4}catch(i){e=null}try{(t=E.current.pickTerrain(E.current.canvasCoordinates(r.x+r.width,r.y)).terrainObject().position).latitude=Math.round(1e4*t.latitude)/1e4,t.longitude=Math.round(1e4*t.longitude)/1e4}catch(i){t=null}return null==e||null==t?n="":(e.longitude,e.latitude,t.longitude,t.latitude,n="POLYGON(("+e.longitude+" "+e.latitude+","+t.longitude+" "+e.latitude+","+t.longitude+" "+t.latitude+","+e.longitude+" "+t.latitude+","+e.longitude+" "+e.latitude+"))"),n}():"",i="POINT("+e.toFixed(4)+" "+t.toFixed(4)+")";L((function(a){return Object(c.a)(Object(c.a)({},a),{},{longitude:e,latitude:t,altitude:r,viewpolygon:n,viewpoint:i})}))};return Object(n.useEffect)((function(){console.log("Creating the world...");var e=new f.a.ElevationModel;e.removeAllCoverages(),e.addCoverage(new f.a.TiledElevationCoverage({coverageSector:f.a.Sector.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"image/tiff",minElevation:-11e3,maxElevation:8850,urlBuilder:new f.a.WcsTileUrlBuilder("https://dem.esa.maps.eox.at/elevation","copdem","2.0.1")})),E.current=new Te(t),E.current.redrawCallbacks().push(ue),E.current.navigator.range=a,f.a.BasicWorldWindowController.prototype.applyLimits=function(){E.current.navigator.range=f.a.WWMath.clamp(E.current.navigator.range,1,3e8),console.log("limit")},f.a.configuration.baseUrl=window.location.href;for(var r=new ze,n=new f.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg"),i=new f.a.RenderableLayer("Quicklooks"),s=new f.a.RenderableLayer("Products"),c=[{layer:r,enabled:o},{layer:n,enabled:l},{layer:s,enabled:!0},{layer:i,enabled:!0}],u=0;u<vt.length;u++){var h=new f.a.WmsLayer(vt[u],"");h.enabled=!1,E.current.addLayer(h,"")}for(var d=0;d<bt.length;d++){var g=new f.a.WmsLayer(bt[d],"");g.enabled=!1,E.current.addLayer(g,"")}for(var p=0;p<c.length;p++)c[p].layer.enabled=c[p].enabled,E.current.addLayer(c[p].layer);for(var m=0;m<_t.length;m++)_t.enabled=k,E.current.addLayer(_t[m]);console.log(E.current.layers),r.time=new Date,n.time=new Date,E.current.redraw()}),[]),Object(n.useEffect)((function(){Z(u)}),[u]),Object(n.useEffect)((function(){J(g)}),[g]),Object(n.useEffect)((function(){Q(p)}),[p]),Object(n.useEffect)((function(){H(l),q(l)}),[l]),Object(n.useEffect)((function(){X(o),F(o)}),[o]),Object(n.useEffect)((function(){P(m),Y(m)}),[m]),Object(n.useEffect)((function(){$(_)}),[_]),{eww:E,ewwstate:C,moveTo:function(e,t,r){E.current.goToAnimator.travelTime=1e3,E.current.goTo(new f.a.Position(e,t)),E.current.navigator.range=r,E.current.navigator.camera.applyLimits(),E.current.redraw()},removeGeojson:function(){te("Products").removeAllRenderables(),E.current.redraw()},addGeojson:function(e,t){console.log("adding geo: ");var r=te("Products");new f.a.GeoJSONParser(e).load((function(){!function(e){for(var t=0;t<e.renderables.length;t++){var r=e.renderables[t].userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime,n=new Date(r.getTime()-v);e.renderables[t].timeRange=[n,r]}}(r),ne(r,t,v),E.current.redraw()}),(function(e,t){var r={};r.userProperties=t;var n=new f.a.PlacemarkAttributes(null);return n.imageScale=10,n.imageColor=new f.a.Color(0,1,1,.2),n.labelAttributes.offset=new f.a.Offset(f.a.OFFSET_FRACTION,5,f.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?r.attributes=new f.a.PlacemarkAttributes(n):e.isLineStringType()||e.isMultiLineStringType()?(r.attributes.drawOutline=!0,r.attributes.outlineColor=new f.a.Color(.1*r.attributes.interiorColor.red,.3*r.attributes.interiorColor.green,.7*r.attributes.interiorColor.blue,1),r.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(r.attributes=new f.a.ShapeAttributes(null),r.attributes.interiorColor=new f.a.Color(1,0,0,.2),r.attributes.outlineColor=new f.a.Color(1,0,0,.3),r.highlightAttributes=new f.a.ShapeAttributes(r.attributes),r.highlightAttributes.outlineColor=new f.a.Color(1,0,0,.4),r.highlightAttributes.interiorColor=new f.a.Color(1,0,0,0)),r}),r)},addWMS:function(){},removeQuicklooks:function(){te("Quicklooks").removeAllRenderables(),E.current.redraw()},addQuicklook:se,toggleStarfield:X,toggleAtmosphere:H,setTime:function(e){return ce.apply(this,arguments)},toggleProjection:function(){S((function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator","North Polar","South Polar"],r=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[r]),t[r]){case"3D":E.current.globe.projection=new f.a.ProjectionWgs84;break;case"Equirectangular":E.current.globe.projection=new f.a.ProjectionEquirectangular;break;case"Mercator":E.current.globe.projection=new f.a.ProjectionMercator;break;case"North Polar":E.current.globe.projection=new f.a.ProjectionPolarEquidistant("North");break;case"South Polar":E.current.globe.projection=new f.a.ProjectionPolarEquidistant("South");break;default:E.current.globe.projection=new f.a.ProjectionWgs84}return E.current.redraw(),t[r]}))},toggleNames:Q,toggleModel:Y,toggleBg:Z,toggleOv:J,toggleDem:$,northUp:K}}var yt=r(11);var xt=r(18),St=r(12),wt=r(26),Tt=(r(86),r(3));var Ot=Object(n.memo)((function(e){var t=e.world,r=Object(n.useRef)(),i=Object(n.useRef)(),a=Object(n.useRef)(),o=Object(n.useRef)(),l=Object(n.useRef)(),u=(Object(n.useRef)(),Object(n.useRef)()),h=Object(n.useRef)(),d=Object(n.useRef)(!0),g=Object(n.useRef)(!1),p=Object(n.useRef)("undefined"),m=(Object(n.useRef)(),Object(n.useState)([])),_=Object(s.a)(m,2),v=_[0],b=(_[1],Object(St.useSpring)((function(){return{x:0,y:0}}))),E=Object(s.a)(b,2),y=E[0],x=y.x,S=y.y,w=E[1],T=Object(xt.a)((function(e){var t=Object(s.a)(e.offset,2),r=t[0],n=t[1];return w.start({x:r,y:n})}));St.animated.div,Object(c.a)(Object(c.a)({},T()),{},{style:{x:x,y:S},className:"Debug",children:v}),Object(xt.b)({onDrag:function(e){var r,n=e.event,s=e.xy,c=e.vxvy,u=e.previous,f=e.first,p=e.down,m=e.initial,_=e.delta,v=e.movement,b=e.offset,E=e.velocity,y=e.direction,x=e.tap,S=e.scrolling,w=e.touches,T=e.pinching;e.origin;switch(f&&(h.current=se(s[0],s[1]),h.current||(h.current=se(t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2)),r=n,o.current=r.button,i.current&&r.timeStamp-i.current<300?a.current=!0:(i.current=r.timeStamp,a.current=!1),a.current&&clearTimeout(l.current)),!0){case!a.current&&x:l.current=setTimeout((function(){console.log("simple click")}),300);break;case a.current&&x:clearTimeout(l.current),console.log("double click"),function(){var e=t.current.navigator.heading/-20,r=function r(){Math.abs(t.current.navigator.heading)>Math.abs(e)?(t.current.navigator.heading+=e,setTimeout(r,10)):(t.current.navigator.heading=0,g.current=!1),t.current.redraw()};setTimeout(r,10)}();break;case!a.current&&!x&&2!=o.current&&2!=w:if(!d.current)return;ne.stop(),U.stop(),V.stop(),A.stop(),t.current.globe.is2D()?J(n,m,p,_,b,v,E,y,s,u,f,S):$(n,m,p,_,b,c,E,y,s,u,f,S,w,T);break;case a.current&&!x:ne.stop(),ie(n,m,p,_,b,v,E,y,s,u,f,S);break;case!a.current&&!x&&2==o.current:H(p,_,!0)}},onDragend:function(){console.log("drag end")},onWheel:function(e){var t=e.event,r=e.xy,n=e.previous,i=e.first,a=e.down,o=e.initial,s=e.delta,l=e.movement,c=e.offset,u=e.velocity,d=e.direction,g=(e.tap,e.wheeling);i&&(h.current=se(t.clientX,t.clientY)),ie(t,o,a,s,c,l,u,d,r,n,i,g)},onPinchStart:function(e){d.current=!1,Z.stop(),ne.stop(),U.stop(),V.stop(),k.stop(),A.stop(),p.current="undefined"},onPinch:function(e){var t=e.event,r=e.da,n=e.vdva,i=e.origin,a=e.pinching,o=e.delta,s=e.first,l=e.initial,c=e.direction,u=e.previous,h=e.elapsedTime,d=e.memo,g=void 0===d?{lastY:0}:d;return O(t,r,n,i,a,o,s,l,c,u,g,h),g.lastY=i[1],g},onPinchEnd:function(){clearTimeout(u.current),u.current=setTimeout((function(){d.current=!0}),300),p.current="undefined"}},{domTarget:r,drag:{useTouch:!0},pinch:{useTouch:!0},eventOptions:{passive:!1}});var O=function(e,t,r,n,i,a,o,s,l,c,u,h){switch("undefined"===p.current&&h>=100&&(Math.abs(n[1]-u.lastY)>4?p.current="tilt":p.current="zoomrotate"),p.current){case"tilt":j(i,a,n,s,u);break;case"zoomrotate":P(i,a,n,r)}},R=Object(St.useSpring)((function(){return{pinchtiltvalue:[0,0]}})),C=Object(s.a)(R,2),L=C[0].pinchtiltvalue,A=C[1],j=function(e,r,n,i,a){A.start({pinchtiltvalue:Object(wt.sub)(n,[0,a.lastY]),immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){e||(p.current="undefined");var r=e?.5:.2;t.current.navigator.tilt-=L.get()[1]*r*1,ue(),t.current.redraw()}})},N=Object(St.useSpring)((function(){return{pinchzoomrotatevalue:[0,0]}})),D=Object(s.a)(N,2),M=D[0].pinchzoomrotatevalue,k=D[1],P=function(e,r,n,i){var a=1,o=1;e||(a=Math.abs(i[0])<.2?0:1,o=Math.abs(i[1])<.2?0:1),k.start({pinchzoomrotatevalue:r,immediate:e,config:St.config.molasses,onChange:function(){var e=1-M.get()[0]/300*a;ae(h.current,e),t.current.navigator.range*=e,t.current.navigator.heading-=M.get()[1]*o,0!==t.current.navigator.heading&&(g.current=!0),ue(),t.current.redraw()}})},I=Object(St.useSpring)((function(){return{pinchzoomvalue:0}})),G=Object(s.a)(I,2),U=(G[0].pinchzoomvalue,G[1]),F=Object(St.useSpring)((function(){return{pinchrotatevalue:0}})),B=Object(s.a)(F,2),V=(B[0].pinchrotatevalue,B[1]),z=Object(St.useSpring)((function(){return{tiltvalue:[0,0]}})),q=Object(s.a)(z,2),W=q[0].tiltvalue,K=q[1],H=function(e,r,n){K.start({to:{tiltvalue:r},immediate:e,config:{mass:1,tension:100,friction:40},onChange:function(){var e=-90*W.get()[1]*2/t.current.canvas.clientHeight,r=-90*W.get()[0]*2/t.current.canvas.clientWidth;t.current.navigator.tilt-=e,n&&(t.current.navigator.heading-=r,0!==t.current.navigator.heading&&(g.current=!0)),ue(),t.current.redraw()}})},Y=Object(St.useSpring)((function(){return{panvalue:[0,0]}})),X=Object(s.a)(Y,2),Q=X[0].panvalue,Z=X[1],J=function(e,r,n,i,a,o,s,l,c,u,h,d){var g=1;n||(g=s<.2?0:1);var p="touchmove"===e.type?1:2.5;Z.start({panvalue:i,immediate:n,config:{mass:1,tension:150,friction:80},onChange:function(){var e=[t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2],r=Object(wt.sub)(e,Object(wt.scale)(Q.get(),p*g)),n=se(e[0],e[1]);n||console.log("no currentpos !");var i=se(r[0],r[1]);i||console.log("no nextposition !");var a=new f.a.Vec3(0,0,0),o=new f.a.Vec3(0,0,0);if(t.current.globe.computePointFromPosition(n.latitude,n.longitude,n.altitude,a)&&t.current.globe.computePointFromPosition(i.latitude,i.longitude,i.altitude,o)){var s=f.a.Matrix.fromIdentity();t.current.computeViewingTransform(null,s),s.multiplyByTranslation(a[0]-o[0],a[1]-o[1],a[2]-o[2]);var l=t.current.rayThroughScreenPoint(t.current.canvasCoordinates(c[0],c[1]));s.extractEyePoint(l.origin),s.extractForwardVector(l.direction);var u=new f.a.Vec3(0,0,0);if(t.current.globe.intersectsLine(l,u)){var h=s.extractViewingParameters(u,t.current.navigator.roll,t.current.globe,{});t.current.navigator.lookAtLocation.copy(h.origin),t.current.navigator.range=h.range,t.current.navigator.heading=h.heading,t.current.navigator.tilt=h.tilt,t.current.navigator.roll=h.roll,ue(),t.current.redraw()}}},onRest:function(){}})},$=function(e,r,n,i,a,o,s,l,c,u,d,p,m,_){try{d&&(Math.abs(h.current.latitude)>80||t.current.navigator.heading>2)&&(g.current=!0)}catch(E){console.log("Position at start not detected")}var v=1;n||(v=s<.2?0:1);var b="touchmove"===e.type?1:2.5;n||(b*=.5),Z.start({panvalue:i,immediate:n,config:{mass:1,tension:100,friction:40},onChange:function(){try{var e=[t.current.canvas.clientWidth/2,t.current.canvas.clientHeight/2],r=Object(wt.sub)(e,Object(wt.scale)(Q.get(),b*v)),n=oe(e[0],e[1]);n||console.log("no currentpos !");var i=oe(r[0],r[1]);i||console.log("no nextposition !");var a=new f.a.Vec3(0,0,0),o=new f.a.Vec3(0,0,0);if(!t.current.globe.computePointFromPosition(n.latitude,n.longitude,n.altitude,a))return;if(!t.current.globe.computePointFromPosition(i.latitude,i.longitude,i.altitude,o))return;var s=new f.a.Vec3(0,0,0),l=le(o,a,s);if(i&&(i.latitude>80||i.latitude<-80)&&!1===g.current)return console.log("out"),void Z.stop();ce(s,l,o,i),!1===g.current&&(t.current.navigator.heading=0),t.current.redraw()}catch(c){console.log("probl !")}},onRest:function(){}})},ee=Object(St.useSpring)((function(){return{range:[0,0]}})),te=Object(s.a)(ee,2),re=te[0].range,ne=te[1],ie=function(e,r,n,i,a,o,s,l,c,u,d,g){var f=1;n||(f=s<.2?0:.5),ne.start({range:i,immediate:n||g,config:{mass:1,tension:100,friction:40},onChange:function(){var e=0===f?1:1-re.get()[1]/(g?700:300);ae(h.current,e),t.current.navigator.range*=e,ue(),t.current.redraw()},onRest:function(){}})},ae=function(e,r){if(e&&!(r>=1)){var n,i=t.current.navigator.lookAtLocation,a=t.current.globe.elevationAtLocation(i.latitude,i.longitude),o=new f.a.Position(i.latitude,i.longitude,a);r<1&&(n=f.a.Position.interpolateGreatCircle(r,e,o,new f.a.Position(0,0,0)),i.latitude=n.latitude,i.longitude=n.longitude,i.altitude=n.altitude)}},oe=function(e,r){var n=t.current.rayThroughScreenPoint(t.current.canvasCoordinates(e,r)),i=new f.a.Position(0,0,0),a=[0,0,0];return t.current.globe.intersectsLine(n,a)?(t.current.globe.computePositionFromPoint(a[0],a[1],a[2],i),i):null},se=function(e,r){for(var n=t.current.canvasCoordinates(e,r),i=t.current.pickTerrain(n),a=0;a<i.objects.length;a++){var o=i.objects[a];if(o.isTerrain){var s=o.position;if(s)return new f.a.Position(s.latitude,s.longitude,s.altitude)}}},le=function(e,t,r){var n=f.a.MeasurerUtils.angleBetweenVectors(e,t)*f.a.Angle.RADIANS_TO_DEGREES;return r.copy(e),r.cross(t),r.normalize(),n},ce=function(e,r,n,i){if(!isFinite(r)||!isFinite(e[0])||!isFinite(e[1])||!isFinite(e[2]))return!1;var a=t.current,o=a.navigator,s=f.a.Matrix.fromIdentity(),l=o.lookAtLocation.altitude,c=o.tilt,u=new f.a.Line(new f.a.Vec3(0,0,0),new f.a.Vec3(0,0,0));if(o.tilt=0,a.computeViewingTransform(null,s),s.multiplyByRotation(e[0],e[1],e[2],r),s.extractEyePoint(u.origin),s.extractForwardVector(u.direction),!a.globe.intersectsLine(u,n))return o.tilt=c,!1;var h=s.extractViewingParameters(n,o.roll,a.globe,{});return o.heading=h.heading,o.lookAtLocation.copy(h.origin),o.lookAtLocation.altitude=l,o.tilt=c,!0},ue=function(){var e=t.current.navigator;e.camera.applyLimits(),e.range=f.a.WWMath.clamp(e.range,t.current.globe.elevationAtLocation(e.lookAtLocation.latitude,e.lookAtLocation.longitude)+2,1e8),e.tilt=f.a.WWMath.clamp(e.tilt,0,60)};return Object(n.useEffect)((function(){window.addEventListener("contextmenu",(function(e){return e.preventDefault()}))}),[]),Object(Tt.jsx)("div",{children:Object(Tt.jsx)("div",{className:"EarthController",ref:r})})}));r(88);var Rt=function(e){var t=Object(St.useSpring)((function(){return{x:0,y:0}})),r=Object(s.a)(t,2),n=r[0],i=n.x,a=n.y,o=r[1],l=Object(xt.a)((function(e){var t=Object(s.a)(e.offset,2),r=t[0],n=t[1];return o.start({x:r,y:n})}));return Object(Tt.jsx)(St.animated.div,Object(c.a)(Object(c.a)({},l()),{},{style:{x:i,y:a},className:"Infopanel",children:e.children}))},Ct=function(e){var t=e.id,r=(e.alt,Object(l.useGlobal)("mapSettings")),i=Object(s.a)(r,2),a=i[0],o=i[1],u=Object(l.useGlobal)("position"),h=Object(s.a)(u,2),d=h[0],g=(h[1],Object(l.useGlobal)("altitude")),f=Object(s.a)(g,2),p=f[0],m=f[1],_=Object(l.useGlobal)("viewDate"),v=Object(s.a)(_,2),b=v[0],E=(v[1],Object(l.useGlobal)("geojson")),y=Object(s.a)(E,2),x=y[0],S=(y[1],Object(l.useGlobal)("clearGeojsonTrigger")),w=Object(s.a)(S,1)[0],T=Object(l.useGlobal)("searchPoint"),O=Object(s.a)(T,2),R=(O[0],O[1]),C=Object(l.useGlobal)("closestItem"),L=Object(s.a)(C,2),A=L[0],j=L[1],N=Object(l.useState)(a),D=Object(s.a)(N,2),M=D[0],k=D[1],P=function(e,t){var r=Object(n.useState)(e),i=Object(s.a)(r,2),a=i[0],o=i[1];return Object(n.useEffect)((function(){var r=setTimeout((function(){o(e)}),t);return function(){clearTimeout(r)}}),[e,t]),a}(A,200),I=Et({id:t,clat:d.clat,clon:d.clon,alt:p,starfield:a.starfield,atmosphere:a.atmosphere,background:a.background,overlay:a.overlay,satellites:a.satellites,names:a.names,dem:a.dem}),G=I.eww,U=(I.QL,I.ewwstate),F=I.moveTo,B=I.addGeojson,V=I.removeGeojson,z=I.addQuicklook,q=I.removeQuicklooks,W=(I.addWMS,I.toggleProjection),K=(I.toggleOv,I.toggleModel,I.setTime),H=(I.toggleDem,I.northUp);Object(yt.a)("p",W),Object(yt.a)("c",V),Object(yt.a)("u",H),Object(yt.a)("b",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{background:e.background+1})}))})),Object(yt.a)("m",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{satellites:!e.satellites})}))})),Object(yt.a)("d",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{dem:!e.dem})}))})),Object(yt.a)("o",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{overlay:e.overlay+1})}))})),Object(yt.a)("a",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{atmosphere:!e.atmosphere})}))})),Object(yt.a)("s",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{starfield:!e.starfield})}))})),Object(yt.a)("n",(function(){return k((function(e){return Object(c.a)(Object(c.a)({},e),{},{names:!e.names})}))})),Object(l.useEffect)((function(){m(U.altitude)}),[U.altitude]),Object(l.useEffect)((function(){R(U.viewpoint)}),[U.viewpoint]),Object(l.useEffect)((function(){j(U.closestRenderable)}),[U.closestRenderable]),Object(l.useEffect)((function(){K(b.getTime())}),[b]),Object(l.useEffect)((function(){null!==x&&B(x,b.getTime())}),[x]),Object(l.useEffect)((function(){V(),q()}),[w]),Object(l.useEffect)((function(){o(M)}),[M]),Object(l.useEffect)((function(){k(a)}),[a]),Object(l.useEffect)((function(){a.quicklooks&&z(P)}),[P]),Object(l.useEffect)((function(){console.log("world created / "+d.clat+" / "+d.clon+" / "+p),setTimeout((function(){F(d.clat,d.clon,p)}),1e3)}),[]);return Object(Tt.jsxs)("div",{children:[Object(l.useMemo)((function(){return Object(Tt.jsx)("canvas",{className:"Earth",id:t})}),[a]),Object(Tt.jsx)(Ot,{world:G})]})},Lt=(r(89),r(20)),At=r(58);var jt=function(e){var t=Object(n.useState)(!1),r=Object(s.a)(t,2),a=r[0],o=r[1],l=Object(n.useState)(!1),c=Object(s.a)(l,2),u=c[0],h=c[1],d=i.a.useRef(null),g=Object(St.useSpring)((function(){return{mr:-300}})),f=Object(s.a)(g,2),p=f[0].mr,m=f[1];return Object(xt.b)({onDragStart:function(){return h(!0)},onDrag:function(e){var t=e.down,r=(e.delta,e.vxvy,e.movement);m.start({mr:t?-r[1]:r[1]>100||a?-300:0,immediate:!1,onChange:function(){o(0===p.get())},onRest:function(){t||o(0===p.get())}})},onDragEnd:function(){setTimeout((function(){return h(!1)}),600)}},{domTarget:d,drag:{useTouch:!0},pinch:{useTouch:!0}}),Object(Tt.jsxs)(St.animated.div,{style:{bottom:p,left:0},className:"ControlPanel",children:[Object(Tt.jsx)("div",{ref:d,className:"PanelControl shadow",children:Object(Tt.jsx)(Lt.Icon,{icon:At.a,width:"100%"})}),Object(Tt.jsx)("div",{className:"ControlPanelMask",style:{display:u?"block":"none"}}),Object(Tt.jsx)("div",{className:"ControlPanelBlend",children:e.children})]})};r(90);var Nt=function(e){var t=e.initialmission,r=e.onMissionChange,i=Object(n.useState)(t),a=Object(s.a)(i,2),o=a[0],l=a[1],c=Object(n.useState)(t),u=Object(s.a)(c,2);return u[0],u[1],Object(yt.a)("1",(function(){l("S1")})),Object(yt.a)("2",(function(){l("S2")})),Object(yt.a)("3",(function(){l("S3/SLSTR")})),Object(yt.a)("5",(function(){l("S5P")})),Object(yt.a)("6",(function(){l("ENVISAT")})),Object(n.useEffect)((function(){r(o)}),[o]),Object(Tt.jsx)("div",{className:"MissionSelectorContainer",children:Object(Tt.jsxs)("div",{className:"MissionSelector",children:[Object(Tt.jsx)("div",{className:"S1"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return l("S1")}})}),Object(Tt.jsx)("div",{className:"S1A"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return l("S1A")}})}),Object(Tt.jsx)("div",{className:"S1B"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return l("S1B")}})}),Object(Tt.jsx)("div",{className:"S2"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return l("S2")}})}),Object(Tt.jsx)("div",{className:"S2A"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return l("S2A")}})}),Object(Tt.jsx)("div",{className:"S2B"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return l("S2B")}})}),Object(Tt.jsx)("div",{className:"S3"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3")}})}),Object(Tt.jsx)("div",{className:"S3/SLSTR"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3/SLSTR")}})}),Object(Tt.jsx)("div",{className:"S3A/OLCI/LFR"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3A/OLCI/LFR")}})}),Object(Tt.jsx)("div",{className:"S3B/OLCI/LFR"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3B/OLCI/LFR")}})}),Object(Tt.jsx)("div",{className:"S3/SRAL"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3/SRAL")}})}),Object(Tt.jsx)("div",{className:"S5P"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return l("S5P")}})}),Object(Tt.jsx)("div",{className:"ENVISAT"==o?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return l("ENVISAT")}})})]})})};var Dt=function(){var e=Object(l.useGlobal)("mission"),t=Object(s.a)(e,2),r=t[0],n=t[1];return Object(Tt.jsx)(Nt,{initialmission:r,onMissionChange:n})};r(91);var Mt=function(e){var t=e.mapSettings,r=e.onMapSettingsChange,i=Object(n.useState)(t),a=Object(s.a)(i,2),o=a[0],l=a[1];return Object(n.useEffect)((function(){r(o)}),[o]),Object(n.useEffect)((function(){l(t)}),[t]),Object(Tt.jsx)("div",{className:"MapSelectorContainer",children:Object(Tt.jsxs)("div",{className:"MapSelector",children:[Object(Tt.jsx)("div",{className:t.atmosphere?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/atmosphere.png",alt:"",onClick:function(){return l((function(e){return Object(c.a)(Object(c.a)({},e),{},{atmosphere:!e.atmosphere})}))}})}),Object(Tt.jsx)("div",{className:t.starfield?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/starfield.png",alt:"",onClick:function(){return l((function(e){return Object(c.a)(Object(c.a)({},e),{},{starfield:!e.starfield})}))}})}),Object(Tt.jsx)("div",{className:t.names?"CircleButtonSelected":"CircleButton",children:Object(Tt.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/names.png",alt:"",onClick:function(){return l((function(e){return Object(c.a)(Object(c.a)({},e),{},{names:!e.names})}))}})}),Object(Tt.jsx)("div",{className:"CircleButton",children:Object(Tt.jsx)("img",{className:"MapIcon",draggable:"false",src:"./images/names.png",alt:"",onClick:function(){return l((function(e){return Object(c.a)(Object(c.a)({},e),{},{background:e.background+1})}))}})})]})})};var kt=function(){var e=Object(l.useGlobal)("mapSettings"),t=Object(s.a)(e,2),r=t[0],n=t[1];return Object(Tt.jsx)(Mt,{mapSettings:r,onMapSettingsChange:n})},Pt=(r(92),r(59));var It=function(){var e=Object(l.useGlobal)("appColor"),t=Object(s.a)(e,2),r=t[0],i=t[1];return Object(n.useEffect)((function(){document.documentElement.style.setProperty("--color",r),document.documentElement.style.setProperty("--colort",r+"66")}),[r]),Object(Tt.jsx)("div",{className:"ColorSelector",children:Object(Tt.jsx)(Pt.a,{color:r,onChange:function(e){null!==e&&(document.documentElement.style.setProperty("--color",e),document.documentElement.style.setProperty("--colort",e+"66"),i(e))},style:{height:"150px",width:"140px"}})})},Gt=(r(93),r(27)),Ut=r.n(Gt);var Ft=function(){var e=Object(l.useGlobal)("mapSettings"),t=Object(s.a)(e,2),r=t[0],n=t[1];return Object(Tt.jsxs)("div",{className:"DemSelector verticalContainer",children:[Object(Tt.jsxs)("div",{className:"Selector horizontalContainer",children:[Object(Tt.jsx)(Ut.a,{id:"satellites",onChange:function(e){n(Object(c.a)(Object(c.a)({},r),{},{satellites:e}))},checked:r.satellites}),Object(Tt.jsx)("span",{className:"Label",children:"Satellites"})]}),Object(Tt.jsxs)("div",{className:"Selector horizontalContainer",children:[Object(Tt.jsx)(Ut.a,{id:"dem",onChange:function(e){n(Object(c.a)(Object(c.a)({},r),{},{dem:e}))},checked:r.dem}),Object(Tt.jsx)("span",{className:"Label",children:"Copernicus DEM"})]}),Object(Tt.jsxs)("div",{className:"Selector horizontalContainer",children:[Object(Tt.jsx)(Ut.a,{id:"starfield",onChange:function(e){n(Object(c.a)(Object(c.a)({},r),{},{starfield:e}))},checked:r.starfield}),Object(Tt.jsx)("span",{className:"Label",children:"Stars and Planets"})]}),Object(Tt.jsxs)("div",{className:"Selector horizontalContainer",children:[Object(Tt.jsx)(Ut.a,{id:"atmosphere",onChange:function(e){n(Object(c.a)(Object(c.a)({},r),{},{atmosphere:e}))},checked:r.atmosphere}),Object(Tt.jsx)("span",{className:"Label",children:"Sun and Atmosphere"})]}),Object(Tt.jsxs)("div",{className:"Selector horizontalContainer",children:[Object(Tt.jsx)(Ut.a,{id:"quicklooks",onChange:function(e){n(Object(c.a)(Object(c.a)({},r),{},{quicklooks:e}))},checked:r.quicklooks}),Object(Tt.jsx)("span",{className:"Label",children:"Quicklooks"})]})]})};r(56);var Bt=function(){var e=Object(l.useGlobal)("altitude"),t=Object(s.a)(e,1)[0];return Object(Tt.jsx)("div",{className:"GenericLabel",children:t>=1e4?Math.floor(t/1e3)+" Km":Math.floor(t)+" m"})};var Vt=function(){var e=Object(l.useGlobal)("resultDesc"),t=Object(s.a)(e,1)[0];return Object(Tt.jsx)("div",{className:"GenericLabel",children:0===t.totalLoaded?"":t.totalLoaded+"/"+t.totalResults})},zt=r(28),qt=r.n(zt);r(95);var Wt=function(e){var t=e.date,r=e.highlight,n=e.animated;return Object(Tt.jsxs)("div",{className:"LabelContainer",children:[Object(Tt.jsx)("span",{className:"year"===r?"Highlighted":"",children:t.getUTCFullYear()}),"-",Object(Tt.jsx)("span",{className:"month"===r?"Highlighted":"",children:qt()(t,"UTC:mmm").toUpperCase()}),"-",Object(Tt.jsx)("span",{className:"day"===r?"Highlighted":"",children:qt()(t,"UTC:dd")}),Object(Tt.jsxs)("span",{children:["\xa0",n?"\ud83e\udd75":"\ud83d\ude42","\xa0"]}),Object(Tt.jsx)("span",{className:"hour"===r?"Highlighted":"",children:qt()(t,"UTC:HH")}),":",Object(Tt.jsx)("span",{className:"minute"===r?"Highlighted":"",children:qt()(t,"UTC:MM")}),":",Object(Tt.jsx)("span",{className:"second"===r?"Highlighted":"",children:qt()(t,"UTC:ss")})]})};var Kt=r(60),Ht=r(61),Yt=r(62);function Xt(e,t){var r=Object(n.useState)(),i=Object(s.a)(r,2),a=i[0],o=i[1],l=Object(n.useRef)();return{handleTap:function(r){r.stopPropagation();var n=Date.now();a&&n-a<300?(clearTimeout(l.current),t()):(o(n),l.current=setTimeout((function(){e()}),300))}}}r(96);var Qt=function(e){var t=e.startdate,r=e.onDateChange,i=e.onStateChange,a=e.animated,o=function(e){var t=e.initdate,r=Object(n.useState)(t),i=Object(s.a)(r,2),a=i[0],o=i[1],l=Object(n.useState)(1),c=Object(s.a)(l,2),u=c[0],h=c[1],d=Object(n.useState)(!1),g=Object(s.a)(d,2),f=g[0],p=g[1],m=Object(n.useRef)(),_=Object(n.useRef)();_.current=200;var v=Object(n.useRef)(),b=Object(n.useRef)(),E=Object(n.useRef)();function y(){console.log("start clock"),m.current||(m.current=_.current),f||(b.current=setInterval((function(){v.current+=m.current,o(new Date(v.current))}),_.current)),p(!0)}function x(){console.log("stop clock"),E.current&&clearTimeout(E.current),b.current&&clearInterval(b.current),p(!1)}return Object(n.useEffect)((function(){v.current=t.getTime(),o(new Date(v.current))}),[t]),{date:a,speed:u,playing:f,togglePause:function(){f?x():y()},start:y,stop:x,reset:function(){v.current=(new Date).getTime(),o(new Date(v.current))},increaseSpeed:function(){m.current=m.current>0?m.current*=2:m.current/=2,Math.abs(m.current)<_.current&&(m.current=_.current),console.log("step: "+m.current),h(m.current/200)},decreaseSpeed:function(){m.current=m.current>0?m.current/=2:m.current*=2,Math.abs(m.current)<_.current&&(m.current=-1*_.current),console.log("step: "+m.current),h(m.current/200)},forceDate:function(e){v.current=e.getTime(),o(new Date(v.current))}}}({initdate:t}),l=o.date,c=o.speed,u=(o.togglePause,o.start),h=o.stop,d=o.reset,g=o.increaseSpeed,f=o.decreaseSpeed,p=(o.forceDate,Object(n.useState)(a)),m=Object(s.a)(p,2),_=m[0],v=m[1];Object(yt.a)("t",(function(){v((function(e){return!e}))})),Object(yt.a)("r",(function(){d()})),Object(yt.a)(".",(function(){g()})),Object(yt.a)(",",(function(){f()})),Object(n.useEffect)((function(){i(_),!0===_?u():h()}),[_]),Object(n.useEffect)((function(){r(l)}),[l,r]);var b=Xt((function(){v((function(e){return!e}))}),d).handleTap;return Object(Tt.jsxs)("div",{className:"DateController ",children:[Object(Tt.jsx)(Lt.Icon,{icon:Ht.a,onClick:f,className:"smallcontrolbutton shadow",style:{display:_?"block":"none"}}),Object(Tt.jsx)("div",{className:c>0?"":"flipped",children:Object(Tt.jsx)(Lt.Icon,{icon:Yt.a,onClick:b,className:"controlbutton shadow"})}),Object(Tt.jsxs)("span",{className:"Speed",style:{display:_?"block":"none"},children:["x",Math.abs(c)]}),Object(Tt.jsx)(Lt.Icon,{icon:Kt.a,onClick:g,className:"smallcontrolbutton shadow",style:{display:_?"block":"none"}})]})};r(57);var Zt=function(e){var t=e.date,r=e.zoomfactor,i=e.resulttics,a=Object(n.useRef)(0),o=Object(n.useRef)(null),l=Object(n.useState)(""),c=Object(s.a)(l,2),u=c[0],h=c[1],d=Object(n.useRef)(r),g=Object(n.useRef)(t),f=function(e,t,r){var n=o.current.getContext("2d");n.font="14px Arial",n.shadowColor="rgba(0,0,0,0.8",n.shadowOffsetX=1,n.shadowOffsetY=1,n.shadowBlur=2,n.fillStyle="red",n.clearRect(0,0,window.innerWidth,window.innerHeight);var i=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];function s(e,t){for(var r=""+e;r.length<t;)r="0"+r;return r}for(var l,c,u,h,d=0,g=0,f=0,p=0,m=0,_=0,v=[],b=0,E=0,y=(parseInt(a.current.style.fontSize),0);y<a.current.offsetHeight;y+=1){var x=new Date((y-a.current.offsetHeight/2)*t+e.getTime());switch(l=x.getUTCDate(),c=x.getUTCMonth(),u=x.getUTCHours(),h=x.getUTCFullYear(),d=x.getUTCMinutes(),!0){case t<3e3:E=6e4,d!==_&&0!==y&&(0!==d||0!==u?v.push({class:"HourTic",pos:y,label:s(u,2)+":"+s(d,2)}):0===d&&0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})));break;case t<5e3:E=12e4,d!==_&&0!==y&&(0===d&&0===u||d%2!==0?0===d&&0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})):v.push({class:"HourTic",pos:y,label:s(u,2)+":"+s(d,2)}));break;case t<3e4:E=6e5,d!==_&&0!==y&&(0===d&&0===u||d%10!==0?0===d&&0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})):v.push({class:"HourTic",pos:y,label:s(u,2)+":"+s(d,2)}));break;case t<6e4:E=12e5,d!==_&&0!==y&&(0===d&&0===u||d%20!==0?0===d&&0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})):v.push({class:"HourTic",pos:y,label:s(u,2)+":"+s(d,2)}));break;case t<18e4:E=36e5,u!==m&&0!==y&&(0!==u?v.push({class:"HourTic",pos:y,label:s(u,2)+":00"}):(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})));break;case t<42e4:E=108e5,u!==m&&0!==y&&(0!==u&&u%3===0?v.push({class:"HourTic",pos:y,label:s(u,2)+":00"}):0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})));break;case t<12e5:E=216e5,u!==m&&0!==y&&(0!==u&&u%6===0?v.push({class:"HourTic",pos:y,label:s(u,2)+":00"}):0===u&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]})));break;case t<18e5:E=864e5,l!==g&&0!==y&&(v.push({class:"DayTic_h",pos:y,label:s(l,2)}),v.push({class:"MonthTic_h2",pos:y,label:i[c]}));break;case t<42e5:E=864e5,l!==g&&0!==y&&(1!==l?v.push({class:"DayTic",pos:y,label:l}):(v.push({class:"MonthTic_h",pos:y,label:i[c]}),0===c&&v.push({class:"YearTic_h2",pos:y,label:h})));break;case t<288e5:E=432e6,l!==g&&0!==y&&(1!==l&&30!==l&&l%5===0?v.push({class:"DayTic",pos:y,label:l}):1===l&&(v.push({class:"MonthTic_h",pos:y,label:i[c]}),0===c&&v.push({class:"YearTic_h2",pos:y,label:h})));break;case t<1728e5:E=24192e5,c!==f&&0!==y&&(0!==c?v.push({class:"MonthTic",pos:y,label:i[c]}):(v.push({class:"MonthTic_h",pos:y,label:i[c]}),v.push({class:"YearTic_h2",pos:y,label:h})));break;case t<3456e5:E=72576e5,c!==f&&0!==y&&(0!==c&&11!==c&&c%3===0?v.push({class:"MonthTic",pos:y,label:i[c]}):0===c&&(v.push({class:"MonthTic_h",pos:y,label:i[c]}),v.push({class:"YearTic_h2",pos:y,label:h})));break;case t<7776e6:E=31104e6,h!==p&&0!==y&&(0!==c?v.push({class:"MonthTic",pos:y,label:i[c]}):v.push({class:"YearTic",pos:y,label:h}))}g=l,p=h,f=c,m=u,_=d,v.length!=b&&(y+=E/t-4),b=v.length}if(r)for(var S=r.length;S>=0;S-=1){var w=(r[S]-e.getTime())/t+a.current.offsetHeight/2;w>0&&w<a.current.offsetHeight&&(n.font="30px Arial",n.fillText(".",a.current.offsetWidth-10,w))}return v.map((function(e){return Object(Tt.jsx)("div",{className:e.class,style:{top:e.pos,opacity:1},children:e.label},e.class+e.pos)}))},p=function(){h(f(g.current,d.current))};return Object(n.useEffect)((function(){d.current=r,g.current=t,h(f(t,r,i))}),[r,t,i]),Object(n.useEffect)((function(){return window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[]),Object(Tt.jsxs)("div",{children:[Object(Tt.jsx)("canvas",{ref:o,className:"DateSelectorCanvas",width:"{window.innerWidth}",height:window.innerHeight}),Object(Tt.jsx)("div",{ref:a,className:"DateSelectorScale",id:"DateSelectorScale",style:{fontSize:"14px"},children:u})]})};var Jt=function(e){var t=e.startdate,r=e.tics,i=e.onDateChange,a=e.onFinalDateChange,o=e.onStepChange,l=1296e6,u=1e3,h=36e5,d=Object(n.useRef)(h),g=Object(n.useState)(h),f=Object(s.a)(g,2),p=f[0],m=f[1],_=Object(n.useRef)(),v=Object(n.useState)(t),b=Object(s.a)(v,2),E=b[0],y=b[1],x=Object(n.useState)(!1),S=Object(s.a)(x,2),w=S[0],T=S[1],O=Object(n.useState)([6e4]),R=Object(s.a)(O,2),C=R[0],L=R[1],A=Object(n.useState)("hour"),j=Object(s.a)(A,2),N=j[0],D=j[1],M=Object(n.useRef)(),k=Object(n.useRef)(new Date(0)),P=Object(n.useRef)(),I=(Object(n.useRef)(!1),Object(n.useRef)(),Object(n.useRef)()),G=Object(n.useRef)(t),U=Object(n.useRef)(t),F=Object(St.useSpring)((function(){return{posy_wheel:0}})),B=Object(s.a)(F,2),V=B[0].posy_wheel,z=B[1],q=Object(St.useSpring)((function(){return{zoom:0}})),W=Object(s.a)(q,2),K=W[0].zoom,H=W[1],Y=Object(St.useSpring)((function(){return{test:0}})),X=Object(s.a)(Y,2),Q=X[0].test,Z=X[1],J=Object(xt.b)({onWheel:function(e){e.active;var t=e.delta,r=e.first,n=(e.down,e.direction,e.velocity,e.xy,e.movement,e.wheeling),o=e.ctrlKey,s=e.shiftKey;r&&(Z.stop(),U.current=E),o||s?H.start({zoom:t[1],immediate:!0,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){var e=d.current+d.current/300*K.get()*-1;e<u&&(e=u),e>l&&(e=l),m(e),d.current=e}}):z.start({posy_wheel:t[1],immediate:!0,config:{mass:1,tension:100,friction:40},onChange:function(){var e;T(!0);var t=(V.get()<0?Math.ceil:Math.floor)(V.get()*p/C[0]);0===t&&z.stop(),"month"===N?(e=new Date(U.current.getTime())).setUTCMonth(e.getUTCMonth()-t):e=new Date(U.current.getTime()-t*C[0]),U.current=e,y(e),i(e)},onRest:function(){n||(a(U.current),T(!1))}})},onDragStart:function(){T(!0)},onDrag:function(e){var t=e.event,r=(e.active,e.first),n=e.down,o=(e.touches,e.delta),s=(e.initial,e.distance,e.velocity),c=(e.direction,e.shiftKey),h=e.ctrlKey,g=(e.xy,e.movement);e.vxvy;r&&(z.stop(),function(e){var t=Date.now();I.current=e.button,M.current&&t-M.current<300?P.current=!0:(M.current=t,k.current=E,P.current=!1)}(t),G.current=U.current),s=s<.2?0:s,P.current||c||h||2===I.current?H.start({zoom:o[1],immediate:n,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){var e=d.current+d.current/50*K.get()*-1;e<u&&(e=u),e>l&&(e=l),m(e),d.current=e}}):Z.start({test:n?g[1]:g[1]+g[1]*s*5,immediate:n,config:{mass:1,tension:100,friction:25,precision:.1},onChange:function(){if(T(!0),Math.abs(g[1])>5&&(M.current=new Date(0)),"month"===N){var e=Math.ceil(Q.get()*p/C[0]),t=new Date(G.current.getTime());t.setUTCMonth(t.getUTCMonth()-e),U.current=t}else U.current=new Date(G.current.getTime()-Math.ceil(Q.get()*p/C[0])*C[0]);y(U.current),i(U.current)},onRest:function(){n||(console.log("rest"),a(U.current),T(!1))}})},onDragEnd:function(e){a(U.current),T(!1)}},{drag:{useTouch:!0}}),$=Object(St.useSpring)((function(){return{xy2:[0,0]}})),ee=Object(s.a)($,2),te=ee[0].xy2,re=ee[1];return Object(n.useEffect)((function(){w||function(e){var t=U.current.getTime(),r=[0,t-e.getTime()];re.start({from:{xy2:[0,0]},to:{xy2:r},immediate:!1,config:{reset:!0,duration:300},onChange:function(){var e=new Date(t-te.get()[1]);U.current=e,y(e),i(e)}})}(t)}),[t]),Object(n.useEffect)((function(){o(N)}),[N,o]),Object(n.useEffect)((function(){switch(!0){case p>120426316:L([26784e5,24192e5,26784e5,2592e6,26784e5,2592e6,26784e5,26784e5,2592e6,26784e5,2592e6,26784e5]),D("month");break;case p>94544702:L([10368e5]),D("cycle");break;case p>14544702:L([864e5]),D("day");break;case p>735259:L([36e5]),D("hour");break;case p>32274:L([6e4]),D("minute");break;default:L([1e3]),D("second")}}),[p]),Object(Tt.jsx)("div",{children:Object(Tt.jsxs)("div",{className:"DateSelector",ref:_,children:[Object(Tt.jsx)("div",Object(c.a)(Object(c.a)({},J()),{},{className:"touchMask",children:" "})),Object(Tt.jsxs)("div",{className:"Mask",children:[Object(Tt.jsx)(Zt,{className:"scale",date:E,zoomfactor:p,resulttics:r}),Object(Tt.jsx)("div",{className:"TriangleContainer",children:Object(Tt.jsx)("svg",{height:"40",width:"20",className:"Triangle",children:Object(Tt.jsx)("polygon",{points:"20,5 20,35 12,20"})})})]})]})})};var $t=function(e){var t=e.onDateChange,r=e.onFinalDateChange,i=e.onStateChange,a=e.animated,o=e.startdate,l=e.tics,c=Object(n.useState)(o),u=Object(s.a)(c,2),h=u[0],d=u[1],g=Object(n.useState)(o),f=Object(s.a)(g,2),p=f[0],m=f[1],_=Object(n.useState)(o),v=Object(s.a)(_,2),b=v[0],E=v[1],y=Object(n.useState)(1),x=Object(s.a)(y,2),S=x[0],w=x[1],T=Object(n.useCallback)((function(e){E(e),t(e)}),[]),O=Object(n.useCallback)((function(e){m(e),r(e)}),[]),R=Object(n.useCallback)((function(e){d(e)}),[]);return Object(n.useEffect)((function(){m(o)}),[o]),Object(Tt.jsxs)("div",{children:[Object(Tt.jsx)(Qt,{startdate:p,onDateChange:R,onStateChange:i,animated:a}),Object(Tt.jsx)(Wt,{date:b,animated:a,highlight:S}),Object(Tt.jsx)(Jt,{startdate:h,tics:l,onDateChange:T,onFinalDateChange:O,onStepChange:function(e){w(e)}})]})};var er=function(){var e=Object(l.useGlobal)("viewDate"),t=Object(s.a)(e,2)[1],r=Object(l.useGlobal)("searchDate"),n=Object(s.a)(r,2),i=(n[0],n[1]),a=Object(l.useGlobal)("animated"),o=Object(s.a)(a,2),c=o[0],u=o[1],h=Object(l.useGlobal)("goToDate"),d=Object(s.a)(h,1)[0],g=Object(l.useGlobal)("geojson"),f=Object(s.a)(g,2),p=f[0],m=(f[1],Object(l.useGlobal)("clearGeojsonTrigger")),_=Object(s.a)(m,1)[0],v=Object(l.useState)([]),b=Object(s.a)(v,2),E=b[0],y=b[1];return Object(l.useEffect)((function(){var e;p&&(e=p.features.map((function(e){return e.properties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime.getTime()})),y([].concat(Object(Xe.a)(E),Object(Xe.a)(e))))}),[p]),Object(l.useEffect)((function(){y([])}),[_]),Object(Tt.jsx)($t,{onDateChange:t,onFinalDateChange:i,startdate:d,tics:E,onStateChange:u,animated:c})},tr=(r(97),r(43)),rr=r.n(tr);function nr(e){function t(e){function t(e){for(var t={},r=0;r<e.length;r++)t[e[r].name]=e[r].content;return t}try{var r={};e.date&&Object.assign(r,t(e.date)),e.int&&Object.assign(r,t(e.int)),e.double&&Object.assign(r,t(e.double)),e.str&&Object.assign(r,t(e.str));var n,i=r.size.split(" ");switch(i[1]){case"B":n=Math.round(parseFloat(i[0]));break;case"MB":n=Math.round(1024*parseFloat(i[0]));break;case"GB":n=Math.round(1024*parseFloat(i[0])*1024);break;case"TB":n=Math.round(1024*parseFloat(i[0])*1024*1024);break;default:n=Math.round(parseFloat(i[0]))}return{id:e.title,geometry:rr()(r.footprint),type:"Feature",properties:{updated:new Date(r.ingestiondate),title:e.title,name:e.title,uuid:e.id,date:r.beginposition+"/"+r.endposition,downloadUrl:e.link[0].href,quicklookUrl:e.link.length>=2?e.link[2].href:null,earthObservation:{parentIdentifier:"",status:"ARCHIVED",acquisitionInformation:[{platform:{platformShortName:r.platformname,platformSerialIdentifier:r.platformserialidentifier},sensor:{instrument:r.instrumentshortname,operationalMode:r.sensoroperationalmode},acquisitionParameter:{acquisitionStartTime:new Date(r.beginposition),acquisitionStopTime:new Date(r.endposition),relativePassNumber:parseInt(r.relativeorbitnumber),orbitNumber:parseInt(r.orbitnumber),startTimeFromAscendingNode:null,stopTimeFromAscendingNode:null,orbitDirection:r.orbitdirection}}],productInformation:{productType:r.producttype,size:n}}}}}catch(a){return console.log("error parsing item from dhus: "+a.message),{}}}var r=[];try{r=e.feed.entry?Array.isArray(e.feed.entry)?e.feed.entry.map((function(e){return t(e)})).filter((function(e){return e!=={}})):[t(e.feed.entry)]:[]}catch(n){console.log(e),console.log("Error: "),console.log(n),r=[]}return{type:"FeatureCollection",id:"search",properties:{totalResults:e.feed["opensearch:totalResults"],startIndex:e.feed["opensearch:startIndex"]?e.feed["opensearch:startIndex"]:1,itemsPerPage:e.feed["opensearch:itemsPerPage"],title:"DHuS search response",updated:new Date},features:r}}function ir(e){var t=[];try{e.features?Array.isArray(e.features)&&(console.log("features is an  array"),t=e.features.map((function(e){return function(e){try{for(var t=null,r=null,n=0;n<e.properties.link.length;n++)"Download"==e.properties.link[n]["@"].title&&(t=e.properties.link[n]["@"].href),"Quicklook"==e.properties.link[n]["@"].title&&(r=e.properties.link[n]["@"].href);return{id:e.id,geometry:e.geometry,type:"Feature",properties:{updated:e.properties.updated,title:e.properties.title,name:e.title,uuid:e.properties.identifier,date:e.properties.date,downloadUrl:t,quicklookUrl:r,earthObservation:{parentIdentifier:e.properties.EarthObservation.metaDataProperty.EarthObservationMetaData.parentIdentifier,status:"ARCHIVED",acquisitionInformation:[{platform:{platformShortName:e.properties.EarthObservation.procedure.EarthObservationEquipment.platform.Platform.shortName,platformSerialIdentifier:null},sensor:{instrument:e.properties.EarthObservation.procedure.EarthObservationEquipment.instrument.Instrument.shortName,operationalMode:e.properties.EarthObservation.procedure.EarthObservationEquipment.sensor.Sensor.operationalMode},acquisitionParameter:{acquisitionStartTime:new Date(e.properties.EarthObservation.phenomenonTime.TimePeriod.beginPosition),acquisitionStopTime:new Date(e.properties.EarthObservation.phenomenonTime.TimePeriod.endPosition),relativePassNumber:null,orbitNumber:e.properties.EarthObservation.procedure.EarthObservationEquipment.acquisitionParameters.Acquisition.orbitNumber,startTimeFromAscendingNode:null,stopTimeFromAscendingNode:null,orbitDirection:e.properties.EarthObservation.procedure.EarthObservationEquipment.acquisitionParameters.Acquisition.orbitDirection}}],productInformation:{productType:e.properties.EarthObservation.metaDataProperty.EarthObservationMetaData.productType,downloadUrl:t,quicklookUrl:r,size:null}}}}}catch(i){return console.log("error parsing item from dhus: "+i.message),{}}}(e)})).filter((function(e){return e!=={}}))):t=[]}catch(r){console.log(e),console.log("Error: "),console.log(r),t=[]}return{type:"FeatureCollection",id:"search",properties:{totalResults:e.properties.totalResults,startIndex:e.properties.startIndex,itemsPerPage:e.properties.itemsPerPage,title:e.properties.title,updated:e.properties.updated},features:t}}function ar(){var e=Object(n.useRef)({}),t=Object(n.useRef)(null),r=Object(n.useState)(null),i=Object(s.a)(r,2),a=i[0],o=i[1],l=Object(n.useState)(!1),c=Object(s.a)(l,2),u=c[0],g=c[1],f=Object(n.useRef)([{code:"S1",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-1 AND producttype:GRD)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-1 GRD",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:648e5},{code:"S1A",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-1 AND filename:S1A* AND producttype:GRD)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-1A GRD",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:648e5},{code:"S1B",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-1 AND filename:S1B* AND producttype:GRD)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-1B GRD",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:648e5},{code:"S2",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-2 AND filename:*MSIL1C*)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-2 A/B Level 1C",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:108e5},{code:"S2A",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-2 AND filename:S2A_MSIL1C*)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-2 A/B Level 1C",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:108e5},{code:"S2B",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-2 AND filename:S2B_MSIL1C*)&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-2 A/B Level 1C",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:108e5},{code:"S3",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:OL_1_ERR___ OR producttype:SL_1_RBT___ OR producttype:SR_1_SRA___))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-3 A/B, OLCI/SLSTR/SRAL",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3A/OLCI/LFR",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND filename:S3A_*  AND (producttype:OL_2_LFR___))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-3 A/B, OLCI",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3B/OLCI/LFR",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND filename:S3B_* AND (producttype:OL_2_LFR___))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-3 A/B, OLCI",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3/SLSTR",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:SL_1_RBT___))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-3 A/B, SLSTR",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S3/SRAL",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-3 AND (producttype:SR_1_SRA___))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-3 A/B, SRAL",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"S5P",templateUrl:'https://scihub.copernicus.eu/dhus/search?q=( footprint:"Intersects({polygon})" AND beginposition:[{start} TO {end}] AND platformname:Sentinel-5 precursor AND (producttype:L1B_RA_BD1 OR (producttype:L2__NO2___ AND processingmode:Near real time)))&start={startindex}&rows=100&orderby=beginposition desc&format=json',name:"Sentinel-1 A/B",startIndexOrigin:0,dateOff:" beginposition:[{start} TO {end}] AND",areaOff:' footprint:"Intersects({polygon})" AND',windowSize:864e5},{code:"ENVISAT",templateUrl:"https://eocat.esa.int/api/catalogue/EOCAT-ENVISAT.ASA.IMP_1P/search?start={start}&stop={end}&geom={polygon}&format=json&count=50&startIndex={startindex}",startIndexOrigin:1,name:"Envisat",dateOff:"start={start}&stop={end}&",areaOff:"&geom={polygon}",windowSize:2592e5}]),p=function(e){for(var t=0;t<f.current.length;t++)if(f.current[t].code==e)return f.current[t];return null},m=function(){var r=Object(d.a)(h.a.mark((function r(n,i){var a,s,l,c,u;return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return g(!0),t.current=new AbortController,a=(a=n).replace("{startindex}",i),s={totalresults:0,startindex:0,itemsperpage:0},r.prev=5,r.next=8,fetch(a,{mode:"cors",credentials:"include",signal:t.current.signal});case 8:return l=r.sent,r.prev=9,r.next=12,l.json();case 12:c=r.sent,u="ENVISAT"===e.current.mission?ir(c):nr(c),(s={totalresults:null==u.properties.totalResults?0:Number(u.properties.totalResults),startindex:Number(u.properties.startIndex),itemsperpage:Number(u.properties.itemsPerPage)}).totalresults>0&&o(u),s.startindex+s.itemsperpage<Math.min(s.totalresults,1e3)?m(n,s.startindex+s.itemsperpage):g(!1),r.next=24;break;case 19:r.prev=19,r.t0=r.catch(9),console.log("Didn't receive a json !"),console.log(r.t0),g(!1);case 24:r.next=31;break;case 26:r.prev=26,r.t1=r.catch(5),console.log("Error contacting server..."),console.log(r.t1),g(!1);case 31:case"end":return r.stop()}}),r,null,[[5,26],[9,19]])})));return function(e,t){return r.apply(this,arguments)}}();return{geojsonResults:a,loading:u,search:function(r){var n,i=r.searchdate,a=r.mission,o=r.searchpoint,s="",l=p(a);if(!l)return null;if(u&&t.current.abort(),i){var c=Math.floor(i.getTime()/l.windowSize)*l.windowSize;n=new Date(c).toJSON(),s=new Date(c+l.windowSize-1e3).toJSON()}var h=function(e){var t=e.code,r=e.polygon,n=e.start,i=e.end,a=(e.startindex,p(t));if(!a)return null;var o=a.templateUrl;return o=null!=r?o.replace("{polygon}",r):o.replace(a.areaOff,""),null!=n&&null!=i?(o=o.replace("{start}",n)).replace("{end}",i):o.replace(a.dateOff,"")}({code:a,polygon:o,start:n,end:s});e.current.searchdate=i,e.current.mission=a,e.current.searchpoint=o;var d=p(a).startIndexOrigin;m(h,d)},abort:function(){t&&t.current.abort()}}}var or=r(63);var sr=function(e){var t=e.searchdate,r=e.searchpoint,i=e.mission,a=e.altitude,o=e.onSearchStart,l=e.onPageSearch,u=e.onSearchComplete,h=Object(n.useState)(!1),d=Object(s.a)(h,2),g=d[0],f=d[1],p=Object(n.useState)("backward"),m=Object(s.a)(p,2),_=(m[0],m[1],Object(n.useState)(0)),v=Object(s.a)(_,2),b=v[0],E=v[1],y=(Object(n.useRef)(),Object(n.useRef)(new Date(0))),x=Object(n.useRef)(new Date),S=Object(n.useRef)(0),w=Object(n.useRef)(0),T=Object(n.useState)({}),O=Object(s.a)(T,2),R=O[0],C=O[1],L=ar(),A=L.geojsonResults,j=L.loading,N=L.search,D=L.abort,M=Xt((function(){E(Math.random())}),o).handleTap;return Object(yt.a)("x",(function(){return E(Math.random())})),Object(n.useEffect)((function(){if(A){var e=new Date(A.features[0].properties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime);(y.current.getTime()<e.getTime()||null===y.current)&&(y.current=e);var t=new Date(A.features[A.features.length-1].properties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime);(x.current.getTime()>t.getTime()||null===t.current)&&(x.current=t),w.current+=A.features.length;var r={totalResults:Number(A.properties.totalResults),totalLoaded:w.current};l(A,r)}}),[A]),Object(n.useEffect)((function(){f(j),!1===j&&0!==y.current.getTime()&&u({firstResultDate:y.current,lastResultDate:x.current,totalResults:S.current,totalLoaded:w.current})}),[j]),Object(n.useEffect)((function(){j?D():(y.current=new Date(0),x.current=new Date,w.current=0,S.current=0,o(),N(R))}),[b]),Object(n.useEffect)((function(){var e=t,n=r;a>3e6?n=null:e=null,C((function(t){return Object(c.a)(Object(c.a)({},t),{},{searchdate:e,mission:i,searchpoint:n})}))}),[t,i,r,a]),Object(Tt.jsx)("div",{children:Object(Tt.jsx)("div",{className:!0===g?"SearchController Active":"SearchController",onClick:M,children:Object(Tt.jsx)(Lt.Icon,{icon:or.a,width:"50px"})})})},lr=function(){var e=Object(l.useGlobal)("viewDate"),t=Object(s.a)(e,1)[0],r=Object(l.useGlobal)("goToDate"),i=Object(s.a)(r,2),a=(i[0],i[1]),o=Object(l.useGlobal)("clearGeojsonTrigger"),c=Object(s.a)(o,2),u=(c[0],c[1]),h=Object(l.useGlobal)("searchPoint"),d=Object(s.a)(h,1)[0],g=Object(l.useGlobal)("animated"),f=Object(s.a)(g,1)[0],p=Object(l.useGlobal)("mission"),m=Object(s.a)(p,1)[0],_=Object(l.useGlobal)("altitude"),v=Object(s.a)(_,1)[0],b=Object(l.useGlobal)("pointSearchMaxAltitude"),E=Object(s.a)(b,1)[0],y=Object(l.useGlobal)("geojson"),x=Object(s.a)(y,2),S=(x[0],x[1]),w=Object(l.useGlobal)("resultDesc"),T=Object(s.a)(w,2),O=(T[0],T[1]),R=Object(n.useState)(f),C=Object(s.a)(R,2),L=(C[0],C[1],Object(n.useCallback)((function(e,t){S(e),O(t)}),[])),A=Object(n.useCallback)((function(){u(Math.random()),O({totalResults:0,totalLoaded:0})}),[]);return Object(Tt.jsx)(sr,{searchdate:t,searchpoint:d,mission:m,altitude:v,onSearchStart:A,onPageSearch:L,onSearchComplete:function(e){v>E&&a(f?e.lastResultDate:e.firstResultDate)}})},cr=r(100);var ur=function(){var e=Object(l.useGlobal)("mission"),t=Object(s.a)(e,1)[0],r=Object(n.useRef)(),i=Object(cr.a)().toggle;return Object(yt.a)("f",(function(){i(r.current)})),Object(Tt.jsxs)("div",{className:"App",ref:r,id:"container",children:[Object(Tt.jsx)(Ct,{id:"globe"}),Object(Tt.jsx)(er,{}),Object(Tt.jsx)(lr,{}),Object(Tt.jsx)(jt,{active:"false",children:Object(Tt.jsxs)("div",{className:"horizontalContainer",children:[Object(Tt.jsx)(Dt,{}),Object(Tt.jsx)(kt,{}),Object(Tt.jsxs)("div",{className:"horizontalContainer",children:[Object(Tt.jsx)(It,{}),Object(Tt.jsx)(Ft,{})]})]})}),Object(Tt.jsxs)(Rt,{children:[Object(Tt.jsx)("div",{className:"MissionLabel",children:t}),Object(Tt.jsx)(Bt,{}),Object(Tt.jsx)(Vt,{})]})]})},hr=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,101)).then((function(t){var r=t.getCLS,n=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;r(e),n(e),i(e),a(e),o(e)}))};console.log("init global: "+new Date),Object(l.setGlobal)({mission:"S1",altitude:"5000000",appColor:"#cc44cf",position:{clon:"0.5",clat:"45"},viewDate:new Date,goToDate:new Date,searchDate:new Date,pointSearchMaxAltitude:3e6,searchPoint:"POINT(40 40)",geojson:null,closestItem:null,resultDesc:{firstItemDate:null,lastItemDate:null,totalResults:0,totalLoaded:0},animated:!1,clearGeojsonTrigger:null,mapSettings:{atmosphere:!1,starfield:!0,names:!1,background:1,overlay:2,dem:!1,satellites:!1,quicklooks:!1}}),o.a.render(Object(Tt.jsx)(i.a.StrictMode,{children:Object(Tt.jsx)(ur,{})}),document.getElementById("root")),hr()}},[[98,1,2]]]);
//# sourceMappingURL=main.cd96d25d.chunk.js.map